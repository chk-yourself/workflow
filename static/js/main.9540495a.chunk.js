(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{157:function(e,t,a){},193:function(e,t,a){},194:function(e,t,a){},197:function(e,t,a){e.exports=a.p+"static/media/feather-sprite.453b829f.svg"},199:function(e,t,a){e.exports=a.p+"static/media/jam-sprite.15d6dad8.svg"},209:function(e,t,a){e.exports=a(526)},219:function(e,t,a){},220:function(e,t,a){},304:function(e,t,a){},305:function(e,t,a){},306:function(e,t,a){},308:function(e,t,a){},309:function(e,t,a){},310:function(e,t,a){},311:function(e,t,a){},312:function(e,t,a){},313:function(e,t,a){},314:function(e,t,a){},315:function(e,t,a){},316:function(e,t,a){},317:function(e,t,a){},331:function(e,t,a){},332:function(e,t,a){},333:function(e,t,a){},334:function(e,t,a){},335:function(e,t,a){},336:function(e,t,a){},337:function(e,t,a){},338:function(e,t,a){},440:function(e,t,a){},441:function(e,t,a){},442:function(e,t,a){},443:function(e,t,a){},478:function(e,t,a){},479:function(e,t,a){},480:function(e,t,a){},481:function(e,t,a){},482:function(e,t,a){},483:function(e,t,a){},484:function(e,t,a){},485:function(e,t,a){},486:function(e,t,a){},487:function(e,t,a){},488:function(e,t,a){},489:function(e,t,a){},490:function(e,t,a){},491:function(e,t,a){},492:function(e,t,a){},493:function(e,t,a){},494:function(e,t,a){},495:function(e,t,a){},496:function(e,t,a){},497:function(e,t,a){},498:function(e,t,a){},499:function(e,t,a){},500:function(e,t,a){},501:function(e,t,a){},502:function(e,t,a){},503:function(e,t,a){},504:function(e,t,a){},505:function(e,t,a){},506:function(e,t,a){},507:function(e,t,a){},508:function(e,t,a){},509:function(e,t,a){},510:function(e,t,a){},511:function(e,t,a){},512:function(e,t,a){},513:function(e,t,a){},514:function(e,t,a){},515:function(e,t,a){},516:function(e,t,a){},517:function(e,t,a){},518:function(e,t,a){},519:function(e,t,a){},520:function(e,t,a){},521:function(e,t,a){},522:function(e,t,a){},523:function(e,t,a){},524:function(e,t,a){},525:function(e,t,a){},526:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"loadListsById",function(){return Ce}),a.d(n,"updateList",function(){return Te}),a.d(n,"addList",function(){return Ne}),a.d(n,"removeList",function(){return De}),a.d(n,"deleteList",function(){return Se}),a.d(n,"fetchListsById",function(){return Ae}),a.d(n,"fetchUserLists",function(){return xe}),a.d(n,"syncProjectLists",function(){return Pe}),a.d(n,"createList",function(){return Be});var r={};a.r(r),a.d(r,"loadProjectsById",function(){return Me}),a.d(r,"setTempProjectSettings",function(){return Ue}),a.d(r,"setProjectLoadedState",function(){return Re}),a.d(r,"updateProject",function(){return Le}),a.d(r,"addProject",function(){return Fe}),a.d(r,"removeProject",function(){return We}),a.d(r,"reorderLists",function(){return ze}),a.d(r,"updateProjectTags",function(){return Ve}),a.d(r,"loadProjectTags",function(){return qe}),a.d(r,"createTag",function(){return Ke}),a.d(r,"updateTag",function(){return Ye}),a.d(r,"deleteTag",function(){return Ge}),a.d(r,"syncProject",function(){return He}),a.d(r,"syncUserWorkspaceProjects",function(){return Je}),a.d(r,"fetchProjectLists",function(){return Xe}),a.d(r,"syncProjectTags",function(){return Qe});var s={};a.r(s),a.d(s,"loadTasksById",function(){return $e}),a.d(s,"addTask",function(){return Ze}),a.d(s,"removeTask",function(){return et}),a.d(s,"updateTask",function(){return tt}),a.d(s,"addTag",function(){return at}),a.d(s,"removeTag",function(){return nt}),a.d(s,"setTaskLoadedState",function(){return rt}),a.d(s,"removeTaskTag",function(){return st}),a.d(s,"deleteTask",function(){return ct}),a.d(s,"syncProjectTasks",function(){return ot}),a.d(s,"syncUserWorkspaceTasks",function(){return it}),a.d(s,"syncUserPrivateTasks",function(){return lt}),a.d(s,"syncTaggedTasks",function(){return ut});var c={};a.r(c),a.d(c,"loadUserData",function(){return dt}),a.d(c,"loadUsersById",function(){return pt}),a.d(c,"addUser",function(){return mt}),a.d(c,"removeUser",function(){return ft}),a.d(c,"updateUser",function(){return ht}),a.d(c,"updateUserStatus",function(){return vt}),a.d(c,"fetchUsersById",function(){return bt}),a.d(c,"syncUsersById",function(){return gt}),a.d(c,"syncWorkspaceMembers",function(){return kt}),a.d(c,"fetchUserData",function(){return yt}),a.d(c,"syncUserPresence",function(){return It});var o={};a.r(o),a.d(o,"setCurrentUser",function(){return jt}),a.d(o,"resetCurrentUser",function(){return _t}),a.d(o,"setTempTaskSettings",function(){return Et}),a.d(o,"loadAssignedTasks",function(){return wt}),a.d(o,"addAssignedTask",function(){return Ot}),a.d(o,"removeAssignedTask",function(){return Ct}),a.d(o,"loadFolders",function(){return Tt}),a.d(o,"addFolder",function(){return Nt}),a.d(o,"updateFolder",function(){return Dt}),a.d(o,"removeFolder",function(){return St}),a.d(o,"reorderFolders",function(){return At}),a.d(o,"loadNotifications",function(){return xt}),a.d(o,"addNotification",function(){return Pt}),a.d(o,"updateNotification",function(){return Bt}),a.d(o,"removeNotification",function(){return Mt}),a.d(o,"loadUserTags",function(){return Ut}),a.d(o,"createTag",function(){return Rt}),a.d(o,"updateTag",function(){return Lt}),a.d(o,"deleteTag",function(){return Ft}),a.d(o,"deleteFolder",function(){return Wt}),a.d(o,"syncFolders",function(){return zt}),a.d(o,"syncUserTags",function(){return Vt}),a.d(o,"syncUserTasks",function(){return qt}),a.d(o,"syncCurrentUser",function(){return Kt}),a.d(o,"syncUserWorkspaceData",function(){return Yt}),a.d(o,"syncNotifications",function(){return Gt});var i={};a.r(i),a.d(i,"getTasksById",function(){return da}),a.d(i,"getTasksArray",function(){return pa}),a.d(i,"getTasksMatchingQuery",function(){return ma}),a.d(i,"getTask",function(){return fa}),a.d(i,"getListTasks",function(){return ha}),a.d(i,"getFolderTasks",function(){return va}),a.d(i,"getTaskTags",function(){return ba}),a.d(i,"getTaskLoadedState",function(){return ga}),a.d(i,"getTaggedTasks",function(){return ka}),a.d(i,"getTasksByViewFilter",function(){return ya}),a.d(i,"getTaskIdsByViewFilter",function(){return Ia}),a.d(i,"getSortedTaskIds",function(){return ja}),a.d(i,"getAssignees",function(){return _a}),a.d(i,"getCompletedSubtasks",function(){return Ea});var l={};a.r(l),a.d(l,"getCurrentUser",function(){return wa}),a.d(l,"getCurrentUserId",function(){return Oa}),a.d(l,"getFolders",function(){return Ca}),a.d(l,"getNotifications",function(){return Ta}),a.d(l,"getNotificationsArray",function(){return Na}),a.d(l,"getTaskSettings",function(){return Da}),a.d(l,"getTempTaskSettings",function(){return Sa}),a.d(l,"getAssignedTasks",function(){return Aa}),a.d(l,"getFolderIds",function(){return xa}),a.d(l,"getSortedFilteredTaskGroups",function(){return Pa}),a.d(l,"getFolder",function(){return Ba}),a.d(l,"getTasksDueWithinDays",function(){return Ma}),a.d(l,"getOverdueTasks",function(){return Ua}),a.d(l,"getMergedProjectTags",function(){return Ra}),a.d(l,"getAllMergedTags",function(){return La}),a.d(l,"getCurrentUserProjects",function(){return Fa});var u={};a.r(u),a.d(u,"getUsersById",function(){return za}),a.d(u,"getUserData",function(){return Va}),a.d(u,"getUserTaskIds",function(){return qa}),a.d(u,"getUsersArray",function(){return Ka}),a.d(u,"getUserEmails",function(){return Ya}),a.d(u,"getMembersArray",function(){return Ga});var d={};a.r(d),a.d(d,"setActiveWorkspace",function(){return Xa}),a.d(d,"updateActiveWorkspace",function(){return Qa}),a.d(d,"resetActiveWorkspace",function(){return $a}),a.d(d,"syncActiveWorkspace",function(){return Za});var p={};a.r(p),a.d(p,"getActiveWorkspace",function(){return en});var m={};a.r(m),a.d(m,"getProjectsById",function(){return dn}),a.d(m,"getProjectsArray",function(){return pn}),a.d(m,"getProject",function(){return mn}),a.d(m,"getProjectTags",function(){return fn}),a.d(m,"getProjectName",function(){return hn}),a.d(m,"getProjectColor",function(){return vn}),a.d(m,"getProjectLoadedState",function(){return bn}),a.d(m,"getProjectLists",function(){return gn}),a.d(m,"getTempProjectSettings",function(){return kn});var f={};a.r(f),a.d(f,"getListsById",function(){return Wr}),a.d(f,"getList",function(){return zr}),a.d(f,"getListName",function(){return Vr}),a.d(f,"getSelectedProjectLists",function(){return qr}),a.d(f,"getProjectLists",function(){return Kr});var h={};a.r(h),a.d(h,"loadSubtasksById",function(){return Xr}),a.d(h,"addSubtask",function(){return Qr}),a.d(h,"removeSubtask",function(){return $r}),a.d(h,"updateSubtask",function(){return Zr}),a.d(h,"syncTaskSubtasks",function(){return es}),a.d(h,"fetchUserSubtasks",function(){return ts}),a.d(h,"syncProjectSubtasks",function(){return as});var v={};a.r(v),a.d(v,"getSubtasksById",function(){return ns}),a.d(v,"getSubtasksArray",function(){return rs}),a.d(v,"getActiveSubtasks",function(){return ss}),a.d(v,"getCompletedSubtasks",function(){return cs});var b={};a.r(b),a.d(b,"loadCommentsById",function(){return tc}),a.d(b,"addComment",function(){return ac}),a.d(b,"removeComment",function(){return nc}),a.d(b,"updateComment",function(){return rc}),a.d(b,"fetchCommentsById",function(){return sc}),a.d(b,"fetchTaskComments",function(){return cc}),a.d(b,"fetchUserComments",function(){return oc}),a.d(b,"syncTaskComments",function(){return ic});var g={};a.r(g),a.d(g,"getCommentsById",function(){return lc}),a.d(g,"getComment",function(){return uc}),a.d(g,"getCommentsArray",function(){return dc}),a.d(g,"getTaskComments",function(){return pc});var k=a(0),y=a.n(k),I=a(52),j=a.n(I),_=a(14),E=a(533),w=(a(218),a(219),a(3)),O=a(4),C=a(7),T=a(6),N=a(8),D=a(532),S=a(203),A=a(530),x=(a(220),function(e){var t=e.classes,a=e.children,n=e.title;return y.a.createElement("main",{className:"main ".concat(t.main||"")},n&&y.a.createElement("h1",{className:"main__title ".concat(t.title||"")},n),a)});x.defaultProps={classes:{main:"",title:""},title:""};var P=x,B=function(e){e.title,e.children;return y.a.createElement(P,{title:"Workflow",classes:{main:"landing"}})},M=a(135),U=a(1),R=a(11),L=a(2),F=a.n(L),W=a(12),z=a(19),V=a(531),q=y.a.createContext(null),K=function(e){return function(t){return y.a.createElement(q.Consumer,null,function(a){return y.a.createElement(e,Object.assign({},t,{firebase:a}))})}},Y=q,G=a(13),H=a(20),J=a(27);a(295),a(298),a(300),a(527);var X={apiKey:"AIzaSyBEMtI6srASSV24HbRYSLjdV6eVTI248DQ",authDomain:"workflow-74f49.firebaseapp.com",databaseURL:"https://workflow-74f49.firebaseio.com",projectId:"workflow-74f49",storageBucket:"workflow-74f49.appspot.com",messagingSenderId:"417049317953"},Q=function(){function e(){var t=this;Object(w.a)(this,e),this.reload=function(){t.auth.reload()},this.isNewUser=function(e){var t=e.metadata;return t.creationTime===t.lastSignInTime},this.signInWithGoogle=function(){var e=new J.auth.GoogleAuthProvider;t.auth.signInWithPopup(e).then(function(e){if(e.credential)e.credential.accessToken,e.user}).catch(function(e){var t=e.code;e.message,e.email,e.credential;"auth/account-exists-with-different-credential"===t?alert("You have already signed up with a different auth provider for that email."):console.error(e)})},this.signInWithGithub=function(){var e=new J.auth.GithubAuthProvider;t.auth.signInWithPopup(e).then(function(e){if(e.credential){var t=e.credential.accessToken;console.log(t);e.user}}).catch(function(e){var t=e.code;e.message,e.email,e.credential;"auth/account-exists-with-different-credential"===t?alert("You have already signed up with a different auth provider for that email."):console.error(e)})},this.signInAsGuest=function(){return t.auth.signInAnonymously().then(function(e){return console.log(e)})},this.createUserWithEmailAndPassword=function(e,a){return t.auth.createUserWithEmailAndPassword(e,a)},this.signInWithEmailAndPassword=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.signOut=function(){return t.auth.signOut()},this.sendPasswordResetEmail=function(e){var a={url:"".concat("https://wrkflw.tk","/login"),handleCodeInApp:!0};return t.auth.sendPasswordResetEmail(e,a)},this.getEmailAuthCredential=function(e,t){return J.auth.EmailAuthProvider.credential(e,t)},this.reauthenticateWithEmailAuthCredential=function(e,a){var n=t.getEmailAuthCredential(e,a);return t.currentUser.reauthenticateAndRetrieveDataWithCredential(n)},this.updatePassword=function(e){return t.currentUser.updatePassword(e)},this.sendSignInLinkToEmail=function(e){var a={url:"".concat("https://wrkflw.tk","/login"),handleCodeInApp:!0};t.auth.sendSignInLinkToEmail(e,a).then(function(){window.localStorage.setItem("loginEmail",e)}).catch(function(e){console.log(e)})},this.sendEmailVerification=function(){var e={url:"".concat("https://wrkflw.tk","/login"),handleCodeInApp:!0};return t.currentUser.sendEmailVerification(e)},this.getTimestamp=function(){return J.firestore.FieldValue.serverTimestamp()},this.addToArray=function(e){return J.firestore.FieldValue.arrayUnion(e)},this.removeFromArray=function(e){return J.firestore.FieldValue.arrayRemove(e)},this.deleteField=function(){return J.firestore.FieldValue.delete()},this.plus=function(e){return J.firestore.FieldValue.increment(e)},this.minus=function(e){return J.firestore.FieldValue.increment(-e)},this.getDocRef=function(){try{for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];if(a.length%2!==0)throw new Error("Invalid Argument: Must follow pattern `collection/subcollection...`");var r=a.join("/");return t.fs.doc(r)}catch(s){console.error(s)}},this.getCollection=function(e){return t.fs.collection(e)},this.queryCollection=function(e,a){var n=Object(H.a)(a,3),r=n[0],s=n[1],c=n[2];return t.fs.collection(e).where(r,s,c)},this.updateDoc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.getDocRef.apply(t,Object(G.a)(e)).update(Object(U.a)({lastUpdatedAt:t.getTimestamp()},a)).catch(function(t){console.error("Error updating document at path '".concat(e,"': ").concat(t))})},this.createBatch=function(){return t.fs.batch()},this.updateBatch=function(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Array.isArray(a)?t.getDocRef.apply(t,Object(G.a)(a)):a;return e.update(r,Object(U.a)({lastUpdatedAt:t.getTimestamp()},n))},this.setBatch=function(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=Array.isArray(a)?t.getDocRef.apply(t,Object(G.a)(a)):a;return r?e.set(s,n,{merge:!0}):e.set(s,n)},this.initPresenceDetection=function(e){var a=t.db.ref("/status/".concat(e)),n={state:"offline",lastUpdatedAt:J.database.ServerValue.TIMESTAMP},r={state:"online",lastUpdatedAt:J.database.ServerValue.TIMESTAMP},s=t.getDocRef("users",e),c={state:"offline",lastUpdatedAt:t.getTimestamp()},o={state:"online",lastUpdatedAt:t.getTimestamp()};t.db.ref(".info/connected").on("value",function(e){!1!==e.val()?a.onDisconnect().set(n).then(function(){a.set(r),s.update({status:o})}):s.update({status:c})})},this.createWorkspaceSettings=function(e){var a=e.userId,n=e.workspaceId,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r?t.setBatch(r,["users",a,"workspaces",n],{folderIds:["0","1","2","3"],projectIds:[]}):t.getDocRef("users",a,"workspaces",n).set({folderIds:["0","1","2","3"],projectIds:[]})},this.createWorkspace=function(e){var a=e.user,n=e.name,r=e.invites,s=a.userId;t.fs.collection("workspaces").add({createdAt:t.getTimestamp(),name:n,memberIds:[s],members:Object(R.a)({},s,{userId:s,role:"owner",activeTaskCount:0,projectIds:[]}),pendingInvites:r,ownerId:s,projectIds:[]}).then(function(e){var c=e.id,o=t.createBatch();return t.createWorkspaceSettings({userId:s,workspaceId:c},o),t.createWorkspaceFolders({userId:s,workspaceId:c},o,!1),t.updateBatch(o,["users",s],Object(R.a)({workspaceIds:t.addToArray(c),"settings.activeWorkspace":c},"workspaces.".concat(c),{id:c,name:n})),r.forEach(function(e){t.createWorkspaceInvite({email:e,workspaceId:c,workspaceName:n,from:Object(U.a)({},a)})}),o.commit().then(function(){console.log("created workspace")}).catch(function(e){console.error(e)})})},this.acceptWorkspaceInvite=function(e){var a=e.user,n=e.workspace,r=e.from,s=e.notificationId,c=t.createBatch(),o=a.userId,i=a.email,l=n.id,u=n.name;return t.updateBatch(c,["workspaces",l],Object(R.a)({memberIds:t.addToArray(o),pendingInvites:t.removeFromArray(i)},"members.".concat(o),{userId:o,role:"member",activeTaskCount:0,projectIds:[]})),t.updateBatch(c,["users",o],Object(R.a)({workspaceIds:t.addToArray(l)},"workspaces.".concat(l),{id:l,name:u})),t.createNotification({recipientId:r,workspaceId:l,source:{user:{userId:a.userId,name:a.name},type:"workspace",id:l,data:{name:u},parent:null},event:{type:"rsvp",data:{state:"accepted"},publishedAt:t.getTimestamp()}}),t.createWorkspaceSettings({userId:o,workspaceId:l},c),t.createWorkspaceFolders({userId:o,workspaceId:l},c,!1),t.updateBatch(c,["notifications",s],{isActionPending:!1}),c.commit().then(function(){console.log("Accepted workspace invite")}).catch(function(e){console.log(e)})},this.declineWorkspaceInvite=function(e){var a=e.user,n=e.workspace,r=e.from,s=e.notificationId,c=t.createBatch(),o=a.email,i=n.id,l=n.name;return t.updateBatch(c,["workspaces",i],{pendingInvites:t.removeFromArray(o)}),t.createNotification({recipientId:r,workspaceId:i,source:{user:{userId:a.userId,name:a.name},type:"workspace",id:i,data:{name:l},parent:null},event:{type:"rsvp",data:{state:"declined"},publishedAt:t.getTimestamp()}}),t.updateBatch(c,["notifications",s],{isActionPending:!1}),c.commit().then(function(){console.log("Declined workspace invite")}).catch(function(e){console.log(e)})},this.updateWorkspaceName=function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,s,c,o,i,l,u,d;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.workspaceId,r=a.name,s=a.memberIds,c=a.pendingInvites,o=t.createBatch(),t.updateBatch(o,["workspaces",n],{name:r}),s.forEach(function(e){t.updateBatch(o,["users",e],Object(R.a)({},"workspaces.".concat(n,".name"),r))}),!(c.length>0)){e.next=13;break}return e.next=7,Promise.all([t.fs.collection("invites").where("type","==","workspace").where("data.id","==",n).get().then(function(e){var t=[];return e.forEach(function(e){t=t.concat(e.ref)}),t}),t.fs.collection("notifications").where("event.type","==","invite").where("source.type","==","workspace").where("source.id","==",n).get().then(function(e){var t=[];return e.forEach(function(e){t=[].concat(Object(G.a)(t),[e.ref])}),t})]);case 7:i=e.sent,l=Object(H.a)(i,2),u=l[0],d=l[1],u.forEach(function(e){t.updateBatch(o,e,{"data.name":r})}),d.forEach(function(e){t.updateBatch(o,e,{"source.data.name":r})});case 13:return e.abrupt("return",o.commit().then(function(){console.log("Updated workspace name")}).catch(function(e){console.log(e)}));case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.getUserDoc=function(e){return t.fs.collection("users").doc(e)},this.createDemoProject=function(e){return t.cloneProject({name:"Tutorial",userId:e,projectId:"Z4tHLfAd0Y6YMenps4xW",workspaceId:"DEMO"},{includeNotes:!0,includeSubtasks:!0,includeMembers:!0,isDemo:!0}).then(function(){console.log("created demo project")}).catch(function(e){console.error(e)})},this.createGuest=function(e){return t.createUser({userId:e,name:"Guest",displayName:"Guest",email:"guest@workspace.com",about:"",role:"guest",isGuest:!0,workspaceIds:["DEMO"],workspaces:{DEMO:{id:"DEMO",name:"Demo"}}}).then(function(){console.log("Guest created")}).catch(function(e){console.error(e)})},this.deleteGuest=function(e){},this.createAccount=function(e){var a=e.userId,n=e.email,r=e.profile,s=e.workspace,c=e.invites,o={},i=[],l={userId:a,name:r.name};if(c.length>0){var u=t.createBatch();c.forEach(function(e){var r=e.isAccepted,s=e.from.userId,c=e.data,d=c.id,p=c.name,m=t.getDocRef("invites",e.id);u.delete(m),t.createNotification({workspaceId:d,recipientId:s,source:{user:Object(U.a)({},l),type:"workspace",id:d,data:{name:p},parent:null},event:{type:"rsvp",data:{state:r?"accepted":"declined"},publishedAt:t.getTimestamp()}}),r?(o[d]={id:d,name:p},i=i.concat(d),t.updateBatch(u,["workspaces",d],Object(R.a)({memberIds:t.addToArray(a),pendingInvites:t.removeFromArray(n)},"members.".concat(a),{userId:a,role:"member",activeTaskCount:0,projectIds:[]}))):t.updateBatch(u,["workspaces",d],{pendingInvites:t.removeFromArray(n)})}),u.commit().then(function(){console.log("added member to workspaces")}).catch(function(e){console.error(e)})}s?t.fs.collection("workspaces").add({createdAt:t.getTimestamp(),name:s.name,memberIds:[a],members:Object(R.a)({},a,{userId:a,role:"owner",activeTaskCount:0,projectIds:[]}),pendingInvites:s.invites,ownerId:a,projectIds:[]}).then(function(e){var c=e.id;t.createUser({userId:a,email:n,name:r.name,displayName:r.displayName||r.name,about:r.about,workspaceIds:[].concat(Object(G.a)(i),[c]),workspaces:Object(U.a)({},o,Object(R.a)({},c,{id:c,name:s.name}))}),s.invites.forEach(function(e){t.createWorkspaceInvite({email:e,workspaceId:c,workspaceName:s.name,from:l})})}):t.createUser({userId:a,email:n,workspaces:o,workspaceIds:i,name:r.name,displayName:r.displayName||r.name,about:r.about})},this.createWorkspaceInvite=function(e){var a=e.email,n=e.workspaceId,r=e.workspaceName,s=e.from;t.fs.collection("users").where("email","==",a).get().then(function(e){e.size>0?e.forEach(function(e){var a=e.data().settings.activeWorkspace;t.createNotification({workspaceId:a,recipientId:e.id,isActionPending:!0,source:{user:s,type:"workspace",id:n,data:{name:r},parent:null},event:{type:"invite",publishedAt:t.getTimestamp()}})}):t.fs.collection("invites").add({to:a,createdAt:t.getTimestamp(),type:"workspace",data:{id:n,name:r},from:s})})},this.createWorkspaceFolders=function(e){var a=e.userId,n=e.workspaceId,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.createBatch,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t.setBatch(r,["users",a,"workspaces",n,"folders","0"],{name:"New Tasks",taskIds:[],workspaceId:n}),t.setBatch(r,["users",a,"workspaces",n,"folders","1"],{name:"Today",taskIds:[],workspaceId:n}),t.setBatch(r,["users",a,"workspaces",n,"folders","2"],{name:"Upcoming",taskIds:[],workspaceId:n}),t.setBatch(r,["users",a,"workspaces",n,"folders","3"],{name:"Later",taskIds:[],workspaceId:n}),t.setBatch(r,["users",a,"workspaces",n,"folders","4"],{name:"No Project",taskIds:[],workspaceId:n}),t.setBatch(r,["users",a,"workspaces",n,"folders","5"],{name:"No Due Date",taskIds:[],workspaceId:n}),s)return r.commit().then(function(){console.log("Created user folders")}).catch(function(e){console.log(e)})},this.createUser=function(e){var a=e.userId,n=e.name,r=e.displayName,s=e.email,c=e.about,o=e.workspaces,i=e.workspaceIds,l=e.photoURL,u=void 0===l?null:l,d=e.role,p=void 0===d?"member":d,m=e.isGuest,f=void 0!==m&&m,h=t.createBatch();return t.setBatch(h,["users",a],{userId:a,name:n,displayName:r,email:s,about:c,photoURL:u,workspaces:o,workspaceIds:i,role:p,isGuest:f,linkedin:"",github:"",createdAt:t.getTimestamp(),settings:{activeWorkspace:i[i.length-1],tasks:{view:"all",sortBy:"folder"}}}),i.forEach(function(e){t.createWorkspaceSettings({userId:a,workspaceId:e},h),t.createWorkspaceFolders({userId:a,workspaceId:e},h,!1)}),h.commit().then(function(){console.log("User added")}).catch(function(e){console.log(e)})},this.updateUserName=function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,s,c,o,i,l;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.userId,r=a.name,s=t.createBatch(),t.updateBatch(s,["users",n],{name:r}),e.next=5,Promise.all([t.queryCollection("invites",["from.userId","==",n]).get().then(function(e){var t=[];return e.forEach(function(e){t=t.concat(e.ref)}),t}),t.queryCollection("notifications",["source.user.userId","==",n]).get().then(function(e){var t=[];return e.forEach(function(e){t=t.concat(e.ref)}),t})]);case 5:return c=e.sent,o=Object(H.a)(c,2),i=o[0],l=o[1],i.forEach(function(e){t.updateBatch(s,e,{"from.name":r})}),l.forEach(function(e){t.updateBatch(s,e,{"source.user.name":r})}),e.abrupt("return",s.commit().then(function(){console.log("Updated user name")}).catch(function(e){console.error(e)}));case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.updateUser=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.fs.collection("users").doc(e).update(a)},this.addTag=function(e){var a=e.taskId,n=e.userId,r=e.name,s=e.projectId,c=e.color,o=void 0===c?"default":c,i=t.createBatch();return t.updateBatch(i,["tasks",a],{tags:t.addToArray(r)}),t.setBatch(i,["users",n,"tags",r],{name:r,color:o,count:t.plus(1)},!0),s&&t.setBatch(i,["projects",s],{tags:Object(R.a)({},r,{name:r,color:o,count:t.plus(1)})},!0),i.commit().then(function(){console.log("tag added")}).catch(function(e){console.error(e)})},this.removeTag=function(e){var a=e.taskId,n=void 0===a?null:a,r=e.name,s=e.userId,c=e.projectId,o=e.userCount,i=e.projectCount,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.createBatch(),u=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(n&&t.updateBatch(l,["tasks",n],{tags:t.removeFromArray(r)}),s&&null!==o&&(0===o?t.deleteTag({userId:s,name:r}):t.updateBatch(l,["users",s,"tags",r],{count:t.minus(1)})),c&&null!==i&&(0===i?t.deleteTag({projectId:c,name:r}):t.updateBatch(l,["projects",c],Object(R.a)({},"tags.".concat(r,".count"),t.minus(1)))),u)return l.commit().then(function(){console.log("Tag deleted")}).catch(function(e){console.error(e)})},this.deleteTag=function(e){var a=e.userId,n=e.projectId,r=e.name;n&&t.updateDoc(["projects",n],Object(R.a)({},"tags.".concat(r),t.deleteField())),a&&t.getDocRef("users",a,"tags",r).delete()},this.setTagColor=function(e){var a=e.userId,n=e.projectId,r=e.tag,s=e.color,c=t.createBatch();return n&&t.updateBatch(c,["projects",n],Object(R.a)({},"tags.".concat(r,".color"),s)),t.updateBatch(c,["users",a,"tags",r],{color:s}),c.commit().then(function(){console.log("tag color updated")}).catch(function(e){console.error(e)})},this.getProjectDoc=function(e){return t.fs.collection("projects").doc(e)},this.updateProject=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.getProjectDoc(e).update(Object(U.a)({lastUpdatedAt:t.getTimestamp()},a))},this.updateProjectName=function(e){var a=e.projectId,n=e.name,r=t.createBatch();t.updateBatch(r,["projects",a],{name:n}),t.fs.collection("tasks").where("projectId","==",a).get().then(function(e){return e.docs.forEach(function(e){r.update(e.ref,{projectName:n})}),r.commit().then(function(){console.log("project name updated")}).catch(function(e){console.error(e)})})},this.cloneProject=function(){var e=Object(W.a)(F.a.mark(function e(a,n){var r,s,c,o,i,l,u,d,p,m,f,h,v,b,g,k,y,I,j;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.name,s=a.userId,c=a.projectId,o=a.workspaceId,i=n.includeNotes,l=void 0===i||i,u=n.includeSubtasks,d=void 0===u||u,p=n.includeMembers,m=void 0===p||p,f=n.isDemo,h=void 0!==f&&f,e.next=4,Promise.all([t.getDocRef("projects",c).get().then(function(e){return e.data()}),t.queryCollection("lists",["projectId","==",c]).get().then(function(e){var t={};return e.forEach(function(e){var a=e.id,n=e.data();t[a]=Object(U.a)({},n)}),t}),t.queryCollection("tasks",["projectId","==",c]).get().then(function(e){var t={};return e.forEach(function(e){var a=e.id,n=e.data();t[a]=Object(U.a)({},n)}),t}),d?t.queryCollection("subtasks",["projectId","==",c]).get().then(function(e){var t={};return e.forEach(function(e){var a=e.id,n=e.data();t[a]=Object(U.a)({},n)}),t}):function(){return null}]);case 4:return v=e.sent,b=Object(H.a)(v,4),g=b[0],k=b[1],y=b[2],I=b[3],e.next=12,t.createProject(Object(U.a)({},g,{name:r,notes:l?g.notes:null,memberIds:h?[].concat(Object(G.a)(g.memberIds),[s]):m?g.memberIds:[s],userId:s,workspaceId:o,isDuplicate:!0}));case 12:j=e.sent,console.log(j),g.listIds.forEach(function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,c,i;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=k[a],r=n.name,c=n.taskIds,console.log(j),e.next=5,t.createList({name:r,userId:s,projectId:j,workspaceId:o});case 5:i=e.sent,c.forEach(function(){var e=Object(W.a)(F.a.mark(function e(a){var n,c,l;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=y[a],c=n.subtaskIds,e.next=4,t.createTask(Object(U.a)({},n,{projectId:j,projectName:r,listId:i,userId:s,workspaceId:o}));case 4:l=e.sent,d&&c.forEach(function(e){var a=I[e];t.createSubtask(Object(U.a)({},a,{userId:s,workspaceId:o,projectId:j,taskId:l}))});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 15:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),this.createProject=function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,s,c,o,i,l,u,d,p,m,f,h,v,b,g,k;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.userId,r=a.name,s=a.workspaceId,c=a.color,o=void 0===c?"default":c,i=a.layout,l=void 0===i?"board":i,u=a.isPrivate,d=void 0!==u&&u,p=a.memberIds,m=void 0===p?[]:p,f=a.notes,h=void 0===f?null:f,v=a.isDuplicate,b=void 0!==v&&v,e.next=3,t.fs.collection("projects").add({createdAt:t.getTimestamp(),lastUpdatedAt:null,listIds:[],ownerId:n,settings:{isPrivate:d,layout:l,tasks:{view:"all",sortBy:"none"}},memberIds:m,notes:h,color:o,name:r,workspaceId:s,isDuplicate:b}).then(function(e){return e.id}).catch(function(e){console.error(e.message)});case 3:return g=e.sent,console.log(g),k=t.createBatch(),m.forEach(function(e){t.updateBatch(k,["users",e,"workspaces",s],{projectIds:t.addToArray(g)}),t.updateBatch(k,["workspaces",s],Object(R.a)({projectIds:t.addToArray(g)},"members.".concat(e,".projectIds"),t.addToArray(g))),t.setBatch(k,["users",e,"workspaces",s,"folders",g],{name:r,taskIds:[]})}),e.abrupt("return",k.commit().then(function(){return console.log("Created Project: ".concat(r)),g}).catch(function(e){console.error(e.message)}));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.deleteProject=function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,s,c,o,i;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.projectId,r=a.workspaceId,s=a.listIds,c=a.memberIds,o=t.createBatch(),i=t.getDocRef("projects",n),o.delete(i),t.queryCollection("tasks",["projectId","==",n]).get().then(function(e){e.forEach(function(e){var a=e.id,n=e.data();t.deleteTask(Object(U.a)({taskId:a},n,{projectId:null,listId:null}))})}).catch(function(e){console.error(e)}),s.forEach(function(e){var a=t.getDocRef("lists",e);o.delete(a)}),c.forEach(function(e){var a,s=t.getDocRef("users",e,"workspaces",r,"folders",n);o.delete(s),t.updateBatch(o,["users",e,"workspaces",r],{projectIds:t.removeFromArray(n)}),t.updateBatch(o,["workspaces",r],(a={},Object(R.a)(a,"members.".concat(e,".projectIds"),t.removeFromArray(n)),Object(R.a)(a,"projectIds",t.removeFromArray(n)),a))}),e.abrupt("return",o.commit().then(function(){console.log("Project deleted")}).catch(function(e){console.error(e)}));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.updateListName=function(e){var a=e.listId,n=e.name,r=t.createBatch();t.updateBatch(r,["lists",a],{name:n}),t.fs.collection("tasks").where("listId","==",a).get().then(function(e){return e.docs.forEach(function(e){r.update(e.ref,{listName:n})}),r.commit().then(function(){console.log("List name updated.")}).catch(function(e){console.log(e.message)})})},this.createList=function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,s,c,o;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.name,r=a.userId,s=a.workspaceId,c=a.projectId,e.next=3,t.fs.collection("lists").add({ownerId:r,createdAt:t.getTimestamp(),lastUpdatedAt:null,taskIds:[],projectId:c,name:n,workspaceId:s}).then(function(e){return e.id}).catch(function(e){console.error(e.message)});case 3:return o=e.sent,e.abrupt("return",t.updateDoc(["projects",c],{listIds:t.addToArray(o)}).then(function(){return o}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.deleteList=function(e){var a=e.listId,n=e.projectId,r=t.createBatch(),s=t.getDocRef("lists",a);r.delete(s),t.updateBatch(r,["projects",n],{listIds:t.removeFromArray(a)}),t.fs.collection("tasks").where("listId","==",a).get().then(function(e){return e.docs.forEach(function(e){r.delete(e.ref)}),r.commit().then(function(){console.log("list deleted")}).catch(function(e){console.error(e)})})},this.getTaskDoc=function(e){return t.fs.collection("tasks").doc(e)},this.createTask=function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,s,c,o,i,l,u,d,p,m,f,h,v,b,g,k,y;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.name,r=a.projectId,s=a.projectName,c=a.listId,o=a.listName,i=a.userId,l=a.workspaceId,u=a.dueDate,d=void 0===u?null:u,p=a.folderId,m=void 0===p?null:p,f=a.assignedTo,h=void 0===f?[]:f,v=a.isPrivate,b=void 0!==v&&v,g=!!m,e.next=4,t.fs.collection("tasks").add({ownerId:i,createdAt:t.getTimestamp(),lastUpdatedAt:null,commentIds:[],subtaskIds:[],tags:[],isCompleted:!1,completedAt:null,notes:null,assignedTo:g?[i]:h,folders:g?Object(R.a)({},i,"0"):{},dueDate:d,listId:c,listName:o,projectId:r,projectName:s,name:n,workspaceId:l,isPrivate:b}).then(function(e){return e.id}).catch(function(e){console.error(e)});case 4:return k=e.sent,y=t.createBatch(),c&&(t.updateBatch(y,["lists",c],{taskIds:t.addToArray(k)}),h.length>0&&h.forEach(function(e){t.updateBatch(y,["workspaces",l],Object(R.a)({},"members.".concat(e,".activeTaskCount"),t.plus(1)))})),g&&(t.updateBatch(y,["workspaces",l],Object(R.a)({},"members.".concat(i,".activeTaskCount"),t.plus(1))),r||"4"===m||t.updateBatch(y,["users",i,"workspaces",l,"folders","4"],{taskIds:t.addToArray(k)}),d||"5"===m||t.updateBatch(y,["users",i,"workspaces",l,"folders","5"],{taskIds:t.addToArray(k)}),d&&(console.log("".concat(+d)),y.set(t.getDocRef("users",i,"workspaces",l,"folders","".concat(+d)),{taskIds:t.addToArray(k)},{merge:!0})),"0"!==m&&t.updateBatch(y,["users",i,"workspaces",l,"folders","0"],{taskIds:t.addToArray(k)}),t.updateBatch(y,["users",i,"workspaces",l,"folders",m],{taskIds:t.addToArray(k)})),e.abrupt("return",y.commit().then(function(){return console.log("Created task"),k}).catch(function(e){console.error(e)}));case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.updateTask=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("task updated"),t.getTaskDoc(e).update(Object(U.a)({lastUpdatedAt:t.getTimestamp()},a))},this.setTaskDueDate=function(e){var a=e.taskId,n=e.prevDueDate,r=e.newDueDate,s=e.workspaceId,c=e.assignedTo,o=void 0===c?[]:c,i=t.createBatch();return t.updateBatch(i,["tasks",a],{dueDate:r}),o.length>0&&o.forEach(function(e){null===n?t.updateBatch(i,["users",e,"workspaces",s,"folders","5"],{taskIds:t.removeFromArray(a)}):i.set(t.getDocRef("users",e,"workspaces",s,"folders","".concat(+n)),{taskIds:t.removeFromArray(a)},{merge:!0}),null===r?t.updateBatch(i,["users",e,"workspaces",s,"folders","5"],{taskIds:t.addToArray(a)}):i.set(t.getDocRef("users",e,"workspaces",s,"folders","".concat(+r)),{taskIds:t.addToArray(a)},{merge:!0})}),i.commit().then(function(){console.log("Set task due date")}).catch(function(e){console.error(e)})},this.removeAssignee=function(e){var a=e.projectId,n=e.userId,r=e.folderId,s=e.workspaceId,c=e.taskId,o=void 0===c?null:c,i=e.dueDate,l=void 0===i?null:i,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.createBatch(),d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(o?(t.updateBatch(u,["users",n,"workspaces",s,"folders",r],{taskIds:t.removeFromArray(o)}),t.updateBatch(u,["workspaces",s],Object(R.a)({},"members.".concat(n,".activeTaskCount"),t.minus(1))),l?t.updateBatch(u,["users",n,"workspaces",s,"folders","".concat(+l)],{taskIds:t.removeFromArray(o)}):t.updateBatch(u,["users",n,"workspaces",s,"folders","5"],{taskIds:t.removeFromArray(o)}),a&&t.updateBatch(u,["users",n,"workspaces",s,"folders",a],{taskIds:t.removeFromArray(o)})):(t.updateBatch(u,["users",n,"workspaces",s],{projectIds:t.removeFromArray(a)}),t.updateBatch(u,["projects",a],{memberIds:t.removeFromArray(n)}),t.updateBatch(u,["workspaces",s],Object(R.a)({},"members.".concat(n,".projectIds"),t.removeFromArray(a)))),d)return o&&t.updateBatch(u,["tasks",o],Object(R.a)({assignedTo:t.removeFromArray(n)},"folders.".concat(n),t.deleteField())),u.commit().then(function(){console.log("Removed assignee")}).catch(function(e){console.error(e)})},this.addAssignee=function(e){var a,n=e.projectId,r=e.projectName,s=e.userId,c=e.workspaceId,o=e.taskId,i=void 0===o?null:o,l=e.dueDate,u=void 0===l?null:l,d=t.fs.batch();return t.updateBatch(d,["projects",n],{memberIds:t.addToArray(s)}),t.updateBatch(d,["workspaces",c],(a={},Object(R.a)(a,"members.".concat(s,".projectIds"),t.addToArray(n)),Object(R.a)(a,"members.".concat(s,".activeTaskCount"),t.plus(i?1:0)),a)),t.updateBatch(d,["users",s,"workspaces",c],{projectIds:t.addToArray(n)}),i&&(d.set(t.getDocRef("users",s,"workspaces",c,"folders",n),{name:r,taskIds:t.addToArray(i)},{merge:!0}),t.updateBatch(d,["users",s,"workspaces",c,"folders","0"],{taskIds:t.addToArray(i)}),t.updateBatch(d,["tasks",i],Object(R.a)({assignedTo:t.addToArray(s)},"folders.".concat(s),"0")),u?d.set(t.getDocRef("users",s,"workspaces",c,"folders","".concat(+u)),{taskIds:t.addToArray(i)},{merge:!0}):t.updateBatch(d,["users",s,"workspaces",c,"folders","5"],{taskIds:t.addToArray(i)})),d.commit().then(function(){console.log("Added assignee")}).catch(function(e){console.error(e)})},this.deleteTask=function(e){var a=e.taskId,n=e.assignedTo,r=e.folders,s=e.subtaskIds,c=e.commentIds,o=e.dueDate,i=void 0===o?null:o,l=e.listId,u=void 0===l?null:l,d=e.projectId,p=void 0===d?null:d,m=(e.userId,e.workspaceId),f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.createBatch(),h=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],v=t.getDocRef("tasks",a);if(f.delete(v),u){var b=t.getDocRef("lists",u);t.updateBatch(f,b,{taskIds:t.removeFromArray(a)})}if(s.length>0&&(s.forEach(function(e){t.deleteSubtask({subtaskId:e},f,!1)}),console.log("1. Subtasks deleted.")),n.length>0&&(n.forEach(function(e){var n=r[e],s=t.getDocRef("users",e,"workspaces",m,"folders",n);t.updateBatch(f,["workspaces",m],Object(R.a)({},"members.".concat(e,".activeTaskCount"),t.minus(1))),t.updateBatch(f,s,{taskIds:t.removeFromArray(a)}),p?t.updateBatch(f,["users",e,"workspaces",m,"folders",p],{taskIds:t.removeFromArray(a)}):t.updateBatch(f,["users",e,"workspaces",m,"folders","4"],{taskIds:t.removeFromArray(a)}),i?t.updateBatch(f,["users",e,"workspaces",m,"folders","".concat(i.toMillis())],{taskIds:t.removeFromArray(a)}):t.updateBatch(f,["users",e,"workspaces",m,"folders","5"],{taskIds:t.removeFromArray(a)})}),console.log("2. Removed task assignments.")),c.length>0&&(c.forEach(function(e){var a=t.getDocRef("comments",e);f.delete(a)}),console.log("3. Task comments deleted.")),h)return f.commit().then(function(){console.log("task deleted")}).catch(function(e){console.error(e)})},this.moveTaskToList=function(e){var a=e.taskId,n=e.origListId,r=e.newListId,s=e.updatedTaskIds,c=e.newListName,o=t.createBatch();return t.updateBatch(o,["tasks",a],{listId:r,listName:c}),t.updateBatch(o,["lists",n],{taskIds:t.removeFromArray(a)}),t.updateBatch(o,["lists",r],{taskIds:s}),o.commit().then(function(){console.log("Moved task to ".concat(c))}).catch(function(e){console.error(e)})},this.moveTaskToFolder=function(e){var a=e.userId,n=e.taskId,r=e.origFolderId,s=e.newFolderId,c=e.updatedTaskIds,o=e.workspaceId,i=e.type,l=void 0===i?"default":i,u=t.createBatch();switch(l){case"dueDate":t.updateBatch(u,["tasks",n],{dueDate:"5"===s?null:new Date(+s)});break;default:t.updateBatch(u,["tasks",n],Object(R.a)({},"folders.".concat(a),s))}return t.updateBatch(u,["users",a,"workspaces",o,"folders",r],{taskIds:t.removeFromArray(n)}),t.updateBatch(u,["users",a,"workspaces",o,"folders",s],{taskIds:c}),u.commit().then(function(){console.log("Task moved to new folder")}).catch(function(e){console.error(e)})},this.getSubtaskDoc=function(e){return t.fs.collection("subtasks").doc(e)},this.createSubtask=function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,s,c,o,i,l,u,d,p,m;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.userId,r=a.name,s=a.workspaceId,c=a.memberIds,o=void 0===c?[]:c,i=a.taskId,l=a.projectId,u=void 0===l?null:l,d=a.dueDate,p=void 0===d?null:d,e.next=3,t.fs.collection("subtasks").add({createdAt:t.getTimestamp(),lastUpdatedAt:null,isCompleted:!1,ownerId:n,assignedTo:[n].concat(Object(G.a)(o)),completedAt:null,dueDate:p,projectId:u,taskId:i,name:r,workspaceId:s}).then(function(e){return e.id}).catch(function(e){console.error(e)});case 3:m=e.sent,t.updateDoc(["tasks",i],{subtaskIds:t.addToArray(m)}).then(function(){return m});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.updateSubtask=function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r=arguments;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.next=3,t.getSubtaskDoc(a).update(Object(U.a)({lastUpdatedAt:t.getTimestamp()},n));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.deleteSubtask=function(e){var a=e.subtaskId,n=e.taskId,r=void 0===n?null:n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.createBatch(),c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=t.getDocRef("subtasks",a);if(s.delete(o),r&&t.updateBatch(s,["tasks",r],{subtaskIds:t.removeFromArray(a)}),c)return s.commit().then(function(){console.log("Subtask deleted.")}).catch(function(e){console.error(e)})},this.createComment=function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,s,c,o,i,l,u,d,p,m,f;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.from,r=a.content,s=a.workspaceId,c=a.to,o=void 0===c?[]:c,i=a.projectId,l=void 0===i?null:i,u=a.taskId,d=void 0===u?null:u,p=a.createdAt,m=void 0===p?t.getTimestamp():p,e.next=3,t.fs.collection("comments").add({createdAt:m,from:n,to:o,projectId:l,taskId:d,content:r,workspaceId:s,lastUpdatedAt:null,isPinned:!1,likes:{}}).then(function(e){return e.id}).catch(function(e){console.error("Error creating comment: ".concat(e))});case 3:return f=e.sent,d&&t.updateDoc(["tasks",d],{commentIds:t.addToArray(f)}),e.abrupt("return",Promise.all(o.map(function(e){t.createNotification({workspaceId:s,recipientId:e.userId,source:{user:n,type:"comment",id:f,parent:{type:d?"task":"project",id:d||l}},event:{type:"mention",publishedAt:m}})})).then(function(){return f}).catch(function(e){console.error(e)}));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.createNotification=function(e){var a=e.recipientId,n=e.workspaceId,r=e.source,s=e.event,c=e.isActionPending,o=void 0!==c&&c;return t.fs.collection("notifications").add({recipientId:a,workspaceId:n,source:r,event:s,isActionPending:o,createdAt:t.getTimestamp(),isActive:!0}).catch(function(e){console.error(e)})},J.initializeApp(X),this.auth=J.auth(),this.fs=J.firestore(),this.db=J.database(),this.storage=J.storage()}return Object(O.a)(e,[{key:"currentUser",get:function(){return this.auth.currentUser}}]),e}(),$=a(17),Z=(a(304),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isFocused:!1},a.onFocus=function(e){var t=a.props.onFocus;a.setState(function(e){return{isFocused:!e.isFocused}}),t(e)},a.onBlur=function(e){var t=a.props.onBlur;a.setState({isFocused:!1}),t(e)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.className,a=void 0===t?"":t,n=e.name,r=e.type,s=e.value,c=e.onChange,o=e.onInput,i=(e.onFocus,e.onBlur,e.placeholder),l=e.isRequired,u=e.autoComplete,d=e.innerRef,p=e.label,m=e.labelClass,f=e.helper,h=e.helperClass,v=e.onKeyDown,b=e.maxLength,g=e.minLength,k=e.isReadOnly,I=e.id,j=Object($.a)(e,["className","name","type","value","onChange","onInput","onFocus","onBlur","placeholder","isRequired","autoComplete","innerRef","label","labelClass","helper","helperClass","onKeyDown","maxLength","minLength","isReadOnly","id"]),_=this.state.isFocused;return y.a.createElement(y.a.Fragment,null,p&&y.a.createElement("label",{htmlFor:I||n,className:"input__label ".concat(m," ").concat(_?"is-focused":"")},p),y.a.createElement("input",Object.assign({id:p?I||n:I,className:"input ".concat(a),name:n,type:r,value:s,onFocus:this.onFocus,onChange:c,placeholder:i,required:l,onBlur:this.onBlur,autoComplete:u,ref:d,onInput:o,onKeyDown:v,maxLength:b,minLength:g,readOnly:k,tabIndex:k?-1:0},j)),f&&y.a.createElement("p",{className:"input__helper ".concat(h," ").concat(_?"is-focused":"")},f))}}]),t}(k.Component));Z.defaultProps={className:"",innerRef:null,labelClass:"",type:"text",isRequired:!1,isReadOnly:!1,label:"",id:null,helper:null,helperClass:"",onFocus:function(){return null},onBlur:function(){return null}};var ee=Z,te=(a(305),function(e){var t=e.children,a=e.type,n=void 0===a?"button":a,r=e.onClick,s=e.onMouseDown,c=e.className,o=void 0===c?"":c,i=e.color,l=void 0===i?"neutral":i,u=e.size,d=void 0===u?"md":u,p=e.variant,m=void 0===p?"text":p,f=e.disabled,h=e.name,v=e.iconOnly,b=void 0!==v&&v,g=e.value,k=e.innerRef,I=e.isActive,j=Object($.a)(e,["children","type","onClick","onMouseDown","className","color","size","variant","disabled","name","iconOnly","value","innerRef","isActive"]);return y.a.createElement("button",Object.assign({className:"".concat(o," ").concat(m," ").concat(m,"--").concat(l," ").concat(b?"icon-only icon-only--".concat(d):"btn--".concat(d)," ").concat(I?"is-active":""),type:n,onClick:r,onMouseDown:s,disabled:f,name:h,value:g,ref:k},j),t)});te.defaultProps={type:"button",className:"",color:"neutral",size:"md",variant:"text",iconOnly:!1,ref:null,isActive:!1,value:"",name:"",onClick:function(){return null},onMouseDown:function(){return null}};var ae=te;(function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={hasError:!1},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state.hasError,t=this.props,a=t.children,n=t.fallback,r=t.message;return e?n||y.a.createElement("h1",null,r):a}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),t}(k.Component)).defaultProps={fallback:null,message:"Something went wrong."};a(306);var ne=a(197),re=a.n(ne),se=function(e){var t=e.name,a=e.className,n=e.width,r=e.height;return y.a.createElement("svg",{className:"feather feather-".concat(t," ").concat(a),xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24",width:n,height:r,fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},y.a.createElement("use",{xlinkHref:"".concat(re.a,"#").concat(t)}))};se.defaultProps={className:"",width:24,height:24};var ce=se,oe=function(e){var t=e.className,a=e.text;return y.a.createElement("p",{className:"message--error ".concat(t)},y.a.createElement(ce,{name:"alert-circle"}),a)};oe.defaultProps={className:""};var ie=oe,le={email:"",password:"",passwordConfirm:"",error:null},ue=function(e){function t(e){var a;return Object(w.a)(this,t),(a=Object(C.a)(this,Object(T.a)(t).call(this,e))).onSubmit=function(){var e=Object(W.a)(F.a.mark(function e(t){var n,r,s,c,o,i;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.state,r=n.email,s=n.password,c=a.props.firebase,o=window,i=o.localStorage,e.next=6,c.createUserWithEmailAndPassword(r,s).then(function(){c.sendEmailVerification(),i.setItem("loginEmail",r)}).catch(function(e){a.setState({error:e})});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.state=Object(U.a)({},le),a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.password,n=e.passwordConfirm,r=e.error,s=""===a||""===n||""===t||a!==n;return y.a.createElement("form",{onSubmit:this.onSubmit,className:"user-form"},y.a.createElement(ee,{name:"email",id:"email",label:"Email",value:t,onChange:this.onChange,type:"email",className:"user-form__input",labelClass:"user-form__label"}),y.a.createElement(ee,{name:"password",id:"password",label:"Password",value:a,onChange:this.onChange,type:"password",className:"user-form__input",labelClass:"user-form__label"}),y.a.createElement(ee,{name:"passwordConfirm",id:"passwordConfirm",label:"Confirm Password",value:n,onChange:this.onChange,type:"password",className:"user-form__input",labelClass:"user-form__label"}),y.a.createElement(ae,{disabled:s,type:"submit",size:"md",variant:"contained",color:"primary",onClick:this.onSubmit,className:"sign-up__btn"},"Create Account"),r&&y.a.createElement(ie,{text:r.message}))}}]),t}(k.Component),de=Object(z.a)(V.a,K)(ue),pe=(a(308),function(){return y.a.createElement("p",null,"Don't have an account?",y.a.createElement(M.a,{className:"link--outlined",to:"/signup"},"Sign Up"))}),me=function(){return y.a.createElement("main",{className:"sign-up"},y.a.createElement("div",{className:"sign-up__content"},y.a.createElement("h1",{className:"sign-up__heading"},"Sign Up"),y.a.createElement(de,null)))},fe=(a(309),function(e){var t=e.className,a=e.text;return y.a.createElement("p",{className:"message--success ".concat(t)},y.a.createElement(ce,{name:"check-circle"}),a)});fe.defaultProps={className:""};var he=fe,ve={email:"",error:null,success:null},be=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state=Object(U.a)({},ve),a.onSubmit=function(e){var t=a.state.email;a.props.firebase.sendPasswordResetEmail(t).then(function(){a.setState(Object(U.a)({},ve,{success:{message:"Recovery email sent! Follow the instructions in the email to reset your password."}}))}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.error,n=e.success,r=""===t;return y.a.createElement("form",{onSubmit:this.onSubmit,className:"user-form"},y.a.createElement(ee,{name:"email",id:"email",label:"Email",value:t,onChange:this.onChange,type:"email",className:"user-form__input",labelClass:"user-form__label"}),y.a.createElement(ae,{disabled:r,type:"submit",size:"md",variant:"contained",color:"primary",onClick:this.onSubmit,className:"forgot-password__btn"},"Reset Password"),a&&y.a.createElement(ie,{text:a.message}),n&&y.a.createElement(he,{text:n.message}))}}]),t}(k.Component),ge=K(be),ke=(a(310),function(){return y.a.createElement("p",{className:"user-form__pw-forget"},y.a.createElement(M.a,{to:"/forgot-password",className:"user-form__link link--sm"},"Forgot your password?"))}),ye=function(){return y.a.createElement("main",{className:"forgot-password"},y.a.createElement("div",{className:"forgot-password__content"},y.a.createElement("h1",{className:"forgot-password__heading"},"Forgot your password?"),y.a.createElement(ge,null),y.a.createElement(M.a,{to:"/login",className:"forgot-password__link"},y.a.createElement(ce,{name:"arrow-left"}),"Back to Login")))},Ie={email:"",password:"",error:null},je=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state=Object(U.a)({},Ie),a.onSubmit=function(e){var t=a.state,n=t.email,r=t.password,s=a.props.firebase;if("Guest"===n)try{if("w0rkfl0w"!==r)throw new Error("Incorrect password.");s.signInAsGuest().then(function(){a.setState(Object(U.a)({},Ie))}).catch(function(e){a.setState({error:e})})}catch(c){a.setState({error:c})}else s.signInWithEmailAndPassword(n,r).then(function(){a.setState(Object(U.a)({},Ie))}).catch(function(e){a.setState({error:e})});e.preventDefault()},a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.enableGoogleLogin=function(e){(0,a.props.firebase.signInWithGoogle)(),e.preventDefault()},a.enableGithubLogin=function(e){(0,a.props.firebase.signInWithGoogle)(),e.preventDefault()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=window.localStorage;this.setState({email:e.getItem("loginEmail")||""})}},{key:"render",value:function(){var e=this.state,t=e.email,a=e.password,n=e.error,r=""===a||""===t;return y.a.createElement("form",{className:"user-form"},y.a.createElement(ae,{size:"md",variant:"outlined",color:"neutral",onClick:this.enableGoogleLogin,className:"login__btn--alt"},"Continue with Google"),y.a.createElement(ae,{size:"md",variant:"outlined",color:"neutral",onClick:this.enableGithubLogin,className:"login__btn--alt"},"Continue with Github"),y.a.createElement(ee,{name:"email",id:"email",label:"Email",value:t,onChange:this.onChange,type:"email",className:"user-form__input",labelClass:"user-form__label"}),y.a.createElement(ee,{name:"password",id:"password",label:"Password",value:a,onChange:this.onChange,type:"password",className:"user-form__input",labelClass:"user-form__label"}),y.a.createElement(ke,null),y.a.createElement(ae,{disabled:r,type:"submit",size:"md",variant:"contained",color:"secondary",onClick:this.onSubmit,className:"login__btn"},"Log In"),n&&y.a.createElement(ie,{text:n.message}))}}]),t}(k.Component),_e=Object(z.a)(V.a,K)(je),Ee=(a(311),function(){return y.a.createElement("main",{className:"login"},y.a.createElement("div",{className:"login__content"},y.a.createElement("h1",{className:"login__heading"},"Log In"),y.a.createElement(_e,null)),y.a.createElement("footer",{className:"login__footer"},y.a.createElement(pe,null)))}),we=y.a.createContext(null),Oe=new Q,Ce=function(e){return{type:"LOAD_LISTS_BY_ID",listsById:e}},Te=function(e){return{type:"UPDATE_LIST",listId:e.listId,listData:e.listData}},Ne=function(e){return{type:"ADD_LIST",listId:e.listId,listData:e.listData}},De=function(e){return{type:"REMOVE_LIST",listId:e.listId,projectId:e.projectId}},Se=function(e){var t=e.listId,a=e.projectId;return function(){var e=Object(W.a)(F.a.mark(function e(n,r){var s,c,o,i,l,u;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=Oe.createBatch(),c=Oe.getDocRef("lists",t),o=Oe.getDocRef("projects",a),i=r().listsById[t].taskIds,l=r(),u=l.tasksById,s.delete(c),Oe.updateBatch(s,o,{listIds:Oe.removeFromArray(t)}),e.abrupt("return",s.commit().then(function(){i.length>0&&i.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var a;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=u[t],a.assignedTo,a.folders,a.subtaskIds,a.commentIds,a.tags,a.projectId,a.dueDate,a.workspaceId,n(ct({taskId:t}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}).catch(function(e){console.error(e)}));case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])}));return function(t,a){return e.apply(this,arguments)}}()},Ae=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a){var n;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.fs.collection("lists").where("projectId","==",e).get().then(function(e){var t={};return e.forEach(function(e){t[e.id]=Object(U.a)({listId:e.id},e.data())}),t});case 3:n=t.sent,a(Ce(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},xe=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a){var n;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.fs.collection("lists").where("userId","==",e).get().then(function(e){var t={};return e.forEach(function(e){t[e.id]=Object(U.a)({listId:e.id},e.data())}),t});case 3:n=t.sent,a(Ce(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},Pe=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.queryCollection("lists",["projectId","==",e]).onSnapshot(function(t){var r=t.docChanges(),s=n().projectsById[e];if(t.size===r.length&&r.every(function(e){return"added"===e.type})){var c={};r.forEach(function(e){var t=e.doc.id,n=e.doc.data(),r=n.taskIds;c[t]=Object(U.a)({listId:t},n),r.forEach(function(e){return a(rt(e,"subtasks"))})}),a(Ce(c)),s.isLoaded.lists||a(Re(e,"lists"))}else r.forEach(function(){var t=Object(W.a)(F.a.mark(function t(r){var s,c,o,i,l,u,d;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=n(),c=s.listsById,t.next=3,Promise.all([r.doc.id,r.doc.data(),r.type]);case 3:if(o=t.sent,i=Object(H.a)(o,3),l=i[0],u=i[1],"added"!==(d=i[2])){t.next=15;break}if(!(c&&l in c)){t.next=11;break}return t.abrupt("return");case 11:a(Ne({listId:l,listData:u})),console.log("List added: ".concat(u.name)),t.next=24;break;case 15:if("removed"!==d){t.next=22;break}if(l in c){t.next=18;break}return t.abrupt("return");case 18:a(De({listId:l,projectId:e})),console.log("List deleted: ".concat(u.name)),t.next=24;break;case 22:a(Te({listId:l,listData:u})),console.log("List updated: ".concat(u.name));case 24:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())});case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},Be=function(e){var t=e.projectId,a=e.name;return function(){var e=Object(W.a)(F.a.mark(function e(n){return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{Oe.addList({projectId:t,name:a})}catch(n){console.log(n)}case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Me=function(e){return{type:"LOAD_PROJECTS_BY_ID",projectsById:e}},Ue=function(e){return{type:"SET_TEMP_PROJECT_SETTINGS",projectId:e.projectId,view:e.view,sortBy:e.sortBy,layout:e.layout}},Re=function(e,t){return{type:"SET_PROJECT_LOADED_STATE",projectId:e,key:t}},Le=function(e){return{type:"UPDATE_PROJECT",projectId:e.projectId,projectData:e.projectData}},Fe=function(e){var t=e.projectId,a=e.projectData;return{type:"ADD_PROJECT",projectId:t,projectData:Object(U.a)({tempSettings:{layout:a.settings.layout,tasks:Object(U.a)({},a.settings.tasks)}},a)}},We=function(e){return{type:"REMOVE_PROJECT",projectId:e}},ze=function(e,t){return{type:"REORDER_LISTS",projectId:e,listIds:t}},Ve=function(e,t){return{type:"UPDATE_PROJECT_TAGS",projectId:e,tags:t}},qe=function(e){return{type:"LOAD_PROJECT_TAGS",projectId:e.projectId,tags:e.tags}},Ke=function(e){return{type:"CREATE_TAG",tagId:e.tagId,tagData:e.tagData,projectId:e.projectId}},Ye=function(e){return{type:"UPDATE_TAG",tagId:e.tagId,tagData:e.tagData,projectId:e.projectId}},Ge=function(e){return{type:"DELETE_TAG",tagId:e.tagId,projectId:e.projectId}},He=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a){var n;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.getDocRef("projects",e).onSnapshot(function(t){var n=t.data();a(Le({projectId:e,projectData:n}))});case 3:return n=t.sent,t.abrupt("return",n);case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},Je=function(e){var t=e.userId,a=e.workspaceId;return function(){var e=Object(W.a)(F.a.mark(function e(n,r){var s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.queryCollection("projects",["memberIds","array-contains",t]).where("workspaceId","==",a).onSnapshot(function(){var e=Object(W.a)(F.a.mark(function e(t){var a,s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.docChanges(),t.size===a.length&&a.every(function(e){return"added"===e.type})?(s={},a.forEach(function(e){var t=e.doc.id,a=e.doc.data();s[t]=Object(U.a)({projectId:t,isLoaded:{subtasks:0===a.listIds.length,tasks:!0,lists:0===a.listIds.length,tags:0===a.listIds.length},tempSettings:{layout:a.settings.layout,tasks:Object(U.a)({},a.settings.tasks)}},a)}),n(Me(s))):a.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var a,s,c,o,i,l,u;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.doc.id,t.doc.data(),t.type]);case 2:if(a=e.sent,s=Object(H.a)(a,3),c=s[0],o=s[1],i=s[2],l=r(),u=l.projectsById,"added"!==i){e.next=15;break}if(!(c in u)){e.next=11;break}return e.abrupt("return");case 11:n(Fe({projectId:c,projectData:o})),console.log("Added Project: ".concat(o.name)),e.next=24;break;case 15:if("removed"!==i){e.next=22;break}if(c in u){e.next=18;break}return e.abrupt("return");case 18:n(We(c)),console.log("Deleted Project: ".concat(o.name)),e.next=24;break;case 22:n(Le({projectId:c,projectData:o})),console.log("Updated Project: ".concat(o.name));case 24:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:return s=e.sent,e.abrupt("return",s);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}()},Xe=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a){var n;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.fs.collection("lists").where("projectId","==",e).get().then(function(e){var t={};return e.forEach(function(e){t[e.id]=Object(U.a)({listId:e.id},e.data())}),t});case 3:n=t.sent,a(Ce(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},Qe=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.getDocRef("projects",e).collection("tags").onSnapshot(function(){var t=Object(W.a)(F.a.mark(function t(r){var s,c;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.docChanges();case 2:s=t.sent,r.size===s.length&&s.every(function(e){return"added"===e.type})?(c={},r.forEach(function(e){c[e.id]=e.data()}),a(qe({tags:c,projectId:e})),a(Re(e,"tags"))):s.forEach(function(){var t=Object(W.a)(F.a.mark(function t(r){var s,c,o,i,l,u,d,p;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=n(),c=s.projectsById,t.next=3,Promise.all([r.doc.id,r.doc.data(),r.type]);case 3:if(o=t.sent,i=Object(H.a)(o,3),l=i[0],u=i[1],d=i[2],p=c[e].tags,"added"!==d){t.next=16;break}if(!(p&&l in p)){t.next=12;break}return t.abrupt("return");case 12:a(Ke({tagId:l,tagData:u,projectId:e})),console.log("tag added"),t.next=17;break;case 16:"removed"===d?a(Ge({tagId:l,projectId:e})):0===u.count?Oe.deleteTag({projectId:e,tagId:l}):(a(Ye({tagId:l,tagData:u,projectId:e})),console.log("Updated Tag: ".concat(u.name)));case 17:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},$e=function(e){return{type:"LOAD_TASKS_BY_ID",tasksById:e}},Ze=function(e){return{type:"ADD_TASK",taskId:e.taskId,taskData:e.taskData}},et=function(e){return{type:"REMOVE_TASK",taskId:e.taskId,listId:e.listId}},tt=function(e){return{type:"UPDATE_TASK",taskId:e.taskId,taskData:e.taskData}},at=function(e,t){return{type:"ADD_TAG",taskId:e,tag:t}},nt=function(e){return{type:"REMOVE_TAG",taskId:e.taskId,name:e.name}},rt=function(e,t){return{type:"SET_TASK_LOADED_STATE",taskId:e,key:t}},st=function(e){var t=e.taskId,a=e.name,n=e.userId,r=e.projectId;return function(){var e=Object(W.a)(F.a.mark(function e(s,c){var o,i,l,u,d,p,m,f;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=c(),i=o.currentUser,l=o.projectsById,u=i.tags,d=r?l[r].tags:{},p=u&&a in u,m=d&&a in d?d[a].count-1:null,f=p?u[a].count-1:null,e.next=10,Oe.removeTag({taskId:t,name:a,userId:n,userCount:f,projectId:r,projectCount:m});case 10:console.log("tag removed"),s(nt({taskId:t,name:a})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}},e,null,[[0,14]])}));return function(t,a){return e.apply(this,arguments)}}()},ct=function(e){var t=e.taskId,a=e.listId,n=void 0===a?null:a;return function(){var e=Object(W.a)(F.a.mark(function e(a,r){var s,c,o,i,l,u,d,p,m,f;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=r().tasksById[t],c=s.folders,o=s.subtaskIds,i=s.commentIds,l=s.assignedTo,u=s.tags,d=s.projectId,p=s.dueDate,m=s.workspaceId,f=r().currentUser.userId,e.next=5,Oe.deleteTask({taskId:t,listId:n,assignedTo:l,folders:c,subtaskIds:o,commentIds:i,dueDate:p,projectId:d,workspaceId:m,userId:f});case 5:u&&u.forEach(function(e){a(st({taskId:t,name:e,userId:f,projectId:d}))}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}()},ot=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.queryCollection("tasks",["projectId","==",e]).onSnapshot(function(t){var r=t.docChanges(),s=t.size===r.length&&r.every(function(e){return"added"===e.type});if(s&&r.length>1){var c={};r.forEach(function(e){var t=e.doc.id,a=e.doc.data();c[t]=Object(U.a)({isLoaded:{subtasks:!1,comments:!1},taskId:t},a)}),a($e(c))}else r.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var r,s,c,o,i,l,u,d;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.doc.id,t.doc.data(),t.type]);case 2:if(r=e.sent,s=Object(H.a)(r,3),c=s[0],o=s[1],i=s[2],l=n(),u=l.tasksById,"added"!==i){e.next=15;break}if(!(c in u)){e.next=11;break}return e.abrupt("return");case 11:a(Ze({taskId:c,taskData:o})),console.log("Task added: ".concat(o.name)),e.next=25;break;case 15:if("removed"!==i){e.next=23;break}if(c in u!==!1){e.next=18;break}return e.abrupt("return");case 18:d=o.listId,a(et({taskId:c,listId:d})),console.log("Deleted Task: ".concat(o.name)),e.next=25;break;case 23:a(tt({taskId:c,taskData:o})),console.log("Updated Task: ".concat(o.name));case 25:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());s&&a(Re(e,"tasks"))});case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},it=function(e){var t=e.userId,a=e.workspaceId;return function(){var e=Object(W.a)(F.a.mark(function e(n,r){var s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.queryCollection("tasks",["workspaceId","==",a]).where("isPrivate","==",!1).onSnapshot(function(e){var a=e.docChanges();if(e.size===a.length&&a.every(function(e){return"added"===e.type})){var s={},c=[];a.forEach(function(e){var a=e.doc.id,n=e.doc.data(),r=n.subtaskIds,o=n.commentIds;s[a]=Object(U.a)({isLoaded:{subtasks:0===r.length,comments:0===o.length},taskId:a},n),n.assignedTo.includes(t)&&(c=c.concat(a))}),n($e(s)),n(wt(c))}else a.forEach(function(){var e=Object(W.a)(F.a.mark(function e(a){var s,c,o,i,l,u,d,p,m,f,h,v;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([a.doc.id,a.doc.data(),a.type]);case 2:if(s=e.sent,c=Object(H.a)(s,3),o=c[0],i=c[1],l=c[2],u=r(),d=u.tasksById,p=u.currentUser,m=p.assignedTasks,f=i.assignedTo.includes(t),h=m&&m.includes(o),"added"!==l){e.next=19;break}if(!(o in d)){e.next=14;break}return e.abrupt("return");case 14:n(Ze({taskId:o,taskData:i})),console.log("Task added: ".concat(i.name)),f&&n(Ot(o)),e.next=32;break;case 19:if("removed"!==l){e.next=28;break}if(o in d!==!1){e.next=22;break}return e.abrupt("return");case 22:v=i.listId,f&&n(Ct(o)),n(et({taskId:o,listId:v})),console.log("Deleted Task: ".concat(i.name)),e.next=32;break;case 28:!f&&h&&n(Ct(o)),n(tt({taskId:o,taskData:i})),console.log("Updated Task: ".concat(i.name)),f&&!h&&n(Ot(o));case 32:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())});case 3:return s=e.sent,e.abrupt("return",s);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}()},lt=function(e){var t=e.userId,a=e.workspaceId;return function(){var e=Object(W.a)(F.a.mark(function e(n,r){var s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.queryCollection("tasks",["ownerId","==",t]).where("workspaceId","==",a).where("isPrivate","==",!0).onSnapshot(function(e){var t=e.docChanges();if(e.size===t.length&&t.every(function(e){return"added"===e.type})){var a={};t.forEach(function(e){var t=e.doc.id,n=e.doc.data();a[t]=Object(U.a)({taskId:t,isLoaded:{subtasks:!1,comments:!1}},n)}),n($e(a)),n(wt(Object.keys(a)))}else t.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var a,s,c,o,i,l,u,d;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.doc.id,t.doc.data(),t.type]);case 2:if(a=e.sent,s=Object(H.a)(a,3),c=s[0],o=s[1],i=s[2],l=r(),u=l.tasksById,"added"!==i){e.next=16;break}if(!(u&&c in u)){e.next=11;break}return e.abrupt("return");case 11:n(Ze({taskId:c,taskData:o})),n(Ot(c)),console.log("Task added: ".concat(o.name)),e.next=27;break;case 16:if("removed"!==i){e.next=25;break}if(!u||c in u){e.next=19;break}return e.abrupt("return");case 19:d=o.listId,n(Ct(c)),n(et({taskId:c,listId:d})),console.log("Task removed: ".concat(o.name)),e.next=27;break;case 25:n(tt({taskId:c,taskData:o})),console.log("Task updated: ".concat(o.name));case 27:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())});case 3:return s=e.sent,e.abrupt("return",s);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}()},ut=function(e){var t=e.projectId,a=e.tag;return function(){var e=Object(W.a)(F.a.mark(function e(n,r){var s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.queryCollection("tasks",["projectId","==",t]).where("tags","array-contains",a).onSnapshot(function(e){var t=e.docChanges();if(e.size===t.length&&t.every(function(e){return"added"===e.type})&&t.length>1){var a={};t.forEach(function(e){a[e.doc.id]=Object(U.a)({taskId:e.doc.id,isLoaded:{subtasks:!1,comments:!1}},e.doc.data())}),n($e(a))}else t.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var a,s,c,o,i,l,u,d;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.doc.id,t.doc.data(),t.type]);case 2:if(a=e.sent,s=Object(H.a)(a,3),c=s[0],o=s[1],i=s[2],l=r(),u=l.tasksById,"added"!==i){e.next=15;break}if(!(c in u)){e.next=11;break}return e.abrupt("return");case 11:n(Ze({taskId:c,taskData:o})),console.log("Task added: ".concat(o.name)),e.next=25;break;case 15:if("removed"!==i){e.next=23;break}if(c in u!==!1){e.next=18;break}return e.abrupt("return");case 18:d=o.listId,n(et({taskId:c,listId:d})),console.log("Removed Task: ".concat(o.name)),e.next=25;break;case 23:n(tt({taskId:c,taskData:o})),console.log("Updated Task: ".concat(o.name));case 25:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())});case 3:return s=e.sent,e.abrupt("return",s);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}()},dt=function(e){return{type:"LOAD_USER_DATA",user:e}},pt=function(e){return{type:"LOAD_USERS_BY_ID",usersById:e}},mt=function(e){return{type:"ADD_USER",userId:e.userId,userData:e.userData}},ft=function(e){return{type:"REMOVE_USER",userId:e}},ht=function(e){return{type:"UPDATE_USER",userId:e.userId,userData:e.userData}},vt=function(e,t){return{type:"UPDATE_USER_STATUS",userId:e,status:t}},bt=function(){return function(){var e=Object(W.a)(F.a.mark(function e(t){var a;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.fs.collection("users").get().then(function(e){var t={};return e.forEach(function(e){t[e.id]=Object(U.a)({userId:e.id},e.data())}),t});case 3:a=e.sent,t(pt(a)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}()},gt=function(){return function(){var e=Object(W.a)(F.a.mark(function e(t,a){var n;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.fs.collection("users").onSnapshot(function(e){var n=e.docChanges();if(e.size===n.length&&n.every(function(e){return"added"===e.type})&&n.length>1){var r={};n.forEach(function(e){var t=e.doc.id,a=e.doc.data();r[t]=Object(U.a)({userId:t},a)}),t(pt(r))}else{var s=a().usersById;n.forEach(function(){var e=Object(W.a)(F.a.mark(function e(a){var n,r,c,o,i;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([a.doc.id,a.doc.data(),a.type]);case 2:n=e.sent,r=Object(H.a)(n,3),c=r[0],o=r[1],i=r[2],e.t0=i,e.next="added"===e.t0?10:"removed"===e.t0?14:18;break;case 10:if(!(c in s)){e.next=12;break}return e.abrupt("return");case 12:return t(mt({userId:c,userData:o})),e.abrupt("break",19);case 14:if(c in s){e.next=16;break}return e.abrupt("return");case 16:return t(ft(c)),e.abrupt("break",19);case 18:t(ht({userId:c,userData:o}));case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}});case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}()},kt=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.fs.collection("users").where("workspaceIds","array-contains",e).onSnapshot(function(e){var t=e.docChanges();if(e.size===t.length&&t.every(function(e){return"added"===e.type})&&t.length>1){var r={};t.forEach(function(e){var t=e.doc.id,a=e.doc.data();r[t]=Object(U.a)({userId:t},a)}),a(pt(r))}else t.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var r,s,c,o,i,l,u;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.doc.id,t.doc.data(),t.type]);case 2:r=e.sent,s=Object(H.a)(r,3),c=s[0],o=s[1],i=s[2],l=n(),u=l.usersById,e.t0=i,e.next="added"===e.t0?11:"removed"===e.t0?15:19;break;case 11:if(!(u&&c in u)){e.next=13;break}return e.abrupt("return");case 13:return a(mt({userId:c,userData:o})),e.abrupt("break",20);case 15:if(c in u){e.next=17;break}return e.abrupt("return");case 17:return a(ft(c)),e.abrupt("break",20);case 19:a(ht({userId:c,userData:o}));case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())});case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},yt=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a){var n;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.getUserDoc(e).get().then(function(e){return e.data()});case 3:n=t.sent,a(dt(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},It=function(){return function(){var e=Object(W.a)(F.a.mark(function e(t,a){var n;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.fs.collection("status").onSnapshot(function(e){e.docChanges().forEach(function(e){var a=e.doc.id,n=e.doc.data().state;"added"===e.type&&console.log("User ".concat(a," is online")),"removed"===e.type&&console.log("User ".concat(a," is offline.")),t(vt(a,n))})});case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}()},jt=function(e){return{type:"SET_CURRENT_USER",currentUser:e}},_t=function(){return{type:"RESET_CURRENT_USER"}},Et=function(e){return{type:"SET_TEMP_TASK_SETTINGS",view:e.view,sortBy:e.sortBy}},wt=function(e){return{type:"LOAD_ASSIGNED_TASKS",assignedTasks:e}},Ot=function(e){return{type:"ADD_ASSIGNED_TASK",taskId:e}},Ct=function(e){return console.log("Removed assigned task: ".concat(e)),{type:"REMOVE_ASSIGNED_TASK",taskId:e}},Tt=function(e){return{type:"LOAD_FOLDERS",folders:e}},Nt=function(e){return{type:"ADD_FOLDER",folderId:e.folderId,folderData:e.folderData}},Dt=function(e){return{type:"UPDATE_FOLDER",folderId:e.folderId,folderData:e.folderData}},St=function(e){return{type:"REMOVE_FOLDER",folderId:e}},At=function(e,t){return{type:"REORDER_FOLDERS",userId:e,folderIds:t}},xt=function(e){return{type:"LOAD_NOTIFICATIONS",notifications:e}},Pt=function(e){return{type:"ADD_NOTIFICATION",notificationId:e.notificationId,notificationData:e.notificationData}},Bt=function(e){return{type:"UPDATE_NOTIFICATION",notificationId:e.notificationId,notificationData:e.notificationData}},Mt=function(e){return{type:"REMOVE_NOTIFICATION",notificationId:e}},Ut=function(e){return{type:"LOAD_USER_TAGS",tags:e}},Rt=function(e){return{type:"CREATE_TAG",tagId:e.tagId,tagData:e.tagData}},Lt=function(e){return{type:"UPDATE_TAG",tagId:e.tagId,tagData:e.tagData}},Ft=function(e){return{type:"DELETE_TAG",tagId:e}},Wt=function(e){var t=e.userId,a=e.folderId;return function(){var e=Object(W.a)(F.a.mark(function e(n){return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.getDocRef("users",t,"folders",a).delete();case 3:n(St(a)),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()},zt=function(){return function(){var e=Object(W.a)(F.a.mark(function e(t,a){var n,r,s,c,o;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=a(),r=n.currentUser,s=r.userId,c=r.settings.activeWorkspace,e.next=5,Oe.getDocRef("users",s,"workspaces",c).collection("folders").onSnapshot(function(){var e=Object(W.a)(F.a.mark(function e(n){var r,c;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.docChanges(),!(n.size===r.length&&r.every(function(e){return"added"===e.type})&&r.length>1)){e.next=9;break}return c={},r.forEach(function(e){var t=e.doc.id,a=e.doc.data();c[t]=Object(U.a)({folderId:t},a)}),e.next=7,t(Tt(c));case 7:e.next=10;break;case 9:r.forEach(function(){var e=Object(W.a)(F.a.mark(function e(n){var r,c,o,i,l,u;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.doc.id,n.doc.data(),n.type]);case 2:r=e.sent,c=Object(H.a)(r,3),o=c[0],i=c[1],l=c[2],u=a().currentUser.folders,e.t0=l,e.next="added"===e.t0?11:"removed"===e.t0?16:18;break;case 11:if(!(o in u)){e.next=13;break}return e.abrupt("return");case 13:return t(Nt({folderId:o,folderData:i})),console.log("folder added"),e.abrupt("break",20);case 16:return!n.doc.exists&&o in u&&t(St(o)),e.abrupt("break",20);case 18:return 0!==i.taskIds.length||["0","1","2","3","4","5"].includes(o)?(t(Dt({folderId:o,folderData:i})),console.log("Updated Folder: ".concat(i.name))):t(Wt({userId:s,folderId:o})),e.abrupt("break",20);case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 5:return o=e.sent,e.abrupt("return",o);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t,a){return e.apply(this,arguments)}}()},Vt=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.getDocRef("users",e).collection("tags").onSnapshot(function(){var e=Object(W.a)(F.a.mark(function e(t){var r,s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.docChanges();case 2:if(r=e.sent,!(t.size===r.length&&r.every(function(e){return"added"===e.type}))){e.next=11;break}return s={},t.forEach(function(e){s[e.id]=e.data()}),e.next=9,a(Ut(s));case 9:e.next=12;break;case 11:r.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var r,s,c,o,i,l;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.doc.id,t.doc.data(),t.type]);case 2:if(r=e.sent,s=Object(H.a)(r,3),c=s[0],o=s[1],i=s[2],l=n().currentUser.tags,"added"!==i){e.next=15;break}if(!(l&&c in l)){e.next=11;break}return e.abrupt("return");case 11:a(Rt({tagId:c,tagData:o})),console.log("tag added"),e.next=16;break;case 15:"removed"===i?a(Ft(c)):(a(Lt({tagId:c,tagData:o})),console.log("Updated Tag: ".concat(o.name)));case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},qt=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.queryCollection("tasks",["assignedTo","array-contains",e]).onSnapshot(function(){var e=Object(W.a)(F.a.mark(function e(t){var r,s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.docChanges(),t.size===r.length&&r.every(function(e){return"added"===e.type})&&r.length>1?(s={},r.forEach(function(e){var t=e.doc.id,a=e.doc.data(),n=a.subtaskIds,r=a.commentIds;s[t]=Object(U.a)({isLoaded:{subtasks:0===n.length,comments:0===r.length},taskId:t},a)}),a($e(s)),a(wt(Object.keys(s)))):r.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var r,s,c,o,i,l;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.doc.id,t.doc.data(),t.type]);case 2:r=e.sent,s=Object(H.a)(r,3),c=s[0],o=s[1],"added"===(i=s[2])?(c in n().tasksById||a(Ze({taskId:c,taskData:o})),a(Ot(c)),console.log("task added")):"removed"===i?(l=o.listId,a(Ct(c)),c in n().tasksById&&!t.doc.exists&&a(et({taskId:c,listId:l}))):(a(tt({taskId:c,taskData:o})),console.log("Updated Task: ".concat(o.name)));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},Kt=function(e,t){return function(){var a=Object(W.a)(F.a.mark(function a(n,r){var s;return F.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Oe.getDocRef("users",e).onSnapshot(function(a){var s=a.data()||null;r().currentUser?n(ht({userId:e,userData:s})):(s&&s.settings&&(s.tempSettings={tasks:Object(U.a)({},s.settings.tasks)}),n(jt(s)),null===s?t.push("/setup"):t.push("/0/home/".concat(e)))});case 3:return s=a.sent,a.abrupt("return",s);case 7:a.prev=7,a.t0=a.catch(0),console.error(a.t0);case 10:case"end":return a.stop()}},a,null,[[0,7]])}));return function(e,t){return a.apply(this,arguments)}}()},Yt=function(e){var t=e.userId,a=e.workspaceId;return function(){var e=Object(W.a)(F.a.mark(function e(n,r){var s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.getDocRef("users",t,"workspaces",a).onSnapshot(function(e){var a=e.data()||null;n(ht({userId:t,userData:a}))});case 3:return s=e.sent,e.abrupt("return",s);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}()},Gt=function(e){var t=e.userId,a=e.workspaceId;return function(){var e=Object(W.a)(F.a.mark(function e(n,r){var s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.getCollection("notifications").where("recipientId","==",t).where("workspaceId","==",a).where("isActive","==",!0).onSnapshot(function(){var e=Object(W.a)(F.a.mark(function e(t){var a,s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.docChanges(),!(t.size===a.length&&a.every(function(e){return"added"===e.type})&&a.length>1)){e.next=9;break}return s={},a.forEach(function(e){var t=e.doc.id,a=e.doc.data();s[t]=Object(U.a)({notificationId:t},a)}),e.next=7,n(xt(s));case 7:e.next=10;break;case 9:a.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var a,s,c,o,i,l;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.doc.id,t.doc.data(),t.type]);case 2:a=e.sent,s=Object(H.a)(a,3),c=s[0],o=s[1],i=s[2],l=r().currentUser.notifications,e.t0=i,e.next="added"===e.t0?11:"removed"===e.t0?16:18;break;case 11:if(!(l&&c in l)){e.next=13;break}return e.abrupt("return");case 13:return n(Pt({notificationId:c,notificationData:o})),console.log("notification added"),e.abrupt("break",23);case 16:return l&&c in l&&(n(Mt(c)),console.log("notification removed")),e.abrupt("break",23);case 18:if(o.isActive){e.next=20;break}return e.abrupt("return");case 20:return n(Bt({notificationId:c,notificationData:o})),console.log("notification updated"),e.abrupt("break",23);case 23:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:return s=e.sent,e.abrupt("return",s);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}()},Ht=[{long:"January",short:"Jan",daysTotal:31},{long:"February",short:"Feb",daysTotal:null},{long:"March",short:"Mar",daysTotal:31},{long:"April",short:"Apr",daysTotal:30},{long:"May",short:"May",daysTotal:31},{long:"June",short:"Jun",daysTotal:30},{long:"July",short:"Jul",daysTotal:31},{long:"August",short:"Aug",daysTotal:31},{long:"September",short:"Sep",daysTotal:30},{long:"October",short:"Oct",daysTotal:31},{long:"November",short:"Nov",daysTotal:30},{long:"December",short:"Dec",daysTotal:31}],Jt=[{long:"Sunday",short:"Sun",narrow:"S"},{long:"Monday",short:"Mon",narrow:"M"},{long:"Tuesday",short:"Tue",narrow:"T"},{long:"Wednesday",short:"Wed",narrow:"W"},{long:"Thursday",short:"Thu",narrow:"T"},{long:"Friday",short:"Fri",narrow:"F"},{long:"Saturday",short:"Sat",narrow:"S"}],Xt=function(e,t){return 1===e?function(e){return e%4===0&&e%100!==0||e%400===0}(t)?29:28:Ht[e].daysTotal},Qt=function(e,t){return{month:e>0?e-1:11,year:e>0?t:t-1}},$t=function(e,t){return{month:e<11?e+1:0,year:e<11?t:t+1}},Zt=function(e,t){var a=Xt(e,t),n=function(e,t){return new Date(t,e,1).getDay()}(e,t),r=Qt(e,t),s=r.month,c=r.year,o=Xt(s,c),i=n,l=7-(n+a)%7,u=Object(G.a)(new Array(i)).map(function(e,t){return{day:o-i+t+1,month:s,year:c}}),d=Object(G.a)(new Array(a)).map(function(a,n){return{day:n+1,month:e,year:t}}),p=Object(G.a)(new Array(l)).map(function(a,n){return Object(U.a)({day:n+1},$t(e,t))});return[].concat(Object(G.a)(u),Object(G.a)(d),Object(G.a)(p))},ea=function(e){return"[object Date]"===Object.prototype.toString.call(e)},ta=function(e){var t=ea(e)||"string"!==typeof e?e:new Date(e);return{day:t.getDate(),month:t.getMonth(),year:t.getFullYear()}},aa=function(e){return e&&"day"in e&&"month"in e&&"year"in e},na=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;if(!ea(e)&&!aa(e)||!ea(t)&&!aa(t))return!1;var a=e.day||e.getDate(),n=e.month||e.getMonth(),r=e.year||e.getFullYear(),s=t.day||t.getDate(),c=t.month||t.getMonth(),o=e.year||t.getFullYear();return a===s&&n===c&&r===o},ra=function(e,t){return"".concat(e).padStart(t,"0")},sa=function(e){var t=aa(e)?e:ea(e)?ta(e):void 0;if(!t)return"";var a=t.day,n=t.month,r=t.year;return"".concat(ra(n+1,2),"-").concat(ra(a,2),"-").concat(r-2e3)},ca=function(e){var t=e.split("-"),a=t[0]-1,n=+t[1],r=+t[2]+2e3;return n>Xt(a,r)?ta(new Date(r,a,n)):{month:a,day:n,year:r}},oa=function(e){return/^\d{2}-\d{2}-\d{2}$/.test(e)},ia=function(e){return+e<(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date).setHours(0,0,0,0)},la=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useRelative:!1,format:{weekday:"short",month:"short",day:"numeric",year:"2-digit"}},a=t.useRelative,n=t.format;if(a){if(function(e){return(new Date).setHours(0,0,0,0)===new Date(+e).setHours(0,0,0,0)}(e))return"Today";if(function(e){var t=new Date;return t.setHours(0,0,0,0),t.setDate(t.getDate()-1)===new Date(+e).setHours(0,0,0,0)}(e))return"Yesterday";if(function(e){var t=new Date;return t.setHours(0,0,0,0),t.setDate(t.getDate()+1)===new Date(+e).setHours(0,0,0,0)}(e))return"Tomorrow";if(function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,n=a.setHours(0,0,0,0),r=new Date(a),s=r.setDate(r.getDate()+t);return+e>=n&&+e<s}(e,7))return Jt[e.getDay()].long}return Object.keys(n).map(function(t){switch(t){case"weekday":var r=n[t],s=e.getDay();return Jt[s][r];case"month":var c=n[t],o=e.getMonth();return"numeric"===c?o+1:"2-digit"===c?ra(o+1,2):Ht[o][c];case"day":var i=n[t],l=e.getDate();return"2-digit"===i?ra(l,2):l;case"year":var u=n[t],d=e.getFullYear();return a&&function(e){return e.getFullYear()===(new Date).getFullYear()}(e)?null:"2-digit"===u?"'".concat(+d.slice(2)):d;default:return t}}).join(" ").trim()},ua=function(e,t){var a=t.format,n=void 0===a?"h:mm:ss":a,r=t.hour12,s=void 0===r||r;try{if(!ea(e))throw new TypeError("Not a Date object");var c=e.getHours(),o=e.getMinutes(),i=e.getSeconds(),l=n.split(":").map(function(e,t){var a=e.length;if(0===t){var n=s&&c>12?c-12:c;return a>1&&n<10?ra(n,a):n}return 1===t?a>1&&o<10?ra(o,a):o:2===t?a>1&&i<10?ra(i,a):i:void 0}).join(":");return s?"".concat(l," ").concat(c<12?"AM":"PM"):l}catch(u){console.error(u)}},da=function(e){return e.tasksById},pa=function(e){var t=e.tasksById;return t?Object.keys(t).map(function(e){return t[e]}):[]},ma=function(e,t){var a=new RegExp("\\b".concat(t),"i");return pa(e).filter(function(e){return a.test(e.name)||a.test(e.projectName)||e.tags&&e.tags.some(function(e){return a.test(e)})})},fa=function(e,t){return e.tasksById[t]},ha=function(e,t){var a=e.tasksById,n=[];return t.forEach(function(e){var t=a[e];t&&(n=n.concat(t))}),n},va=function(e,t){var a=e.tasksById,n=[];return t.forEach(function(e){var t=a[e];t&&(n=n.concat(t))}),n},ba=function(e,t){var a=e.projectsById,n=e.tasksById,r=e.currentUser,s=n[t];if(!s)return[];var c=s.projectId,o=s.tags;if(!o||0===o.length)return[];if(c&&c in a){var i=a[c].tags;return o.map(function(e){return i[e]})}if(r&&"tags"in r){var l=r.tags;return o.map(function(e){return l[e]})}return[]},ga=function(e,t){var a=e.tasksById[t];return a?a.isLoaded:{}},ka=function(e,t){var a=e.tasksById;return Object.keys(a).map(function(e){return a[e]}).filter(function(e){return e.tags&&e.tags.includes(t)})},ya=function(e,t){var a=e.listsById,n=e.tasksById;return a[t].taskIds.reduce(function(e,t){var a=n[t],r=e.all,s=e.completed,c=e.active;return a?a.isCompleted?{active:c,all:[].concat(Object(G.a)(r),[a]),completed:[].concat(Object(G.a)(s),[a])}:{completed:s,all:[].concat(Object(G.a)(r),[a]),active:[].concat(Object(G.a)(c),[a])}:e},{all:[],completed:[],active:[]})},Ia=function(e,t){var a=t.listId,n=t.folderId,r=e.tasksById,s=e.listsById,c=e.currentUser,o=a?s[a]:null,i=n&&c.folders?c.folders[n]:null,l=o?o.taskIds:i?i.taskIds:[];return l.reduce(function(e,t){var a=r[t],n=e.completed,s=e.active;return a?a.isCompleted?Object(U.a)({},e,{completed:[].concat(Object(G.a)(n),[t])}):Object(U.a)({},e,{active:[].concat(Object(G.a)(s),[t])}):e},{all:l,completed:[],active:[]})},ja=function(e,t,a){var n=e.tasksById;switch(a){case"dueDate":return Object(G.a)(t).sort(function(e,t){var a=n[e],r=n[t],s=a.dueDate?a.dueDate.toMillis():null,c=r.dueDate?r.dueDate.toMillis():null;return!s&&c?1:s&&!c?-1:s||c?s-c:0});default:return t}},_a=function(e,t){var a=e.tasksById,n=e.usersById,r=a[t];return r?r.assignedTo.map(function(e){return n[e]}):[]},Ea=function(e,t){var a=e.tasksById,n=e.subtasksById,r=a[t];if(!r)return[];var s=r.subtaskIds;return s?s.filter(function(e){var t=n[e];if(t)return t.isCompleted}):[]},wa=function(e){return e.currentUser},Oa=function(e){var t=e.currentUser;return t?t.userId:null},Ca=function(e){var t=e.currentUser;return t?t.folders:null},Ta=function(e){var t=e.currentUser;return t?t.notifications:null},Na=function(e){var t=e.currentUser;if(!t)return[];var a=t.notifications;if(!a)return[];var n=function(e){return e.createdAt?e.createdAt.toMillis():Date.now()};return Object.keys(a).sort(function(e,t){var r=a[e],s=a[t];return n(s)-n(r)}).map(function(e){return a[e]})},Da=function(e){var t=e.currentUser;return t?t.settings.tasks:null},Sa=function(e){var t=e.currentUser;return t?t.tempSettings.tasks:null},Aa=function(e){var t=e.currentUser;return t?t.assignedTasks:null},xa=function(e){var t=e.currentUser;return t?t.folderIds:[]},Pa=function(e){var t=e.currentUser,a=e.tasksById;if(!t||!a)return[];var n=t.tempSettings,r=t.assignedTasks,s=t.folders,c=t.projectIds,o=t.folderIds;if(!s||!r||!c||!o)return[];var i=n.tasks,l=i.sortBy,u=i.view;switch(l){case"project":var d=c.reduce(function(t,a){var n=s[a];if(n){var r=n.name,c=n.taskIds;return t.concat(c.length>0?{taskIds:Ia(e,{folderId:a})[u],projectId:a,name:r,projectName:r,dueDate:null,folderId:a,userPermissions:{enableNameChange:!1,enableTaskAdd:!1,enableDragNDrop:!0}}:[])}return t},[]),p=s[4],m=Object(U.a)({},p,{projectId:null,projectName:null,dueDate:null,taskIds:Ia(e,{folderId:"4"})[u],userPermissions:{enableNameChange:!1,enableTaskAdd:!0,enableDragNDrop:!0}});return[].concat(Object(G.a)(d),[m]);case"folder":return o.reduce(function(t,a){var n=s[a];return n?t.concat(Object(U.a)({},n,{taskIds:Ia(e,{folderId:a})[u],projectId:null,projectName:null,dueDate:null,userPermissions:{enableNameChange:!["0","1","2","3"].includes(a),enableTaskAdd:!0,enableDragNDrop:!0}})):t},[]);case"dueDate":var f=[],h=r.reduce(function(e,t){var n=a[t];if(!n)return e;var r=n.dueDate,s=n.isCompleted;if("active"===u&&s||"completed"===u&&!s)return e;var c=r&&ia(r.toDate());if(r&&!c){var o=r.toMillis();"".concat(o)in e||(e["".concat(o)]={taskIds:[],projectId:null,name:la(r.toDate(),{useRelative:!0,format:{weekday:"short",month:"short",day:"numeric"}}),projectName:null,folderId:"".concat(o),dueDate:o,userPermissions:{enableNameChange:!1,enableTaskAdd:!0,enableDragNDrop:!0}},f=[].concat(Object(G.a)(f),[o])),e["".concat(o)].taskIds=[].concat(Object(G.a)(e["".concat(o)].taskIds),[t])}else r&&c&&("pastDue"in e||(e.pastDue={taskIds:[],projectId:null,name:"Past Due",projectName:null,folderId:null,dueDate:"pastDue",userPermissions:{enableNameChange:!1,enableTaskAdd:!1,enableDragNDrop:!1}}),e.pastDue.taskIds=[].concat(Object(G.a)(e.pastDue.taskIds),[t]));return e},{}),v=s[5],b=Object(U.a)({},v,{taskIds:Ia(e,{folderId:"5"})[u],projectId:null,projectName:null,dueDate:null,userPermissions:{enableNameChange:!1,enableTaskAdd:!0,enableDragNDrop:!0}}),g=h.pastDue,k=Object($.a)(h,["pastDue"]),y=Object(G.a)(f).sort(function(e,t){return e-t});return[].concat(Object(G.a)(g?[g]:[]),Object(G.a)(y.map(function(t){return"".concat(t)in s?Object(U.a)({},s["".concat(t)],{taskIds:Ia(e,{folderId:"".concat(t)})[u],projectId:null,name:la(new Date(t),{useRelative:!0,format:{weekday:"short",month:"short",day:"numeric"}}),projectName:null,folderId:"".concat(t),dueDate:t,userPermissions:{enableNameChange:!1,enableTaskAdd:!0,enableDragNDrop:!0}}):k["".concat(t)]})),[b]);default:return[]}},Ba=function(e,t){var a=e.currentUser;if(a){var n=a.folders;if(n)return n[t]}return null},Ma=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,a=e.currentUser,n=e.tasksById;if(!a||!n)return[];var r=a.assignedTasks;if(!r)return[];var s=(new Date).setHours(0,0,0,0),c=new Date(s),o=+new Date(c.setDate(c.getDate()+t));return r.reduce(function(e,t){var a=n[t];if(a){var r=a.isCompleted,s=a.dueDate;if(!r&&s&&s.toMillis()<=o)return e.concat(a)}return e},[]).sort(function(e,t){return e.dueDate.toMillis()-t.dueDate.toMillis()})},Ua=function(e){var t=e.currentUser,a=e.tasksById;if(!t||!a)return[];var n=t.assignedTasks;if(!n)return[];var r=(new Date).setHours(0,0,0,0);return n.reduce(function(e,t){var n=a[t];if(n){var s=n.isCompleted,c=n.dueDate;if(!s&&c&&c.toMillis()<r)return e.concat(n)}return e},[]).sort(function(e,t){return e.dueDate.toMillis()-t.dueDate.toMillis()})},Ra=function(e,t){var a=e.projectsById,n=e.currentUser;if(!n||!a)return[];var r=n.tags,s=t?a[t].tags:{},c=Object(U.a)({},r,s);return Object.keys(c).map(function(e){return c[e]})},La=function(e){var t=e.projectsById,a=e.currentUser;if(!a||!t)return[];var n=a.tags,r=a.projectIds;if(!r)return[];var s=r.reduce(function(e,a){var n=t[a];return n&&n.tags?Object(U.a)({},e,n.tags):e},{}),c=Object(U.a)({},n,s);return Object.keys(c).map(function(e){return c[e]})},Fa=function(e){var t=e.currentUser,a=e.projectsById;if(!t||!a)return[];var n=t.projectIds;return n?n.map(function(e){return a[e]}):[]};function Wa(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var za=function(e){return e.usersById},Va=function(e,t){var a=e.usersById;return a?a[t]:null},qa=function(e,t){var a=e.usersById[t].taskIds;return a||[]},Ka=function(e){var t=e.usersById;return t?Object.keys(t).map(function(e){return t[e]}):[]},Ya=function(e){var t=e.usersById;return t?Object.keys(t).map(function(e){return t[e].email}):[]},Ga=function(e,t){var a=e.usersById;return t&&a?t.map(function(e){return a[e]}):[]};function Ha(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var Ja=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_USERS_BY_ID":var a=t.usersById;return Object(U.a)({},e&&e,a);case"LOAD_USER_DATA":var n=t.user;return Object(U.a)({},e&&e,n);case"ADD_USER":var r=t.userId,s=t.userData;return Object(U.a)({},e&&e,Object(R.a)({},r,Object(U.a)({userId:r},s)));case"REMOVE_USER":var c=t.userId;return e[c],Object($.a)(e,[c].map(Ha));case"UPDATE_USER":var o=t.userId,i=t.userData;return e?Object(U.a)({},e,Object(R.a)({},o,Object(U.a)({},e[o],i))):e;case"UPDATE_USER_STATUS":var l=t.userId,u=t.status;return Object(U.a)({},e,Object(R.a)({},l,Object(U.a)({},e[l],{isOnline:"online"===u})));case"REORDER_FOLDERS":var d=t.userId,p=t.folderIds;return Object(U.a)({},e,Object(R.a)({},d,Object(U.a)({},e[d],{folderIds:p})));case"RESET_ACTIVE_WORKSPACE":return null;default:return e}},Xa=function(e){return{type:"SET_ACTIVE_WORKSPACE",workspace:e}},Qa=function(e){return{type:"UPDATE_ACTIVE_WORKSPACE",workspaceData:e}},$a=function(){return{type:"RESET_ACTIVE_WORKSPACE"}},Za=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.getDocRef("workspaces",e).onSnapshot(function(t){var r=t.data()||null;r&&(r.workspaceId=e);var s=n().activeWorkspace;s&&s.workspaceId===e?a(Qa(r)):a(Xa(r))});case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},en=function(e){return e.activeWorkspace},tn=function(e){return e.displayName||e.name||"Component"},an=function(){return+Date.now()+Math.random().toString(36).slice(2)},nn=function(e){var t=function(t){function a(){return Object(w.a)(this,a),Object(C.a)(this,Object(T.a)(a).apply(this,arguments))}return Object(N.a)(a,t),Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.firebase,n=t.history,r=t.setCurrentUser,s=t.resetActiveWorkspace,c=t.syncCurrentUser;n.location.pathname.includes("/guide")||(this.authListener=a.auth.onAuthStateChanged(function(){var t=Object(W.a)(F.a.mark(function t(o){var i,l,u,d;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!o){t.next=22;break}if(i=o.uid,l=o.emailVerified,u=o.isAnonymous,!l){t.next=8;break}return t.next=5,c(i,n);case 5:e.userListener=t.sent,t.next=20;break;case 8:if(!u){t.next=19;break}if(!a.isNewUser(o)){t.next=14;break}return t.next=12,a.createGuest(i).then(function(){return a.createDemoProject(i)}).then(Object(W.a)(F.a.mark(function t(){return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c(i,n);case 2:e.userListener=t.sent;case 3:case"end":return t.stop()}},t)}))).catch(function(e){console.error(e)});case 12:t.next=17;break;case 14:return t.next=16,c(i,n);case 16:e.userListener=t.sent;case 17:t.next=20;break;case 19:n.push("/verification-required");case 20:t.next=23;break;case 22:a.auth.isSignInWithEmailLink(window.location.href)?((d=window.localStorage.getItem("loginEmail"))||(d=window.prompt("Please provide your email for confirmation")),a.auth.signInWithEmailLink(d,window.location.href).then(Object(W.a)(F.a.mark(function e(){return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loginEmail");case 1:case"end":return e.stop()}},e)}))).catch(function(e){console.log(e)})):(n.push("/login"),e.userListener&&(e.userListener(),r(null)),e.workspaceListener&&(e.workspaceListener(),s()),e.tagListener&&e.tagListener());case 23:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()))}},{key:"componentDidUpdate",value:function(){var e=Object(W.a)(F.a.mark(function e(t){var a,n,r,s,c,o,i,l,u,d=this;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props,n=a.currentUser,r=a.syncActiveWorkspace,s=a.syncUserTags,c=a.resetActiveWorkspace,o=a.history,n){e.next=3;break}return e.abrupt("return");case 3:if(i=n.userId,l=n.settings,u=l.activeWorkspace,t.currentUser){e.next=9;break}return console.log("current user detected"),e.next=9,Promise.all([r(u),s(i)]).then(function(e){d.workspaceListener=e[0],d.tagListener=e[1]}).catch(function(e){console.error(e)});case 9:if(!t.currentUser){e.next=19;break}if(t.currentUser.settings.activeWorkspace===u){e.next=19;break}return o.push("/0/home/".concat(i)),c(),this.workspaceListener(),e.next=17,r(u);case 17:this.workspaceListener=e.sent,console.log("changed active workspace");case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.authListener&&this.authListener(),this.userListener&&this.userListener(),this.workspaceListener&&this.workspaceListener(),this.tagListener&&this.tagListener()}},{key:"render",value:function(){var t=this.props.currentUser;return y.a.createElement(we.Provider,{value:t},y.a.createElement(e,this.props))}}]),a}(k.Component);t.displayName="WithAuthentication(".concat(tn(e),")");return Object(z.a)(V.a,K,Object(_.b)(function(e){return{currentUser:l.getCurrentUser(e)}},function(e){return{syncCurrentUser:function(t,a){return e(o.syncCurrentUser(t,a))},setCurrentUser:function(t){return e(o.setCurrentUser(t))},updateUser:function(t){var a=t.userId,n=t.userData;return e(c.updateUser({userId:a,userData:n}))},syncActiveWorkspace:function(t){return e(d.syncActiveWorkspace(t))},setActiveWorkspace:function(t){return e(d.setActiveWorkspace(t))},resetActiveWorkspace:function(){return e(d.resetActiveWorkspace())},syncUserTags:function(t){return e(o.syncUserTags(t))}}}))(t)},rn=function(e){return function(t){var a=function(a){function n(){return Object(w.a)(this,n),Object(C.a)(this,Object(T.a)(n).apply(this,arguments))}return Object(N.a)(n,a),Object(O.a)(n,[{key:"render",value:function(){var a=this.props,n=a.activeWorkspace,r=Object($.a)(a,["activeWorkspace"]);return y.a.createElement(we.Consumer,null,function(a){return e(a,n)?y.a.createElement(t,Object.assign({currentUser:a,activeWorkspace:n},r)):null})}}]),n}(k.Component);return a.displayName="WithAuthorization(".concat(tn(t),")"),Object(z.a)(V.a,K,Object(_.b)(function(e){return{activeWorkspace:p.getActiveWorkspace(e)}}))(a)}},sn=a(199),cn=a.n(sn),on=function(e){var t=e.name,a=e.className,n=e.width,r=e.height;return y.a.createElement("svg",{className:"jam jam-".concat(t," ").concat(a),preserveAspectRatio:"xMinYMin",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24",width:n,height:r,fill:"currentColor"},y.a.createElement("use",{xlinkHref:"".concat(cn.a,"#").concat(t)}))};on.defaultProps={className:"",width:24,height:24};var ln=on,un=function(e){var t=e.projectId,a=e.name,n=e.layout,r=e.onClick,s=e.color;return y.a.createElement("li",{className:"project-grid__tile project-grid__tile--".concat(s)},y.a.createElement(M.a,{className:"project-grid__link",to:"/0/projects/".concat(t,"/tasks"),onClick:r},y.a.createElement("span",{className:"project-grid__title"},a),y.a.createElement("span",{className:"project-grid__icon"},"board"===n?y.a.createElement(ce,{name:"trello"}):y.a.createElement(ln,{name:"task-list"}))))},dn=(a(312),function(e){return e.projectsById}),pn=function(e){var t=e.projectsById;return t?Object.keys(t).map(function(e){return t[e]}):[]},mn=function(e,t){return e.projectsById[t]},fn=function(e,t){return t?e.projectsById[t].tags:{}},hn=function(e,t){if(!t)return"";var a=e.projectsById[t];return a?a.name:null},vn=function(e,t){if(!t)return null;var a=e.projectsById[t];return a?a.color:null},bn=function(e,t){return t?e.projectsById[t].isLoaded:""},gn=function(e,t){var a=e.projectsById,n=e.listsById;return a&&n&&t?a[t].listIds.map(function(e){return n[e]}):[]},kn=function(e,t){return e.projectsById[t].tempSettings};function yn(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var In=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_PROJECTS_BY_ID":var a=t.projectsById;return Object(U.a)({},e&&e,a);case"ADD_PROJECT":var n=t.projectId,r=t.projectData,s=r.listIds,c=r.settings,o=r.isDuplicate,i=s.length;return Object(U.a)({},e&&e,Object(R.a)({},n,Object(U.a)({projectId:n,isLoaded:{subtasks:!o&&0===i,tasks:0===i,lists:!o&&0===i,tags:!o&&0===i},tempSettings:{tasks:Object(U.a)({},c.tasks)}},r)));case"REMOVE_PROJECT":var l=t.projectId;return e[l],Object($.a)(e,[l].map(yn));case"UPDATE_PROJECT":var u=t.projectId,d=t.projectData;return Object(U.a)({},e,Object(R.a)({},u,Object(U.a)({},e[u],d)));case"SET_PROJECT_LOADED_STATE":var p=t.projectId,m=t.key;return Object(U.a)({},e,Object(R.a)({},p,Object(U.a)({},e[p],{isLoaded:Object(U.a)({},e[p].isLoaded,Object(R.a)({},m,!0))})));case"REORDER_LISTS":var f=t.projectId,h=t.listIds;return Object(U.a)({},e,Object(R.a)({},f,Object(U.a)({},e[f],{listIds:h})));case"UPDATE_PROJECT_TAGS":var v=t.projectId,b=t.tags;return Object(U.a)({},e,Object(R.a)({},v,Object(U.a)({},e[v],{tags:Object(U.a)({},b)})));case"LOAD_PROJECT_TAGS":var g=t.projectId,k=t.tags;return Object(U.a)({},e,Object(R.a)({},g,Object(U.a)({},e[g],{tags:k})));case"CREATE_TAG":var y=t.tagId,I=t.tagData,j=t.projectId;return j?Object(U.a)({},e,Object(R.a)({},j,Object(U.a)({},e[j],{tags:Object(U.a)({},e[j].tags,Object(R.a)({},y,I))}))):e;case"DELETE_TAG":var _=t.tagId,E=t.projectId;if(!E)return e;var w=e[E].tags,O=(w[_],Object($.a)(w,[_].map(yn)));return Object(U.a)({},e,Object(R.a)({},E,Object(U.a)({},e[E],{tags:O})));case"UPDATE_TAG":var C=t.tagId,T=t.tagData,N=t.projectId;return N?Object(U.a)({},e,Object(R.a)({},N,Object(U.a)({},e[N],{tags:Object(U.a)({},e[N].tags,Object(R.a)({},C,Object(U.a)({},e[N].tags[C],T)))}))):e;case"SET_TEMP_PROJECT_SETTINGS":var D=t.projectId,S=t.view,A=t.sortBy,x=t.layout;return Object(U.a)({},e,Object(R.a)({},D,Object(U.a)({},e[D],{tempSettings:Object(U.a)({},e[D].tempSettings,{layout:x||e[D].tempSettings.layout,tasks:Object(U.a)({},e[D].tempSettings.tasks,{view:S||e[D].tempSettings.tasks.view,sortBy:A||e[D].tempSettings.tasks.sortBy})})})));case"RESET_ACTIVE_WORKSPACE":return null;default:return e}},jn=function(e){return{type:"SELECT_PROJECT",projectId:e}},_n=function(e){return e.selectedProject},En=function(e){var t=e.projects,a=e.selectProject,n=e.className,r=e.openProjectComposer;return y.a.createElement("ul",{className:"project-grid ".concat(n)},t.map(function(e){return y.a.createElement(un,{key:e.projectId,layout:e.settings.layout,name:e.name,color:e.color,projectId:e.projectId,onClick:function(){return a(e.projectId)}})}),y.a.createElement("button",{type:"button",className:"project-grid__tile project-grid__btn--add",onClick:r},y.a.createElement("span",{className:"project-grid__btn--text"},"Create project"),y.a.createElement(ce,{name:"plus"})))};En.defaultProps={className:""};var wn=Object(_.b)(function(e,t){return{projectsById:m.getProjectsById(e),projects:m.getProjectsArray(e),userId:l.getCurrentUserId(e)}},function(e){return{selectProject:function(t){return e(jn(t))}}})(En),On=function(e){var t=function(t){function a(e){var t;return Object(w.a)(this,a),(t=Object(C.a)(this,Object(T.a)(a).call(this,e))).handleTouch=function(){t.setState({isTouchEnabled:!0}),document.removeEventListener("touchstart",t.handleTouch),document.removeEventListener("mousedown",t.handleOutsideClick),document.addEventListener("touchstart",t.handleOutsideClick)},t.setRef=function(e){t.component=e},t.setInstance=function(e){t.instance=e},t.handleOutsideClick=function(e){if(!t.component)throw new Error("Must set component ref to prop innerRef!");if(!t.component.contains(e.target)&&(t.instance.onOutsideClick||t.props.onOutsideClick)){if(t.instance.onOutsideClick)t.instance.onOutsideClick(e);else{var a=t.props.onOutsideClick;a&&a(e)}e.stopPropagation()}},t.state={isTouchEnabled:!1},t}return Object(N.a)(a,t),Object(O.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("touchstart",this.handleTouch),document.addEventListener("mousedown",this.handleOutsideClick,!1)}},{key:"componentWillUnmount",value:function(){this.state.isTouchEnabled?document.removeEventListener("touchstart",this.handleOutsideClick):(document.removeEventListener("mousedown",this.handleOutsideClick),document.removeEventListener("touchstart",this.handleTouch))}},{key:"render",value:function(){return y.a.createElement(e,Object.assign({ref:this.setInstance,innerRef:this.setRef},this.props))}}]),a}(k.Component);return t.displayName="WithOutsideClick(".concat(tn(e),")"),t},Cn=(a(313),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).onOutsideClick=function(e){var t=a.props,n=t.onOutsideClick,r=t.onModalClose;n?n(e):r(e)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onModalClose,a=e.children,n=e.onModalClick,r=e.size,s=void 0===r?"md":r,c=e.classes,o=e.id,i=e.innerRef;return y.a.createElement("div",{className:"modal ".concat(c.modal||""),onClick:n},y.a.createElement("div",{id:o,ref:i,className:"modal__content ".concat(c.content||""," modal__content--").concat(s)},y.a.createElement(ae,{type:"button",className:"modal__btn--close ".concat(c.button||""),onClick:t,iconOnly:!0},y.a.createElement(ce,{name:"x"})),a))}}]),t}(k.Component));Cn.defaultProps={onModalClick:function(){return null},onOutsideClick:function(){return null}},Cn.defaultProps={classes:{modal:"",content:"",button:""}};var Tn=On(Cn),Nn=function(e){var t=e.classes,a=void 0===t?{radio:"",label:""}:t,n=e.name,r=e.id,s=e.value,c=e.onFocus,o=e.onChange,i=e.onInput,l=e.isRequired,u=e.onBlur,d=e.inputRef,p=e.hideLabel,m=e.label,f=e.onKeyDown,h=e.isChecked,v=Object($.a)(e,["classes","name","id","value","onFocus","onChange","onInput","isRequired","onBlur","inputRef","hideLabel","label","onKeyDown","isChecked"]);return y.a.createElement(y.a.Fragment,null,y.a.createElement("input",Object.assign({className:"radio ".concat(a.radio),id:r,name:n,type:"radio",value:s,onFocus:c,onChange:o,onBlur:u,ref:d,onInput:i,onKeyDown:f,required:l,checked:h},v)),!p&&y.a.createElement("label",{htmlFor:r,className:"radio__label ".concat(a.label)},m))},Dn=(a(157),function(e){var t=e.children,a=e.onClick,n=e.className,r=void 0===n?"":n,s=e.menuRef;return y.a.createElement("ul",{className:"menu ".concat(r),onClick:a,ref:s},t)}),Sn=function(e){var t=e.children,a=e.className,n=void 0===a?"":a;return y.a.createElement("li",{className:"menu__item ".concat(n)},t)},An=(a(314),function(e){var t=e.name,a=e.value,n=e.options,r=e.classes,s=e.onChange;return y.a.createElement(Dn,{className:"radio-group ".concat(r.list||"")},n.map(function(e){return y.a.createElement(Sn,{className:"radio-group__item ".concat(r.item||""),key:e.value},y.a.createElement(Nn,{name:t,id:e.value,value:e.value,isChecked:e.value===a,label:e.value===a?y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"check"}),e.name):e.name,onChange:s,classes:{radio:"radio-group__radio ".concat(r.radio||""),label:"radio-group__label ".concat(r.label||"")},"data-label":e.name}))}))});An.defaultProps={classes:{list:"",item:"",radio:"",label:""},options:[]};var xn=An,Pn=(a(315),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={selectedColor:"default"},a.handleColorChange=function(e){var t=a.props.selectColor;a.setState({selectedColor:e.target.value}),t&&t(e.target.value)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.style,a=e.isActive,n=e.classes,r=e.innerRef,s=this.state.selectedColor;return y.a.createElement("div",{ref:r,className:"color-picker ".concat(n.colorPicker||""),style:Object(U.a)({display:a?"block":"none"},t)},y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--default"},name:"color",id:"colorDefault",value:"default",onChange:this.handleColorChange,isChecked:"default"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--red"},name:"color",id:"colorRed",value:"red",onChange:this.handleColorChange,isChecked:"red"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--pink"},name:"color",id:"colorPink",value:"pink",onChange:this.handleColorChange,isChecked:"pink"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--grape"},name:"color",id:"colorGrape",value:"grape",onChange:this.handleColorChange,isChecked:"grape"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--violet"},name:"color",id:"colorViolet",value:"violet",onChange:this.handleColorChange,isChecked:"violet"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--indigo"},name:"color",id:"colorIndigo",value:"indigo",onChange:this.handleColorChange,isChecked:"indigo"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--blue"},name:"color",id:"colorBlue",value:"blue",onChange:this.handleColorChange,isChecked:"blue"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--cyan"},name:"color",id:"colorCyan",value:"cyan",onChange:this.handleColorChange,isChecked:"cyan"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--teal"},name:"color",id:"colorTeal",value:"teal",onChange:this.handleColorChange,isChecked:"teal"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--green"},name:"color",id:"colorGreen",value:"green",onChange:this.handleColorChange,isChecked:"green"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--yellow"},name:"color",id:"colorYellow",value:"yellow",onChange:this.handleColorChange,isChecked:"yellow"===s}),y.a.createElement(Nn,{classes:{radio:"color-picker__radio",label:"color-picker__swatch bg--orange"},name:"color",id:"colorOrange",value:"orange",onChange:this.handleColorChange,isChecked:"orange"===s}))}}]),t}(k.Component));Pn.defaultProps={classes:{colorPicker:""},isActive:!1,style:{},selectColor:function(){return null}};var Bn=On(Pn),Mn=(a(316),function(e){var t=e.className,a=e.color;return y.a.createElement("span",{className:"project-icon project-icon--".concat(a," ").concat(t)})});Mn.defaultProps={className:"",color:"default"};var Un=Mn,Rn=(a(317),a(318),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).getUserInitials=function(e){return e.split(" ").map(function(e){return e.charAt(0)}).join("").toUpperCase()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.imgSrc,a=e.imgProps,n=e.classes,r=e.name,s=e.variant,c=e.color,o=e.size,i=e.showOnlineStatus,l=e.isOnline;return y.a.createElement("span",{className:"avatar avatar--".concat(o," avatar--").concat(s," ").concat(i&&l?"is-online":""," ").concat(n.avatar)},null!==t?y.a.createElement("img",Object.assign({src:t,alt:r,className:"avatar__img ".concat(n.img)},a)):y.a.createElement("span",{className:"avatar__placeholder ".concat(n.placeholder),style:{backgroundColor:c}},this.getUserInitials(r)))}}]),t}(k.Component));Rn.defaultProps={imgSrc:null,classes:{avatar:"",img:"",placeholder:""},size:"md",variant:"circle",name:"Guest",showOnlineStatus:!1};var Ln="Backspace",Fn="Enter",Wn="Tab",zn="ArrowDown",Vn="ArrowUp",qn=(a(331),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={query:"",isActive:!1,selectedMember:"",selectedIndex:null,filteredList:a.props.users},a.onOutsideClick=function(e){a.props.query||""===a.state.query&&a.setState({isActive:!1})},a.matchUser=function(e,t){if(""===t)return!1;var a=e.name,n=e.email,r=e.displayName,s=new RegExp(t,"i");return s.test(a)||s.test(n)||s.test(r)},a.onFocus=function(e){a.setState({isActive:!0})},a.onReset=function(e){a.setState({query:"",isActive:!1,selectedMember:"",selectedIndex:null,filteredList:a.props.users})},a.onChange=function(e){var t=e.target.value;a.updateList(t)},a.updateList=function(e){var t=a.props.users,n=a.state.selectedMember,r=t.filter(function(t){return a.matchUser(t,e)}),s=r.findIndex(function(e){return e.userId===n}),c=-1!==s;a.setState({selectedMember:c?n:r.length>0?r[0].userId:"",selectedIndex:c?s:0,query:e,filteredList:r})},a.onKeyDown=function(e){if(e.key===Wn||e.key===zn||e.key===Vn||e.key===Fn){var t=a.state,n=t.filteredList,r=t.selectedIndex,s=t.selectedMember,c=t.query,o=n.length-1,i=r===o?0:r+1,l=0===r?o:r-1;switch(e.key){case zn:case Wn:a.setState({selectedMember:c?n[i].userId:n[0].userId,selectedIndex:c?i:0});break;case Vn:a.setState({selectedMember:c?n[l].userId:n[o].userId,selectedIndex:c?l:o});break;case Fn:if(""===s)return;a.selectMember(s,e)}e.preventDefault()}},a.selectMember=function(e,t){var n=a.props,r=n.onSelectMember,s=n.onClose;r(e,t),s&&s(t)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){"hidden"!==this.props.type&&this.inputEl.focus()}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.type,n=t.query;"hidden"===a&&n&&n!==e.query&&this.updateList(n)}},{key:"render",value:function(){var e=this,t=this.props,a=t.assignedMembers,n=t.style,r=t.classes,s=t.placeholder,c=t.type,o=t.innerRef,i=t.anchor,l=this.state.filteredList,u="hidden"===c?this.props.query:this.state.query,d="hidden"===c?this.props.isActive:this.state.isActive,p="hidden"===c?this.props.selectedMember:this.state.selectedMember,m={};if(i){var f=i.getBoundingClientRect();m.top=f.top,m.left=f.left}return y.a.createElement("div",{className:"member-search__wrapper ".concat(r.wrapper||""),ref:o,style:Object(U.a)({},m,n)},y.a.createElement(ee,{name:"query",className:"member-search ".concat(r.input||""),onChange:this.onChange,value:u,onFocus:this.onFocus,onBlur:this.onBlur,type:c,autoComplete:"off",placeholder:s,onKeyDown:this.onKeyDown,innerRef:function(t){return e.inputEl=t}}),d&&y.a.createElement("ul",{className:"member-search__list ".concat(r.list||"")},l.length>0?l.map(function(t,n){var s=t.name,c=t.photoURL,o=t.email,i=t.displayName,l=t.userId,u=a&&-1!==a.indexOf(l);return y.a.createElement("li",{className:"member-search__item ".concat(r.item||""," ").concat(p===l?"is-selected":""),onClick:function(t){return e.selectMember(l,t)},key:l,id:l},y.a.createElement(ce,{name:u?"user-minus":"user-plus"}),y.a.createElement(Rn,{classes:{avatar:"member-search__avatar--sm ".concat(r.avatar||""),placeholder:"member-search__avatar-placeholder--sm ".concat(r.avatarPlaceholder||"")},name:s,size:"sm",variant:"circle",imgSrc:c}),y.a.createElement("span",{className:"member-search__info member-search__name ".concat(r.info||"")},s),y.a.createElement("span",{className:"member-search__info member-search__display-name ".concat(r.info||"")},i),y.a.createElement("span",{className:"member-search__info member-search__email ".concat(r.info||"")},o))}):y.a.createElement("li",{className:"member-search__item ".concat(r.item||"")},y.a.createElement("span",{className:"member-search__no-match ".concat(r.noMatch||"")},"No matches found"))))}}]),t}(k.Component));qn.defaultProps={style:null,anchor:null,classes:{avatar:"",avatarPlaceholder:"",wrapper:"",input:"",list:"",item:"",info:"",noMatch:""},placeholder:"",type:"text",query:null};var Kn=On(qn),Yn=function(e){function t(){return Object(w.a)(this,t),Object(C.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.onClick,n=e.style,r=e.children,s=e.isVisible;return y.a.createElement("div",{className:"popover ".concat(t),onClick:a,style:Object(U.a)({},n,{display:s?"block":"none"})},r)}}]),t}(k.Component),Gn=(a(332),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isActive:"isActive"in a.props&&null},a.onOutsideClick=function(e){var t=a.props,n=t.onOutsideClick,r=t.onPopoverClose;n?n(e):(a.setState({isActive:!1}),r&&r(e))},a.toggleOpen=function(){a.setState(function(e){return{isActive:!e.isActive}})},a.handleClose=function(e){"isActive"in a.props||e.target.matches("input")||a.setState({isActive:!1})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.align,n=e.onWrapperClick,r=e.buttonProps,s=e.classes,c=e.anchorEl,o=e.innerRef,i="isActive"in this.props?this.props.isActive:this.state.isActive,l=null;if(c){var u=c.offsetTop,d=c.offsetLeft;l=Object(R.a)({position:"absolute",top:u},a.outer||"left",d)}return y.a.createElement("div",{className:"popover-wrapper ".concat(i?"is-active":""," ").concat(s.wrapper),ref:o,style:l,onClick:n},y.a.createElement(ae,Object.assign({type:"button",onClick:this.toggleOpen},r)),y.a.createElement(Yn,{isVisible:i,className:"align-".concat(a.inner||"left"," ").concat(s.popover),onClick:this.handleClose},t))}}]),t}(k.Component));Gn.defaultProps={classes:{wrapper:"",popover:""},buttonProps:{},align:{outer:"left",inner:"left"},anchorEl:null};var Hn=On(Gn),Jn=(a(333),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isMemberSearchActive:!1},a.toggleMemberSearch=function(){a.setState(function(e){return{isMemberSearchActive:!e.isMemberSearchActive}})},a.hideMemberSearch=function(e){a.setState({isMemberSearchActive:!1})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.members,a=e.onSelectMember,n=e.classes,r=e.memberIds,s=e.placeholder,c=e.memberSearchIsDisabled,o=e.isSelfAssignmentDisabled,i=e.align,l=e.showOnlineStatus,u=e.currentUser,d=e.activeWorkspace,p=this.state.isMemberSearchActive,m=o?this.props.users.filter(function(e){return e.userId!==u.userId}):this.props.users;return y.a.createElement("div",{className:"member-assigner ".concat(n.memberAssigner||"")},y.a.createElement("div",{className:"member-assigner__members ".concat(n.members||"")},t.map(function(e){var t=e.userId,a=e.name,r=e.photoURL,s=e.settings,c=e.status,o=c&&"online"===c.state&&s.activeWorkspace===d.workspaceId;return y.a.createElement(Rn,{classes:{avatar:"member-assigner__avatar ".concat(n.avatar||""),placeholder:"member-assigner__avatar-placeholder ".concat(n.avatarPlaceholder||"")},name:a,size:"sm",variant:"circle",imgSrc:r,key:t,showOnlineStatus:l,isOnline:o})})),!c&&y.a.createElement(Hn,{isActive:p,onOutsideClick:this.hideMemberSearch,classes:{wrapper:"member-assigner__popover-wrapper ".concat(n.popoverWrapper||""),popover:"member-assigner__popover ".concat(n.popover||"")},buttonProps:{size:"md",iconOnly:!0,className:"member-assigner__btn--toggle-member-search ".concat(n.button," ").concat(p?"is-active":""),children:y.a.createElement(ce,{name:"plus"}),onClick:this.toggleMemberSearch},align:{inner:i}},p&&y.a.createElement("div",{className:"member-assigner__search-container"},y.a.createElement("div",{className:"member-assigner__icon-wrapper"},y.a.createElement(ce,{name:"users"})),y.a.createElement(Kn,{users:m,placeholder:s,assignedMembers:r,onSelectMember:a,classes:{wrapper:"member-assigner__search-wrapper",input:"member-assigner__input",list:"member-assigner__list"}}))))}}]),t}(k.Component));Jn.defaultProps={classes:{memberAssigner:"",avatar:"",avatarPlaceholder:"",popover:"",popoverWrapper:""},placeholder:"",memberSearchIsDisabled:!1,isSelfAssignmentDisabled:!1,align:"left",showOnlineStatus:!1};var Xn=Object(z.a)(Object(_.b)(function(e,t){return{users:u.getUsersArray(e),members:u.getMembersArray(e,t.memberIds)}}),rn(function(e,t){return!!e&&!!t}))(Jn),Qn=function(e){var t=e.name,a=e.children,n=e.className;return y.a.createElement("div",{className:"project-composer__control-group ".concat(n)},y.a.createElement("h4",{className:"project-composer__subheading"},t),a)};Qn.defaultProps={className:""};var $n=Qn,Zn=(a(334),{privacy:{options:[{value:"public",label:"Public"},{value:"private",label:"Private"}]},layout:{options:[{value:"board",label:y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"trello"}),"Board")},{value:"list",label:y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"list"}),"List")}]}}),er=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",layout:"board",color:"default",privacy:"public",memberIds:[a.props.currentUser.userId],isColorPickerActive:!1},a.reset=function(){var e=a.props.currentUser.userId;a.setState({name:"",layout:"board",color:"default",privacy:"public",memberIds:[e],isColorPickerActive:!1})},a.onSubmit=function(e){e.preventDefault();var t=a.state,n=t.name,r=t.color,s=t.layout,c=t.privacy,o=t.memberIds;if(n){var i="private"===c,l=a.props,u=l.onClose,d=l.firebase,p=l.currentUser,m=l.activeWorkspace,f=p.userId,h=m.workspaceId;d.createProject({userId:f,name:n,color:r,layout:s,isPrivate:i,memberIds:o,workspaceId:h}),u(),a.reset()}},a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.setColor=function(e){a.setState({color:e})},a.toggleColorPicker=function(){a.setState(function(e){return{isColorPickerActive:!e.isColorPickerActive}})},a.hideColorPicker=function(e){var t=a.state.isColorPickerActive;!t||t&&e.target.matches(".project-composer__btn--toggle-color-picker")||a.setState({isColorPickerActive:!1})},a.handleMemberAssignment=function(e,t){var n=a.state.memberIds;a.setState(function(t){return{memberIds:n.includes(e)?t.memberIds.filter(function(t){return t!==e}):[].concat(Object(G.a)(t.memberIds),[e])}}),t.preventDefault()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=t.layout,r=t.privacy,s=t.color,c=t.memberIds,o=t.isColorPickerActive;return y.a.createElement(Tn,{onModalClose:this.props.onClose,size:"md",classes:{content:"project-composer"}},y.a.createElement("h3",{className:"project-composer__heading"},"Create new project"),y.a.createElement("form",{className:"project-composer__form",onSubmit:this.onSubmit},y.a.createElement(ee,{name:"name",id:"projectName",label:"Project Name",labelClass:"project-composer__label",value:a,onChange:this.onChange,type:"text",className:"project-composer__input--name"}),y.a.createElement("div",{className:"project-composer__settings"},y.a.createElement($n,{name:"Highlight Color",className:"project-composer__control-group--color"},y.a.createElement(ae,{onClick:this.toggleColorPicker,className:"project-composer__btn--toggle-color-picker ".concat(o?"is-active":"")},y.a.createElement(Un,{className:"project-composer__color-swatch",color:s}),y.a.createElement(ce,{name:"chevron-down"})),y.a.createElement(Bn,{onOutsideClick:this.hideColorPicker,isActive:o,selectColor:this.setColor,classes:{colorPicker:"project-composer__color-picker"}}))),y.a.createElement($n,{name:"Privacy"},Zn.privacy.options.map(function(t){return y.a.createElement(Nn,{key:t.value,onChange:e.onChange,isChecked:r===t.value,label:t.label,name:"privacy",id:t.value,value:t.value,classes:{radio:"project-composer__radio",label:"project-composer__radio-label"}})})),"public"===r&&y.a.createElement($n,{name:"Members"},y.a.createElement(Xn,{placeholder:"Add or remove member",memberIds:c,onSelectMember:this.handleMemberAssignment,isSelfAssignmentDisabled:!0})),y.a.createElement($n,{name:"Layout"},Zn.layout.options.map(function(t){return y.a.createElement(Nn,{key:t.value,onChange:e.onChange,isChecked:n===t.value,label:t.label,name:"layout",id:t.value,value:t.value,classes:{radio:"project-composer__radio",label:"project-composer__radio-label"}})})),y.a.createElement(ae,{className:"project-composer__btn--add",type:"submit",onClick:this.onSubmit,color:"primary",variant:"contained",disabled:!a},"Create Project")))}}]),t}(k.Component),tr=rn(function(e,t){return!!e&&!!t})(er),ar=a(529),nr=a(24),rr="LIST",sr="TASK",cr="FOLDER",or=(a(335),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:""},a.clear=function(){a.setState({name:""})},a.reset=function(){a.clear();var e=a.props.toggle;a.input.blur(),e()},a.onSubmit=function(e){e.preventDefault();var t=a.state.name;if(t){var n=a.props,r=n.projectId,s=n.firebase,c=n.currentUser,o=n.activeWorkspace.workspaceId,i=c.userId;s.createList({projectId:r,name:t,workspaceId:o,userId:i}),a.clear()}},a.onChange=function(e){a.setState({name:e.target.value})},a.onFocus=function(e){(0,a.props.toggle)(e),e.target.matches("button")&&a.input.focus()},a.onBlur=function(e){""===a.state.name&&(0,a.props.toggle)(e)},a.inputRef=function(e){a.input=e,(0,a.props.inputRef)(e)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state.name,t=this.props,a=t.layout,n=t.isActive;return y.a.createElement("div",{className:"list-composer".concat(n?" is-active":""," is-").concat(a,"-layout"),onFocus:this.onFocus,onBlur:this.onBlur},y.a.createElement("form",{className:"list-composer__form",onSubmit:this.onSubmit},!n&&"list"===a&&y.a.createElement(ae,{onClick:this.onFocus,color:"primary",className:"list-composer__btn--icon",iconOnly:!0},y.a.createElement(ce,{name:"plus-circle"})),y.a.createElement(ee,{innerRef:this.inputRef,onChange:this.onChange,value:e,placeholder:n?"Enter list name...":"Add a list",isRequired:!0,name:"name",className:"list-composer__input"}),n&&y.a.createElement("div",{className:"list-composer__footer"},y.a.createElement(ae,{className:"list-composer__btn list-composer__btn--add",type:"submit",onClick:this.onSubmit,color:"primary",variant:"contained",size:"sm",disabled:!e},"Add List"),"board"===a&&y.a.createElement(ae,{className:"list-composer__btn list-composer__btn--close",type:"reset",onClick:this.reset,size:"sm"},"Cancel"))))}}]),t}(k.Component)),ir=rn(function(e,t){return!!e&&!!t})(Object(_.b)(function(e){return{projectsById:m.getProjectsById(e),projectsArray:m.getProjectsArray(e)}},function(e){return{}})(or)),lr=(a(336),function(e){var t=e.className,a=e.children,n=e.isActive,r=Object($.a)(e,["className","children","isActive"]);return y.a.createElement("div",Object.assign({className:"toolbar ".concat(t," ").concat(n?"is-active":""," ")},r),a)});lr.defaultProps={className:"",isActive:!0};var ur=lr,dr=(a(337),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isActive:!1},a.toggleDropdown=function(){a.setState(function(e){return{isActive:!e.isActive}})},a.closeDropdown=function(){a.setState({isActive:!1})},a.onChange=function(e){(0,a.props.onChange)(e),a.closeDropdown()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.state.isActive,a=this.props,n=a.classes,r=a.options,s=a.name,c=a.value,o=a.align;return y.a.createElement(Hn,{isActive:t,onOutsideClick:this.closeDropdown,align:o,classes:{wrapper:"select-dropdown__wrapper ".concat(n.wrapper||""),popover:"select-dropdown ".concat(n.dropdown||"")},buttonProps:{isActive:t,onClick:this.toggleDropdown,className:"select-dropdown__btn--toggle ".concat(n.button||""),children:y.a.createElement(y.a.Fragment,null,c&&r[c].name,y.a.createElement(ce,{name:"chevron-down"}))}},y.a.createElement(Dn,{className:"select-dropdown__menu ".concat(n.menu||"")},Object.keys(r).map(function(t){var a=r[t];return y.a.createElement(Sn,{className:"select-dropdown__item ".concat(n.item||""),key:a.value},y.a.createElement(Nn,{name:s,id:a.value,value:a.value,isChecked:a.value===c,label:a.value===c?y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"check"}),a.name):a.name,onChange:e.onChange,classes:{radio:"select-dropdown__option ".concat(n.option||""),label:"select-dropdown__label ".concat(n.label||"")},"data-label":a.name}))})))}}]),t}(k.Component));dr.defaultProps={classes:{wrapper:"",dropdown:"",menu:"",item:"",option:"",label:"",button:""},options:{},value:null,align:{outer:"left",inner:"left"}};a(338);var pr=function(e){var t=e.icon,a=e.onToggle,n=e.onClose,r=e.onSave,s=e.isActive,c=e.settings,o=e.classes;return y.a.createElement(Hn,{isActive:s,onOutsideClick:n,classes:{wrapper:"settings__wrapper ".concat(o.wrapper||""),popover:"settings ".concat(o.settings||"")},align:{inner:"right"},buttonProps:{isActive:s,size:"sm",iconOnly:!0,className:"settings__btn ".concat(o.button||""),children:y.a.createElement(ce,{name:t}),onClick:a}},y.a.createElement(ae,{type:"button",className:"settings__btn--close",size:"sm",onClick:n,iconOnly:!0},y.a.createElement(ce,{name:"x"})),c.map(function(e){return y.a.createElement("div",{className:"settings__setting ".concat(o.setting||""),key:e.name},y.a.createElement("div",{className:"settings__name ".concat(o.name||"")},e.name),{radio:y.a.createElement("fieldset",{className:"settings__fieldset ".concat(o.fieldset||"")},Object.keys(e.options).map(function(t){var a=e.options[t];return y.a.createElement(Nn,{key:a.value,name:e.key,id:a.value,value:a.value,isChecked:e.value===a.value,label:a.name,onChange:e.onChange,classes:{radio:"settings__radio ".concat(o.radio||""),label:"settings__radio-label ".concat(o.radioLabel||"")}})})),select:y.a.createElement(dr,{name:e.key,onChange:e.onChange,value:e.value,options:e.options,classes:{wrapper:"settings__dropdown-wrapper ".concat(o.dropdownWrapper||""),dropdown:"settings__dropdown ".concat(o.dropdown||""),option:"settings__select-option ".concat(o.selectOption||""),label:"settings__select-label ".concat(o.selectLabel||""),menu:"settings__menu ".concat(o.menu||""),item:"settings__item ".concat(o.item||""),button:"settings__btn--dropdown ".concat(o.dropdownButton||"")}})}[e.type])}),y.a.createElement(ae,{type:"button",color:"primary",variant:"contained",className:"settings__btn--save",size:"sm",onClick:r},"Save Settings"))};pr.defaultProps={icon:"settings",classes:{name:"",wrapper:"",settings:"",setting:"",radio:"",radioLabel:"",selectOption:"",selectLabel:"",dropdown:"",dropdownWrapper:"",dropdownButton:"",button:"",menu:"",item:""},settings:{}};var mr=pr,fr=a(16),hr=function(e){return e.document.getInlinesByType("mention").map(function(e){return e.data.get("userId")}).toJS()},vr=function(e){return e.document.getInlinesByType("mention").map(function(e){return{userId:e.data.get("userId"),name:e.data.get("name"),displayName:e.data.get("displayName")}}).toJS()},br=a(40),gr=a(208),kr=a(140),yr=a.n(kr),Ir=a(60),jr=(a(440),"paragraph"),_r={inlines:{mention:{isVoid:!0}}},Er=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={value:a.props.value?fr.m.fromJSON(a.props.value):fr.m.fromJSON(Ir),isMentionsListVisible:!1,query:"",isFocused:!1,userSuggestions:a.props.mentions.users,selectedMember:"",selectedIndex:null},a.isEmpty=function(){var e=a.state.value;return yr()(Ir,e.toJSON())},a.hasChanges=function(){var e=a.state.value,t=a.props.value;return!yr()(t,e.toJSON())},a.hasMark=function(e){return a.state.value.activeMarks.some(function(t){return t.type===e})},a.hasInline=function(e){var t=a.state,n=t.value,r=t.isMentionsListVisible;return n.inlines.some(function(t){return t.type===e})||"mention"===e&&r},a.hasBlock=function(e){var t=a.state.value;if(["ordered-list","unordered-list"].includes(e)){var n=a.state.value,r=n.document,s=n.blocks;if(0===s.size)return!1;var c=r.getParent(s.first().key);return a.hasBlock("list-item")&&c&&c.type===e}return t.blocks.some(function(t){return t.type===e})},a.renderMark=function(e,t,a){var n=e.children,r=e.mark,s=e.attributes;switch(r.type){case"bold":return y.a.createElement("strong",s,n);case"code":return y.a.createElement("code",s,n);case"italic":return y.a.createElement("em",s,n);case"underlined":return y.a.createElement("u",s,n);default:return a()}},a.renderNode=function(e,t,a){var n=e.attributes,r=e.children,s=e.node,c=s.data;switch(s.type){case"paragraph":return y.a.createElement("p",n,r);case"block-quote":return y.a.createElement("blockquote",n,r);case"unordered-list":return y.a.createElement("ul",n,r);case"ordered-list":return y.a.createElement("ol",n,r);case"heading-one":return y.a.createElement("h1",n,r);case"heading-two":return y.a.createElement("h2",n,r);case"list-item":return y.a.createElement("li",n,r);case"mention":return y.a.createElement(M.a,Object.assign({className:"mention",to:c.get("href")},n),s.text);default:return a()}},a.onKeyDown=function(e,t,n){var r=t.value,s=r.document,c=a.props.isMentionsEnabled,o=a.state.isMentionsListVisible,i=r.selection.end.offset,l=r.endText.text.slice(i-1,i);if(e.ctrlKey||e.metaKey){var u;switch(e.key){case"b":u="bold";break;case"i":u="italic";break;case"u":u="underlined";break;default:return n()}t.toggleMark(u),e.preventDefault()}else if(!o||e.key!==Wn&&e.key!==zn&&e.key!==Vn&&e.key!==Fn){var d=s.getFirstText(),p=s.getNextText(d.key);switch(e.key){case Ln:if(e.preventDefault(),""!==d.text||p)t.deleteBackward(),c&&o&&"@"===l&&setTimeout(function(){a.setState({query:"",userSuggestions:a.props.mentions.users,selectedMember:"",selectedIndex:null,isMentionsListVisible:!1})},0);else if(a.hasBlock("list-item")){var m=s.getParent(r.focusBlock.key);"document"===s.getParent(m.key).object?t.moveToRangeOfNode(r.focusBlock).setBlocks(jr).moveToRangeOfNode(m).unwrapBlock(m.type).normalize(s):t.unwrapBlock(m.type)}break;case"@":a.toggleMentionsList();break;default:return n()}}else{var f=a.state,h=f.userSuggestions,v=f.selectedIndex,b=f.selectedMember,g=f.query,k=h.length-1,y=v===k?0:v+1,I=0===v?k:v-1;switch(e.key){case Wn:case zn:a.setState({selectedMember:g?h[y].userId:h[0].userId,selectedIndex:g?y:0});break;case Vn:a.setState({selectedMember:g?h[I].userId:h[k].userId,selectedIndex:g?I:k});break;case Fn:if(""===b)return n();a.insertMention(b);break;default:return n()}e.preventDefault()}},a.onChange=function(e){var t=e.value,n=a.props.mentions.users,r=a.state.selectedMember,s=a.getMention(t),c=s?n.filter(function(e){return a.matchUser(e,s)}):n,o=c.findIndex(function(e){return e.userId===r}),i=-1!==o;a.setState({value:t,query:s,userSuggestions:c,selectedMember:i?r:c.length>0?c[0].userId:"",selectedIndex:i?o:0})},a.matchUser=function(e,t){if(""===t)return!1;var a=e.name,n=e.email,r=e.displayName,s=new RegExp(t,"i");return s.test(a)||s.test(n)||s.test(r)},a.onClickMark=function(e){e.preventDefault();var t=e.target.value;a.editor.toggleMark(t),a.editor.focus()},a.onClickInline=function(e){e.preventDefault();var t=e.target.value,n=a.editor.value;if("mention"===t){var r=n.selection.start.offset,s=n.selection.end.offset,c=n.startText.text.slice(r,s);a.editor.insertText("@".concat(c)).moveToEndOfText().focus(),setTimeout(function(){a.toggleMentionsList(),a.editor.value.selection.start.offset||a.editor.normalize().moveTo(c.length+1)},0)}},a.onClickBlock=function(e){e.preventDefault();var t=e.target.value,n=Object(br.a)(Object(br.a)(a)).editor,r=n.value,s=r.document;if("unordered-list"!==t&&"ordered-list"!==t){var c=a.hasBlock(t);a.hasBlock("list-item")?n.setBlocks(c?jr:t).unwrapBlock("unordered-list").unwrapBlock("ordered-list"):n.setBlocks(c?jr:t)}else{var o=a.hasBlock("list-item"),i=r.blocks.some(function(e){return!!s.getClosest(e.key,function(e){return e.type===t})});o&&i?n.setBlocks(jr).unwrapBlock("unordered-list").unwrapBlock("ordered-list"):o?n.unwrapBlock("unordered-list"===t?"ordered-list":"unordered-list").wrapBlock(t):n.setBlocks("list-item").wrapBlock(t)}},a.getMention=function(e){if(!e.startText)return"";var t=e.selection.start.offset,a=e.startText.text.slice(0,t),n=/@(\S*)$/.exec(a);return null==n?"":n[1]},a.toggleMentionsList=function(){a.setState(function(e){return{isMentionsListVisible:!e.isMentionsListVisible}})},a.onClick=function(e,t,a){if(!t.value.selection.isBlurred)return a();t.moveToRangeOfDocument().focus()},a.onFocus=function(e){setTimeout(function(){a.setState({isFocused:!0})},0)},a.onBlur=function(e,t,n){var r=a.props,s=r.value,c=r.onBlur;if(setTimeout(function(){a.setState({isFocused:!1,isMentionsListVisible:!1})},0),void 0===s||!a.hasChanges()||!c)return n();c(a.state.value,e)},a.onUpdate=function(e){e.preventDefault();var t=a.state.value,n=a.props.onUpdate;n&&a.hasChanges()&&n(t,e),a.reset()},a.insertMention=function(e){var t=a.props.mentions.usersById[e],n=a.state.query;a.editor.deleteBackward(n.length+1);var r=a.editor.value.selection;a.editor.insertText(" ").insertInlineAtRange(r,{data:{href:"/0/".concat(t.userId,"/profile"),userId:t.userId,name:t.name,displayName:t.displayName},nodes:[{object:"text",leaves:[{text:"@".concat(t.displayName)}]}],type:"mention"}).focus(),setTimeout(function(){a.setState({query:"",userSuggestions:a.props.mentions.users,selectedMember:"",selectedIndex:null,isMentionsListVisible:!1})},0)},a.onSubmit=function(e){if(e.preventDefault(),!a.isEmpty()){var t=a.state.value;(0,a.props.onSubmit)(t,e),a.reset()}},a.reset=function(){var e=a.props.value;a.setState({value:e?fr.m.fromJSON(e):fr.m.fromJSON(Ir),isMentionsListVisible:!1,query:"",isFocused:!1})},a.ref=function(e){a.editor=e},a.onOutsideClick=function(e){var t=a.state.isFocused;a.editor&&t&&a.editor.blur()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.id,n=t.classes,r=t.placeholder,s=t.marks,c=t.inlines,o=t.blocks,i=t.isMentionsEnabled,l=t.mentions,u=t.addOns,d=t.isReadOnly,p=t.innerRef,m=this.state,f=m.value,h=m.isMentionsListVisible,v=m.query,b=m.isFocused,g=m.selectedMember;return y.a.createElement("div",{ref:p,className:"rich-text-editor__container ".concat(b?"is-focused":""," ").concat(n.container||"")},y.a.createElement(ur,{className:"rich-text-editor__toolbar ".concat(n.toolbar||""),isActive:b},s.map(function(t){return y.a.createElement(ae,{key:"".concat(a,"--").concat(t.type),size:"sm",className:"rich-text-editor__btn ".concat(n.button||""),value:t.type,onMouseDown:e.onClickMark,iconOnly:!0,isActive:e.hasMark(t.type)},y.a.createElement(ce,{name:t.icon}))}),c.map(function(t){return y.a.createElement(ae,{key:"".concat(a,"--").concat(t.type),size:"sm",className:"rich-text-editor__btn ".concat(n.button||""),value:t.type,onMouseDown:e.onClickInline,iconOnly:!0,isActive:e.hasInline(t.type)},y.a.createElement(ce,{name:t.icon}))}),o.map(function(t){return y.a.createElement(ae,{key:"".concat(a,"--").concat(t.type),size:"sm",className:"rich-text-editor__btn ".concat(n.button||""),value:t.type,onMouseDown:e.onClickBlock,iconOnly:!0,isActive:e.hasBlock(t.type)},y.a.createElement(ce,{name:t.icon}))}),u.length>0&&y.a.createElement("div",{className:"rich-text-editor__add-ons ".concat(n.addOns||"")},u.map(function(t){return y.a.createElement(ae,Object.assign({key:"".concat(a,"--").concat(t.type),type:"button",disabled:"submit"===t.type&&e.isEmpty(),onMouseDown:e[t.onClick]},t.props))}))),y.a.createElement(gr.a,{key:"editor--".concat(a),schema:_r,ref:this.ref,value:f,placeholder:r,onClick:this.onClick,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,onKeyDown:this.onKeyDown,className:"rich-text-editor ".concat(n.editor||""),renderMark:this.renderMark,renderNode:this.renderNode,readOnly:d}),i&&y.a.createElement(Kn,{key:"member-search--".concat(a),query:v,isActive:h,users:l.users,placeholder:"",assignedMembers:[],selectedMember:g,onSelectMember:this.insertMention,type:"hidden",classes:{wrapper:"rich-text-editor__mentions-wrapper",list:"rich-text-editor__mentions-list"}}))}}]),t}(k.Component);Er.defaultProps={classes:{container:"",toolbar:"",editor:"",button:"",addOns:""},placeholder:"",marks:[],blocks:[],inlines:[],isMentionsEnabled:!1,onSubmit:function(){return null},addOns:[],isReadOnly:!1};var wr=On(Er),Or=(a(441),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).updateNotes=function(e,t){var n=a.props,r=n.firebase,s=n.id,c=n.type;r.updateDoc(["".concat(c,"s"),s],{notes:e.toJSON(),mentions:hr(e)}),t.preventDefault()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.placeholder,a=e.value,n=e.classes,r=e.users,s=e.usersById,c=e.id,o=e.isReadOnly,i=e.isMentionsEnabled;return y.a.createElement(wr,{isReadOnly:o,key:"notes-editor__".concat(c),id:"notes--".concat(c),placeholder:t,value:a,onBlur:this.updateNotes,classes:{container:"notes-editor ".concat(n.editor||""),toolbar:"notes-editor__toolbar",button:"notes-editor__toolbar-btn",addOns:"notes-editor__add-ons"},isMentionsEnabled:i,mentions:{users:r,usersById:s},marks:[{type:"bold",icon:"bold"},{type:"italic",icon:"italic"},{type:"underlined",icon:"underline"}],inlines:Object(G.a)(i?[{type:"mention",icon:"at-sign"}]:[]),blocks:[{type:"unordered-list",icon:"list"}]})}}]),t}(k.Component));Or.defaultProps={classes:{editor:"",button:""},placeholder:"",isReadOnly:!1,isMentionsEnabled:!0};var Cr=K(Object(_.b)(function(e){return{users:u.getUsersArray(e),usersById:u.getUsersById(e)}},function(e){return{}})(Or)),Tr=function(e){var t=e.name,a=e.children,n=e.className,r=void 0===n?"":n;return y.a.createElement("div",{className:"project__overview-section ".concat(r)},y.a.createElement("h2",{className:"project__subheading"},t),a)},Nr=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isColorPickerActive:!1},a.handleMemberAssignment=function(e,t){var n=a.props,r=n.firebase,s=n.projectId,c=n.project,o=n.activeWorkspace.workspaceId,i=c.memberIds,l=c.name;i.includes(e)?r.removeAssignee({projectId:s,userId:e,workspaceId:o}):r.addAssignee({projectId:s,projectName:l,userId:e,workspaceId:o}),t.preventDefault()},a.toggleColorPicker=function(){a.setState(function(e){return{isColorPickerActive:!e.isColorPickerActive}})},a.setColor=function(e){var t=a.props,n=t.firebase,r=t.projectId;n.updateDoc(["projects",r],{color:e})},a.hideColorPicker=function(e){var t=a.state.isColorPickerActive;!t||t&&e.target.matches(".project__btn--toggle-color-picker")||a.setState({isColorPickerActive:!1})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.projectId,a=e.project,n=a.notes,r=a.memberIds,s=a.color,c=this.state.isColorPickerActive;return y.a.createElement("div",{className:"project__overview"},y.a.createElement(Tr,{name:"Highlight Color",className:"project__overview-section--color"},y.a.createElement(ae,{onClick:this.toggleColorPicker,className:"project__btn--toggle-color-picker ".concat(c?"is-active":"")},y.a.createElement(Un,{className:"project__color-swatch",color:s}),y.a.createElement(ce,{name:"chevron-down"})),y.a.createElement(Bn,{onOutsideClick:this.hideColorPicker,isActive:c,selectColor:this.setColor,classes:{colorPicker:"project__color-picker"}})),y.a.createElement(Tr,{name:"Members"},y.a.createElement(Xn,{placeholder:"Add or remove member",memberIds:r,onSelectMember:this.handleMemberAssignment,isSelfAssignmentDisabled:!0})),y.a.createElement(Tr,{name:"Description"},y.a.createElement(Cr,{classes:{editor:"project__notes-editor"},placeholder:"Add a description",type:"project",id:t,value:n})))}}]),t}(k.Component),Dr=rn(function(e,t){return!!e&&!!t})(Object(_.b)(function(e,t){return{project:m.getProject(e,t.projectId)}})(Nr)),Sr=(a(442),function(e){var t=e.value,a=e.id,n=e.name,r=e.isChecked,s=e.onClick,c=e.onChange,o=e.className,i=e.labelClass,l=e.label,u=Object($.a)(e,["value","id","name","isChecked","onClick","onChange","className","labelClass","label"]);return y.a.createElement("label",{htmlFor:a,onClick:s,className:"checkbox__label ".concat(r?"is-checked":""," ").concat(i)},r&&y.a.createElement(ce,{name:"check"}),y.a.createElement("input",Object.assign({type:"checkbox",id:a,value:t,name:n,checked:r,className:"checkbox ".concat(o),onChange:c},u)),l&&l)});Sr.defaultProps={className:"",labelClass:"",label:""};var Ar=Sr,xr=(a(443),[{value:"includeNotes",name:"Description"},{value:"includeSubtasks",name:"Subtasks"},{value:"includeMembers",name:"Members"}]),Pr=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:"Duplicate of ".concat(a.props.project.name),includeNotes:!0,includeSubtasks:!0,includeMembers:!0},a.reset=function(){var e=a.props.project.name;a.setState({name:"Duplicate of ".concat(e),includeNotes:!0,includeSubtasks:!0,includeMembers:!0})},a.onSubmit=function(e){e.preventDefault();var t=a.state,n=t.name,r=Object($.a)(t,["name"]);if(n){var s=a.props,c=s.onClose,o=s.firebase,i=s.currentUser,l=s.activeWorkspace,u=s.projectId,d=i.userId,p=l.workspaceId;o.cloneProject({name:n,userId:d,workspaceId:p,projectId:u},r),c(),a.reset()}},a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.toggleOption=function(e){var t=e.target.value;a.setState(function(e){return Object(R.a)({},t,!e[t])})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=(t.includeNotes,t.includeSubtasks,t.includeMembers,this.props.onClose);return y.a.createElement(Tn,{onModalClose:n,size:"md",classes:{content:"project-duplicator"}},y.a.createElement("h3",{className:"project-duplicator__heading"},"Duplicate Project"),y.a.createElement("form",{className:"project-duplicator__form",onSubmit:this.onSubmit},y.a.createElement(ee,{name:"name",id:"projectDuplicateName",label:"Project Name",labelClass:"project-duplicator__label",value:a,onChange:this.onChange,type:"text",className:"project-duplicator__input"}),y.a.createElement("fieldset",{className:"project-duplicator__options"},y.a.createElement("legend",{className:"project-duplicator__legend"},"Include:"),xr.map(function(t){return y.a.createElement(Ar,{key:t.value,id:t.value,value:t.value,name:"projectDuplicateOptions",isChecked:e.state[t.value],onChange:e.toggleOption,className:"project-duplicator__checkbox",labelClass:"project-duplicator__checkbox-label",label:t.name})})),y.a.createElement(ae,{className:"project-duplicator__btn",type:"submit",onClick:this.onSubmit,color:"primary",variant:"contained",disabled:!a},"Create Duplicate Project")))}}]),t}(k.Component),Br=Object(z.a)(Object(_.b)(function(e,t){return{project:m.getProject(e,t.projectId)}}),rn(function(e,t){return!!e&&!!t}))(Pr),Mr=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:a.props.name,prevName:a.props.name,isListComposerActive:!1,isProjectSettingsActive:!1,isMoreActionsMenuVisible:!1,isProjectDuplicatorOpen:!1},a.toggleListComposer=function(){a.setState(function(e){return{isListComposerActive:!e.isListComposerActive}})},a.setInputRef=function(e){a.listComposerInput=e},a.onNameChange=function(e){a.setState({name:e.target.value})},a.onNameBlur=function(e){var t=a.props,n=t.name,r=t.projectId,s=t.firebase,c=a.state.name;n!==c&&s.updateProjectName({projectId:r,name:c})},a.activateListComposer=function(e){a.listComposerInput.focus()},a.saveProjectSettings=function(){var e=a.props,t=e.firebase,n=e.projectId,r=e.tempSettings;t.updateDoc(["projects",n],{"settings.layout":r.layout,"settings.tasks.view":r.tasks.view,"settings.tasks.sortBy":r.tasks.sortBy}),a.closeSettingsMenu()},a.setTempProjectSettings=function(e){var t=a.props.projectId,n=a.props.setTempProjectSettings,r=e.target,s=r.name,c=r.value;n(Object(R.a)({projectId:t},s,c))},a.toggleSettingsMenu=function(e){a.setState(function(e){return{isProjectSettingsActive:!e.isProjectSettingsActive}})},a.closeSettingsMenu=function(){a.setState({isProjectSettingsActive:!1})},a.handleMemberAssignment=function(e,t){var n=a.props,r=n.firebase,s=n.projectId,c=n.name,o=n.memberIds,i=n.activeWorkspace.workspaceId;o.includes(e)?r.removeAssignee({projectId:s,userId:e,workspaceId:i}):r.addAssignee({projectId:s,projectName:c,userId:e,workspaceId:i}),t.preventDefault()},a.toggleMoreActionsMenu=function(e){a.setState(function(e){return{isMoreActionsMenuVisible:!e.isMoreActionsMenuVisible}})},a.closeMoreActionsMenu=function(e){a.setState({isMoreActionsMenuVisible:!1})},a.toggleProjectDuplicator=function(e){a.setState(function(e){return{isProjectDuplicatorOpen:!e.isProjectDuplicatorOpen}})},a.closeProjectDuplicator=function(e){a.setState({isProjectDuplicatorOpen:!1})},a.deleteProject=function(){var e=a.props,t=e.firebase,n=e.currentUser,r=e.selectProject,s=e.history,c=e.projectId,o=e.workspaceId,i=e.listIds,l=e.memberIds,u=n.userId;t.deleteProject({projectId:c,workspaceId:o,listIds:i,memberIds:l}),r(null),s.push("/0/home/".concat(u))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.projectId,n=t.color,r=t.children,s=t.memberIds,c=t.ownerId,o=t.currentUser,i=t.tempSettings,l=i.layout,u=i.tasks,d=u.view,p=u.sortBy,m=t.match.params.section,f=this.state,h=f.name,v=f.isListComposerActive,b=f.isProjectSettingsActive,g=f.isMoreActionsMenuVisible,k=f.isProjectDuplicatorOpen;return y.a.createElement("div",{className:"project project--".concat(l," project--").concat(m)},y.a.createElement("div",{className:"project__header"},y.a.createElement("div",{className:"project__header-content"},y.a.createElement("div",{className:"project__name-wrapper"},y.a.createElement(Un,{className:"project__icon",color:n}),y.a.createElement("span",{className:"project__name"},h)),y.a.createElement(ee,{className:"project__input--name",name:"projectName",type:"text",value:h,onChange:this.onNameChange,onBlur:this.onNameBlur,isRequired:!0}),y.a.createElement(Hn,{isActive:g,onOutsideClick:this.closeMoreActionsMenu,classes:{wrapper:"project__more-actions-wrapper",popover:"project__more-actions"},align:{inner:"right"},buttonProps:{size:"sm",iconOnly:!0,isActive:g,className:"project__btn--more-actions",children:y.a.createElement(ce,{name:"more-vertical"}),onClick:this.toggleMoreActionsMenu}},y.a.createElement(Dn,null,y.a.createElement(Sn,{className:"project__more-actions-item"},y.a.createElement(ae,{className:"project__more-actions-btn",onClick:this.deleteProject,disabled:c!==o.userId&&"admin"!==o.role},"Delete Project"),y.a.createElement(ae,{className:"project__more-actions-btn",onClick:this.toggleProjectDuplicator},"Duplicate Project")))),y.a.createElement("div",{className:"project__links"},y.a.createElement(ar.a,{className:"project__link",to:"/0/projects/".concat(a,"/tasks")},"Tasks"),y.a.createElement(ar.a,{className:"project__link",to:"/0/projects/".concat(a,"/overview")},"Overview")))),k&&y.a.createElement(Br,{onClose:this.closeProjectDuplicator,projectId:a}),y.a.createElement(D.a,null,y.a.createElement(S.a,{path:"/0/projects/:id/tasks",render:function(t){return y.a.createElement(y.a.Fragment,null,y.a.createElement(ur,{className:"project__toolbar"},"list"===l&&y.a.createElement(ae,{className:"project__btn project__btn--add-list",onClick:e.activateListComposer,color:"primary",variant:"contained",size:"sm"},"Add List"),y.a.createElement(Xn,{placeholder:"Add or remove member",memberIds:s,onSelectMember:e.handleMemberAssignment,classes:{memberAssigner:"project__member-assigner",avatar:"project__avatar",button:"project__btn--add-member"},isSelfAssignmentDisabled:!0,align:"right",showOnlineStatus:!0}),y.a.createElement(mr,{icon:"sliders",isActive:b,onToggle:e.toggleSettingsMenu,onClose:e.closeSettingsMenu,onSave:e.saveProjectSettings,classes:{wrapper:"project__settings-wrapper",settings:"project__settings",button:"project__settings-btn"},settings:[{name:"View",key:"view",type:"radio",options:{active:{value:"active",name:"Active Tasks"},completed:{value:"completed",name:"Completed Tasks"},all:{value:"all",name:"All Tasks"}},value:d,onChange:e.setTempProjectSettings},{name:"Sort By",key:"sortBy",type:"select",options:{none:{value:"none",name:"None"},dueDate:{value:"dueDate",name:"Due Date"}},value:p,onChange:e.setTempProjectSettings},{name:"Layout",key:"layout",type:"select",options:{board:{value:"board",name:"Board"},list:{value:"list",name:"List"}},value:l,onChange:e.setTempProjectSettings}]})),y.a.createElement(nr.c,{droppableId:a,type:rr,direction:"board"===l?"horizontal":"vertical"},function(t){return y.a.createElement("div",Object.assign({className:"project__lists",ref:t.innerRef},t.droppableProps),r,t.placeholder,y.a.createElement(ir,{inputRef:e.setInputRef,toggle:e.toggleListComposer,isActive:v,layout:l,projectId:a}))}))}}),y.a.createElement(S.a,{path:"/0/projects/:id/overview",render:function(e){var t=e.match;return y.a.createElement(Dr,{projectId:t.params.id})}})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.name!==t.prevName?{name:e.name,prevName:e.name}:null}}]),t}(k.Component),Ur=rn(function(e){return!!e})(Object(_.b)(null,function(e){return{selectProject:function(t){return e(jn(t))},setTempProjectSettings:function(t){var a=t.projectId,n=t.view,s=t.sortBy,c=t.layout;return e(r.setTempProjectSettings({projectId:a,view:n,sortBy:s,layout:c}))}}})(Mr)),Rr=function(e){return{type:"SELECT_TASK",taskId:e}},Lr=function(e){return e.selectedTask},Fr=function(e){var t=e.selectedTask,a=e.tasksById;return a&&t?a[t]:null},Wr=function(e){return e.listsById},zr=function(e,t){return e.listsById[t]},Vr=function(e,t){return t?e.listsById[t].name:""},qr=function(e){var t=e.listsById,a=e.projectsById[e.selectedProject];return a&&a.listIds?a.listIds.map(function(e){return t[e]}):[]},Kr=function(e,t){var a=e.listsById;return t?t.map(function(e){return a[e]}):[]};function Yr(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var Gr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_LISTS_BY_ID":var a=t.listsById;return Object(U.a)({},e&&e,a);case"UPDATE_LIST":var n=t.listId,r=t.listData;return Object(U.a)({},e,Object(R.a)({},n,Object(U.a)({},e[n],r)));case"ADD_LIST":var s=t.listId,c=t.listData;return Object(U.a)({},e&&e,Object(R.a)({},s,Object(U.a)({listId:s,isLoaded:!0},c)));case"REMOVE_LIST":var o=t.listId;return e[o],Object($.a)(e,[o].map(Yr));case"RESET_ACTIVE_WORKSPACE":return null;default:return e}};function Hr(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var Jr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_TASKS_BY_ID":var a=t.tasksById;return Object(U.a)({},e&&e,a);case"ADD_TASK":var n=t.taskId,r=t.taskData;return Object(U.a)({},e&&e,Object(R.a)({},n,Object(U.a)({taskId:n,isLoaded:{subtasks:!0,comments:!0}},r)));case"REMOVE_TASK":var s=t.taskId;return e[s],Object($.a)(e,[s].map(Hr));case"UPDATE_TASK":var c=t.taskId,o=t.taskData;return Object(U.a)({},e,Object(R.a)({},c,Object(U.a)({},e[c],o)));case"ADD_TAG":var i=t.taskId,l=t.tag;return Object(U.a)({},e,Object(R.a)({},i,Object(U.a)({},e[i],{tags:[].concat(Object(G.a)(e[i].tags),[l])})));case"REMOVE_TAG":var u=t.taskId,d=t.name;return u&&u in e?Object(U.a)({},e,Object(R.a)({},u,Object(U.a)({},e[u],{tags:e[u].tags.filter(function(e){return e!==d})}))):e;case"SET_TASK_LOADED_STATE":var p=t.taskId,m=t.key;return Object(U.a)({},e,Object(R.a)({},p,Object(U.a)({},e[p],{isLoaded:Object(U.a)({},e[p].isLoaded,Object(R.a)({},m,!0))})));case"RESET_ACTIVE_WORKSPACE":return null;default:return e}},Xr=function(e){return{type:"LOAD_SUBTASKS_BY_ID",subtasksById:e}},Qr=function(e){return{type:"ADD_SUBTASK",subtaskId:e.subtaskId,subtaskData:e.subtaskData}},$r=function(e){return{type:"REMOVE_SUBTASK",subtaskId:e.subtaskId,taskId:e.taskId}},Zr=function(e){return{type:"UPDATE_SUBTASK",subtaskId:e.subtaskId,subtaskData:e.subtaskData}},es=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.fs.collection("subtasks").where("taskId","==",e).onSnapshot(function(t){var r=t.docChanges(),s=n().tasksById[e];if(t.size===r.length&&r.every(function(e){return"added"===e.type})){var c={};r.length>0&&(r.forEach(function(e){var t=n().subtasksById,a=e.doc.id;if(!(t&&a in t)){var r=e.doc.data();c[a]=Object(U.a)({subtaskId:a},r)}}),a(Xr(c))),s.isLoaded.subtasks||a(rt(e,"subtasks"))}else r.forEach(function(){var t=Object(W.a)(F.a.mark(function t(r){var s,c,o,i,l,u,d;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([r.doc.id,r.doc.data(),r.type]);case 2:if(s=t.sent,c=Object(H.a)(s,3),o=c[0],i=c[1],l=c[2],u=n(),d=u.subtasksById,"added"!==l){t.next=15;break}if(!(d&&o in d)){t.next=11;break}return t.abrupt("return");case 11:a(Qr({subtaskId:o,subtaskData:i})),console.log("Subtask added: ".concat(i.name)),t.next=24;break;case 15:if("removed"!==l){t.next=22;break}if(o in d){t.next=18;break}return t.abrupt("return");case 18:a($r({subtaskId:o,taskId:e})),console.log("Subtask removed: ".concat(i.name)),t.next=24;break;case 22:a(Zr({subtaskId:o,subtaskData:i})),console.log("Subtask modified: ".concat(i.name));case 24:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())});case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},ts=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a){var n;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.fs.collection("subtasks").where("assignedTo","array-contains",e).get().then(function(e){var t={};return e.forEach(function(e){t[e.id]=Object(U.a)({subtaskId:e.id},e.data())}),t});case 3:n=t.sent,a(Xr(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},as=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.queryCollection("subtasks",["projectId","==",e]).onSnapshot(function(t){var r=t.docChanges(),s=n().projectsById[e];if(t.size===r.length&&r.every(function(e){return"added"===e.type})){var c={};r.forEach(function(e){var t=e.doc.id,a=e.doc.data();c[e.doc.id]=Object(U.a)({subtaskId:t},a)}),a(Xr(c)),s.isLoaded.subtasks||a(Re(e,"subtasks"))}else r.forEach(function(){var e=Object(W.a)(F.a.mark(function e(t){var r,s,c,o,i,l,u,d;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.doc.id,t.doc.data(),t.type]);case 2:if(r=e.sent,s=Object(H.a)(r,3),c=s[0],o=s[1],i=s[2],l=n(),u=l.subtasksById,"added"!==i){e.next=15;break}if(!(u&&c in u)){e.next=11;break}return e.abrupt("return");case 11:a(Qr({subtaskId:c,subtaskData:o})),console.log("Subtask added: ".concat(o.name)),e.next=25;break;case 15:if("removed"!==i){e.next=23;break}if(c in u){e.next=18;break}return e.abrupt("return");case 18:d=o.taskId,a($r({subtaskId:c,taskId:d})),console.log("Subtask deleted: ".concat(o.name)),e.next=25;break;case 23:a(Zr({subtaskId:c,subtaskData:o})),console.log("Subtask updated: ".concat(o.name));case 25:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())});case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},ns=function(e){return e.subtasksById},rs=function(e,t){var a=e.subtasksById;if(!t||!a)return[];var n=[],r=!0,s=!1,c=void 0;try{for(var o,i=t[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var l=a[o.value];if(!l)break;n=n.concat(l)}}catch(u){s=!0,c=u}finally{try{r||null==i.return||i.return()}finally{if(s)throw c}}return n},ss=function(e,t){return rs(e,t).filter(function(e){return!e.isCompleted})},cs=function(e,t){var a=rs(e,t);return a.includes(void 0)?[]:a.filter(function(e){return e.isCompleted})};function os(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var is=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_SUBTASKS_BY_ID":var a=t.subtasksById;return Object(U.a)({},e&&e,a);case"ADD_SUBTASK":var n=t.subtaskId,r=t.subtaskData;return Object(U.a)({},e&&e,Object(R.a)({},n,Object(U.a)({subtaskId:n,isLoaded:!0},r)));case"REMOVE_SUBTASK":var s=t.subtaskId;return e[s],Object($.a)(e,[s].map(os));case"UPDATE_SUBTASK":var c=t.subtaskId,o=t.subtaskData;return Object(U.a)({},e,Object(R.a)({},c,Object(U.a)({},e[c],o)));case"RESET_ACTIVE_WORKSPACE":return null;default:return e}},ls=(a(478),{name:"",isActive:!1}),us=function(e){function t(e){var a;return Object(w.a)(this,t),(a=Object(C.a)(this,Object(T.a)(t).call(this,e))).resetForm=function(){a.setState({name:""})},a.onSubmit=function(e){var t=a.state.name;if(("keydown"!==e.type||e.key===Fn)&&t){var n=a.props,r=n.currentUser,s=n.activeWorkspace,c=n.folderId,o=n.firebase,i=n.projectId,l=n.projectName,u=n.listId,d=n.listName,p=n.dueDate,m=r.userId,f=s.workspaceId;o.createTask({dueDate:p?new Date(p):null,name:t,userId:m,workspaceId:f,folderId:c,projectId:i,projectName:l,listId:u,listName:d,isPrivate:!i}),a.resetForm(),e.preventDefault()}},a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.onFocus=function(e){a.setState({isActive:!0})},a.onBlur=function(e){""===e.target.value&&a.setState({isActive:!1})},a.state=Object(U.a)({},ls),a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.isActive,n=this.props;n.listId,n.folderId;return y.a.createElement("div",{className:"task-composer".concat(a?" is-active":""),onFocus:this.onFocus,onBlur:this.onBlur},y.a.createElement("form",{className:"task-composer__form",onSubmit:this.onSubmit},y.a.createElement(ae,{className:"task-composer__btn--submit",type:"submit",onClick:this.onSubmit,iconOnly:!0},y.a.createElement(ce,{name:"plus-circle"})),y.a.createElement(ee,{onChange:this.onChange,value:t,placeholder:"Add a task",name:"name",className:"task-composer__input",onKeyDown:this.onSubmit,isRequired:!0})))}}]),t}(k.Component),ds=rn(function(e,t){return!!e&&!!t})(us),ps=(a(479),function(e,t){var a;return function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];a&&clearTimeout(a),a=setTimeout(function(){t.apply(void 0,r),a=null},e)}}),ms=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isFocused:!1},a.ref=function(e){a.el=e;var t=a.props.innerRef;t&&t(e)},a.onFocus=function(e){var t=a.props.onFocus;a.setState({isFocused:!0}),t(e)},a.onBlur=function(e){var t=a.props.onBlur;a.setState({isFocused:!1}),t(e)},a.autoHeightResize=function(){var e=a.props,t=e.isAutoHeightResizeEnabled,n=e.minHeight;t&&(a.el.style.height="".concat(n,"px"),a.el.style.height="".concat(a.el.scrollHeight,"px"))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.props.isAutoHeightResizeEnabled&&(this.autoHeightResize(),this.handleResize=ps(200,this.autoHeightResize),window.addEventListener("resize",this.handleResize))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.name,n=e.value,r=e.onChange,s=e.placeholder,c=e.isRequired,o=e.onKeyDown,i=(e.onFocus,e.onBlur,e.onDragStart),l=e.isReadOnly,u=e.onMouseDown,d=e.onMouseUp,p=e.onMouseMove,m=e.tabIndex,f=e.label,h=e.id,v=e.labelClass,b=(e.isAutoHeightResizeEnabled,e.innerRef,e.minHeight,Object($.a)(e,["className","name","value","onChange","placeholder","isRequired","onKeyDown","onFocus","onBlur","onDragStart","isReadOnly","onMouseDown","onMouseUp","onMouseMove","tabIndex","label","id","labelClass","isAutoHeightResizeEnabled","innerRef","minHeight"])),g=this.state.isFocused;return y.a.createElement(y.a.Fragment,null,""!==f&&y.a.createElement("label",{className:"".concat(v," ").concat(g?"is-focused":""),htmlFor:h},f),y.a.createElement("textarea",Object.assign({id:h,className:"textarea ".concat(t),name:a,value:n,onChange:r,placeholder:s,required:c,onBlur:this.onBlur,onInput:this.autoHeightResize,ref:this.ref,onFocus:this.onFocus,onKeyDown:o,onDragStart:i,readOnly:l,onMouseDown:u,onMouseUp:d,onMouseMove:p,tabIndex:m},b)))}}]),t}(k.Component);ms.defaultProps={className:"",label:"",labelClass:"",id:null,isAutoHeightResizeEnabled:!0,minHeight:0,tabIndex:0,onFocus:function(){return null},onBlur:function(){return null},onMouseDown:function(){return null},onMouseUp:function(){return null},onMouseMove:function(){return null}};a(480);var fs={name:"",isActive:!1},hs=function(e){function t(e){var a;return Object(w.a)(this,t),(a=Object(C.a)(this,Object(T.a)(t).call(this,e))).resetForm=function(){a.setState({name:""})},a.onSubmit=function(e){var t=a.state.name;if(("keydown"!==e.type||e.key===Fn)&&t){var n=a.props,r=n.firebase,s=n.projectId,c=n.projectName,o=n.listId,i=n.listName,l=n.currentUser,u=n.activeWorkspace,d=l.userId,p=u.workspaceId;r.createTask({projectId:s,listId:o,name:t,projectName:c,listName:i,userId:d,workspaceId:p}),a.resetForm(),e.preventDefault()}},a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.onFocus=function(e){a.setState({isActive:!0})},a.onReset=function(e){a.setState(Object(U.a)({},fs))},a.onBlur=function(e){""===e.target.value&&a.setState({isActive:!1})},a.state=Object(U.a)({},fs),a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.isActive,n=""===t;return y.a.createElement("div",{className:"card-composer".concat(a?" is-active":""),onFocus:this.onFocus,onBlur:this.onBlur},y.a.createElement("form",{className:"card-composer__form",onSubmit:this.onSubmit},y.a.createElement(ms,{onChange:this.onChange,value:t,placeholder:a?"Enter task name...":"Add a task",isRequired:!0,name:"name",className:"card-composer__textarea",isAutoHeightResizeEnabled:!1,onKeyDown:this.onSubmit}),a&&y.a.createElement("div",{className:"card-composer__footer"},y.a.createElement(ae,{className:"card-composer__btn",type:"submit",onClick:this.onSubmit,color:"primary",variant:"contained",size:"sm",disabled:n},"Add Task"),y.a.createElement(ae,{className:"card-composer__btn",type:"reset",onClick:this.onReset,size:"sm"},"Cancel"))))}}]),t}(k.Component),vs=rn(function(e,t){return!!e&&!!t})(hs),bs=(a(481),a(482),function(e){var t=e.name,a=e.color,n=e.size,r=e.onDelete,s=e.className,c=e.innerRef,o=e.isFocused,i=e.variant,l=e.isLinkDisabled,u=Object($.a)(e,["name","color","size","onDelete","className","innerRef","isFocused","variant","isLinkDisabled"]);return y.a.createElement("span",Object.assign({className:"tag tag--".concat(n," bg--").concat(a," ").concat("default"!==i?"tag--".concat(i):""," ").concat(o?"is-focused":""," ").concat(s),ref:c},u),l?y.a.createElement("span",{className:"tag__link"},t):y.a.createElement(M.a,{to:"/0/tasks?tag=".concat(t),className:"tag__link"},t),"md"===n&&y.a.createElement(ae,{type:"button",size:"sm",className:"tag__btn--delete",onClick:r,iconOnly:!0,"data-name":t},y.a.createElement(ce,{name:"x"})))});bs.defaultProps={className:"",onDelete:function(){return null},color:"default",size:"md",variant:"default",isFocused:!1,isLinkDisabled:!1};var gs=bs,ks=(a(483),function(e){var t=e.icon,a=e.children,n=e.className;return y.a.createElement("span",{className:"badge ".concat(n)},t&&y.a.createElement(ce,{name:t}),a)});ks.defaultProps={icon:null,className:"",children:null};var ys=ks,Is=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(e){if(!e.target.matches("button")&&!e.target.matches("a")){var t=a.props,n=t.taskId;(0,t.selectTask)(n)}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"shouldComponentUpdate",value:function(e){return-1===e.tags.indexOf(void 0)}},{key:"render",value:function(){var e=this,t=this.props,a=t.taskId,n=t.index,r=t.tags,s=t.completedSubtasks,c=t.members,o=t.task;if(!o)return null;var i=o.name,l=o.commentIds,u=o.dueDate,d=o.subtaskIds,p=o.isCompleted,m=u?la(u.toDate(),{useRelative:!0,format:{month:"short",day:"numeric"}}):null,f="Today"===m,h="Tomorrow"===m,v=u&&ia(u.toDate());return y.a.createElement(nr.b,{draggableId:a,index:n},function(t){return y.a.createElement("div",Object.assign({className:"card",onClick:e.onClick},t.draggableProps,t.dragHandleProps,{ref:t.innerRef,style:Object(U.a)({},t.draggableProps.style,{backgroundColor:"#fff"})}),y.a.createElement("div",{className:"card__header",ref:function(t){return e.headerEl=t}},y.a.createElement("div",{className:"card__tags"},r.map(function(e){return y.a.createElement(gs,{key:e.name,size:"sm",color:e.color,variant:"pill",className:"card__tag"})})),y.a.createElement("h3",{className:"card__title"},i)),y.a.createElement("div",{className:"card__body"},p&&y.a.createElement(ys,{className:"card__detail card__completed-status"},y.a.createElement("span",{className:"card__completed-status-icon"},y.a.createElement(ce,{name:"check"}))),u&&y.a.createElement(ys,{icon:"calendar",className:"card__detail card__due-date ".concat(f?"is-due-today":h?"is-due-tmrw":v?"is-past-due":"","\n                  ")},m),d&&d.length>0&&y.a.createElement(ys,{className:"card__detail",icon:"check-circle"},s.length,"/",d.length),l&&l.length>0&&y.a.createElement(ys,{className:"card__detail",icon:"message-circle"},l.length)),y.a.createElement("div",{className:"card__footer"},c&&c.length>0&&y.a.createElement("div",{className:"card__members-wrapper"},y.a.createElement("div",{className:"card__members"},c.map(function(e){var t=e.name,a=e.photoURL,n=e.userId;return y.a.createElement(Rn,{classes:{avatar:"card__avatar",placeholder:"card__avatar-placeholder"},name:t,size:"sm",variant:"circle",imgSrc:a,key:n})})))))})}}]),t}(k.Component),js=Object(_.b)(function(e,t){return{tags:i.getTaskTags(e,t.taskId),completedSubtasks:i.getCompletedSubtasks(e,t.taskId),members:i.getAssignees(e,t.taskId),task:i.getTask(e,t.taskId)}},function(e){return{selectTask:function(t){return e(Rr(t))}}})(Is),_s=(a(484),function(e){var t=e.projectId,a=e.size,n=e.variant,r=e.name,s=e.color,c=e.classes;return y.a.createElement(M.a,{to:"/0/projects/".concat(t,"/tasks"),className:"project-badge project-badge--".concat(a," ").concat("contained"===n?"project-badge--contained project-badge--".concat(s):""," ").concat(c.badge||"")},"icon"===n&&y.a.createElement(Un,{color:s,className:"project-badge__icon ".concat(c.icon||"")}),y.a.createElement("span",{className:"project-badge__name"},r))});_s.defaultProps={classes:{badge:"",icon:""},variant:"icon",size:"md"};var Es=Object(_.b)(function(e,t){return{color:m.getProjectColor(e,t.projectId),name:m.getProjectName(e,t.projectId)}})(_s),ws=(a(485),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isFocused:!1,name:a.props.task?a.props.task.name:"",prevName:a.props.task?a.props.task.name:"",pointX:null,pointY:null},a.onFocus=function(){a.setState({isFocused:!0})},a.onChange=function(e){a.setState({name:e.target.value})},a.onBlur=function(){var e=a.props,t=e.firebase,n=e.taskId,r=e.task.name,s=a.state.name;r!==s&&t.updateDoc(["tasks",n],{name:s}),a.setState({isFocused:!1})},a.deleteTask=function(e){if(""===e.target.value&&e.key===Ln){var t=a.props,n=t.taskId,r=t.task;(0,t.deleteTask)({taskId:n,listId:r.listId})}},a.toggleCompleted=function(){var e=a.props,t=e.taskId,n=e.task,r=e.firebase,s=n.isCompleted;r.updateDoc(["tasks",t],{isCompleted:!s,completedAt:s?null:r.getTimestamp()})},a.handleTaskClick=function(e){if(!(e.target.matches("button")||e.target.matches("a")||e.target.matches("label")||e.target.matches('input[type="checkbox"]'))){var t=a.props,n=t.taskId;(0,t.selectTask)(n)}},a.onKeyDown=function(e){var t=a.props,n=t.provided,r=t.taskId,s=t.selectTask;n&&n.dragHandleProps&&n.dragHandleProps.onKeyDown(e),e.key===Fn&&s(r)},a.onMouseDown=function(e){var t=a.props.provided;t&&t.dragHandleProps&&t.dragHandleProps.onMouseDown(e),e.target.matches("input")||e.target.matches("label")||a.setState({pointX:e.pageX,pointY:e.pageY})},a.onMouseUp=function(e){var t=a.state,n=t.pointX,r=t.pointY;t.isFocused||(e.pageX===n&&e.pageY===r&&window.innerWidth>=768&&a.textarea.focus(),a.setState({pointX:null,pointY:null}))},a.setTextareaRef=function(e){a.textarea=e},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.taskId,a=e.tags,n=e.innerRef,r=e.provided,s=e.selectedProjectId,c=e.members,o=e.className,i=e.task;if(!i)return null;var l=i.isCompleted,u=i.dueDate,d=i.projectId,p=this.state,m=p.isFocused,f=p.name,h=r?r.draggableProps:{},v=r?r.dragHandleProps:{},b=u?la(u.toDate(),{useRelative:!0,format:{month:"short",day:"numeric"}}):null,g="Today"===b,k="Tomorrow"===b,I=u&&ia(u.toDate());return y.a.createElement("li",Object.assign({className:"task ".concat(o||""," ").concat(m?"is-focused":""),onClick:this.handleTaskClick,tabIndex:0,ref:n},h,v,{onKeyDown:this.onKeyDown,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp}),y.a.createElement(Ar,{id:"cb-".concat(t),value:t,name:t,isChecked:l,onChange:this.toggleCompleted,className:"task__checkbox",labelClass:"task__checkbox-label"}),y.a.createElement("div",{className:"task__wrapper"},y.a.createElement("div",{className:"task__badges task__badges--top"},y.a.createElement("div",{className:"task__tags"},a.map(function(e){return y.a.createElement(gs,{name:e.name,key:e.name,size:"sm",color:e.color,className:"task__tag"})})),u&&y.a.createElement(ys,{className:"task__detail task__due-date ".concat(g?"is-due-today":k?"is-due-tmrw":I?"is-past-due":"","\n                  ")},b),c&&c.length>0&&y.a.createElement("div",{className:"task__detail task__members-wrapper"},y.a.createElement("div",{className:"task__members"},c.map(function(e){var t=e.name,a=e.photoURL,n=e.userId;return y.a.createElement(Rn,{classes:{avatar:"task__avatar",placeholder:"task__avatar-placeholder"},name:t,size:"sm",variant:"circle",imgSrc:a,key:n})})))),y.a.createElement(ms,{innerRef:this.setTextareaRef,value:f,onFocus:this.onFocus,onChange:this.onChange,onBlur:this.onBlur,name:t,className:"task__textarea",onKeyDown:this.deleteTask,minHeight:14}),y.a.createElement("div",{className:"task__badges task__badges--btm"},!s&&d&&y.a.createElement(Es,{projectId:d,size:"sm"}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.task&&e.task.name!==t.prevName?{name:e.task.name,prevName:e.task.name}:null}}]),t}(k.Component));ws.defaultProps={className:""};var Os=K(Object(_.b)(function(e,t){return{tags:i.getTaskTags(e,t.taskId),selectedProjectId:_n(e),members:i.getAssignees(e,t.taskId),task:i.getTask(e,t.taskId)}},function(e){return{selectTask:function(t){return e(Rr(t))},deleteTask:function(t){var a=t.taskId,n=t.listId;return e(s.deleteTask({taskId:a,listId:n}))}}})(ws)),Cs=function(e){var t=e.taskId,a=e.index,n=e.isDragDisabled,r=e.tasksById;return t in r?y.a.createElement(nr.b,{draggableId:t,index:a,isDragDisabled:n},function(e,a){return y.a.createElement(Os,{taskId:t,innerRef:e.innerRef,provided:e})}):null};Cs.defaultProps={isDragDisabled:!1};var Ts=Object(_.b)(function(e){return{tasksById:i.getTasksById(e)}})(Cs),Ns=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).scrollToBottom=function(){a.listEnd&&a.listEnd.scrollIntoView({behavior:"smooth"})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.taskIds.length>e.taskIds.length&&this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=this.props,a=t.listId,n=t.projectId,r=t.dueDate,s=t.taskIds,c=t.folderId,o=t.layout,i=t.dropType,l=t.isDragDisabled,u="board"===o,d=s.map(function(e,t){return u?y.a.createElement(js,{key:e,index:t,taskId:e}):y.a.createElement(Ts,{key:e,isDragDisabled:l,index:t,taskId:e})});return y.a.createElement(nr.c,{droppableId:a||c||n||"".concat(r),type:i},function(t,a){return u?y.a.createElement("div",Object.assign({className:"list__cards",ref:t.innerRef,style:{minHeight:a.isDraggingOver?80:16}},t.droppableProps),d,t.placeholder,y.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(t){return e.listEnd=t}})):y.a.createElement("ul",Object.assign({className:"list__tasks",ref:t.innerRef,style:{minHeight:a.isDraggingOver?60:4}},t.droppableProps),d,t.placeholder)})}}]),t}(k.Component);Ns.defaultProps={dropType:sr,isDragDisabled:!1};a(486);var Ds=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:a.props.list?a.props.list.name:"",prevName:a.props.list?a.props.list.name:"",isMoreActionsMenuVisible:!1,isFocused:!1,pointX:null,pointY:null},a.setInputRef=function(e){a.input=e},a.handleListDelete=function(e){e.preventDefault();var t=a.props,n=t.listId,r=t.projectId;(0,t.deleteList)({listId:n,projectId:r})},a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.onBlur=function(e){var t=a.props,n=t.list,r=t.listId,s=t.firebase,c=n.name,o=a.state.name;o!==c&&s.updateListName({listId:r,name:o}),a.setState({isFocused:!1})},a.onFocus=function(){a.setState({isFocused:!0})},a.toggleMoreActionsMenu=function(e){a.setState(function(e){return{isMoreActionsMenuVisible:!e.isMoreActionsMenuVisible}})},a.closeMoreActionsMenu=function(e){a.setState({isMoreActionsMenuVisible:!1})},a.applySortRule=function(e){var t=a.props,n=t.sortBy,r=t.tasksById;switch(n){case"dueDate":return Object(G.a)(e).sort(function(e,t){var a=r[e],n=r[t],s=a&&a.dueDate?a.dueDate.toMillis():null,c=n&&n.dueDate?n.dueDate.toMillis():null;return!s&&c?1:s&&!c?-1:s||c?s-c:0});default:return e}},a.onMouseDown=function(e){e.target.matches("input")||e.target.matches("label")||a.setState({pointX:e.pageX,pointY:e.pageY})},a.onMouseUp=function(e){var t=a.state,n=t.pointX,r=t.pointY;t.isFocused||(e.pageX===n&&e.pageY===r&&a.input.focus(),a.setState({pointX:null,pointY:null}))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.taskIdsByViewFilter,n=t.listId,r=t.index,s=t.isRestricted,c=t.projectId,o=t.projectName,i=t.layout,l=t.viewFilter,u=t.list;if(!u)return null;var d=u.name,p="board"===i,m=this.state,f=m.name,h=m.isMoreActionsMenuVisible,v=m.isFocused,b=this.applySortRule(a[l]);return y.a.createElement(nr.b,{draggableId:n,index:r},function(t){return y.a.createElement(y.a.Fragment,null,y.a.createElement("section",Object.assign({className:"list is-".concat(i,"-layout ").concat(v?"is-focused":""),ref:t.innerRef},t.draggableProps,t.dragHandleProps),y.a.createElement("header",{className:"list__header"},y.a.createElement("div",{className:"list__input-wrapper",onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp},y.a.createElement(ee,{className:"list__input--title",name:"name",type:"text",value:f,onChange:e.onChange,required:!s,isReadOnly:s,onBlur:e.onBlur,onFocus:e.onFocus,innerRef:e.setInputRef})),y.a.createElement(Hn,{isActive:h,onOutsideClick:e.closeMoreActionsMenu,classes:{wrapper:"list__popover-wrapper",popover:"list__popover"},align:{inner:"right"},buttonProps:{size:"md",iconOnly:!0,isActive:h,className:"list__btn--more-actions",children:y.a.createElement(ce,{name:"more-vertical"}),onClick:e.toggleMoreActionsMenu}},y.a.createElement(Dn,null,y.a.createElement(Sn,{className:"list__more-actions-item"},!s&&y.a.createElement(ae,{className:"list__btn",onClick:e.handleListDelete},"Delete"))))),y.a.createElement("div",{className:"list__content"},y.a.createElement(Ns,{taskIds:b,listId:n,layout:i})),t.placeholder,Object(k.createElement)(p?vs:ds,{listId:n,listName:d,projectId:c,projectName:o},null)),t.placeholder)})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.list.name!==t.prevName?{name:e.list.name,prevName:e.list.name}:null}}]),t}(k.Component);Ds.defaultProps={isRestricted:!1};var Ss=rn(function(e){return!!e})(Object(_.b)(function(e,t){return{taskIdsByViewFilter:i.getTaskIdsByViewFilter(e,{listId:t.listId}),tasksById:i.getTasksById(e),list:f.getList(e,t.listId)}},function(e){return{deleteList:function(t){var a=t.listId,r=t.projectId;return e(n.deleteList({listId:a,projectId:r}))}}})(Ds)),As=function(e){var t=e.className,a=e.size,n=e.children;return y.a.createElement("div",{className:"task-editor__section".concat("sm"===a?"--sm":""," ").concat(t?"task-editor__section--".concat(t):"")},n)};As.defaultProps={className:"",size:"default"};var xs=As,Ps=function(e){var t=e.onMenuClick;return y.a.createElement(Hn,{classes:{wrapper:"task-editor__popover-wrapper",popover:"task-editor__popover"},align:{outer:"right",inner:"right"},buttonProps:{size:"md",iconOnly:!0,className:"task-editor__toolbar-btn",children:y.a.createElement(ce,{name:"more-horizontal"})}},y.a.createElement(Dn,{onClick:t},y.a.createElement(Sn,null,y.a.createElement("a",{href:"","data-action":"delete"},"Delete task"))))},Bs=(a(487),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:a.props.name,isFocused:!1,pointX:null,pointY:null,isDragging:!1},a.onChange=function(e){a.setState({name:e.target.value})},a.onFocus=function(){a.setState({isFocused:!0})},a.onBlur=function(){var e=a.props,t=e.name,n=e.firebase,r=e.subtaskId,s=a.state.name;t!==s&&n.updateDoc(["subtasks",r],{name:s}),a.setState({isFocused:!1})},a.deleteSubtask=function(e){if(""===e.target.value&&e.key===Ln){var t=a.props,n=t.subtaskId,r=t.taskId;t.firebase.deleteSubtask({subtaskId:n,taskId:r})}},a.toggleCompleted=Object(W.a)(F.a.mark(function e(){var t,n,r,s;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props,n=t.subtaskId,r=t.isCompleted,s=t.firebase,e.next=3,s.updateSubtask(n,{isCompleted:!r,completedAt:r?null:s.getTimestamp()});case 3:case"end":return e.stop()}},e)})),a.setTextareaRef=function(e){a.textarea=e},a.onMouseDown=function(e){e.target.matches("input")||e.target.matches("label")||a.setState({pointX:e.pageX,pointY:e.pageY})},a.onMouseUp=function(e){var t=a.state,n=t.pointX,r=t.pointY;t.isFocused||(e.pageX===n&&e.pageY===r&&a.textarea.focus(),a.setState({pointX:null,pointY:null}))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.portal=document.createElement("div"),document.body.appendChild(this.portal)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.portal)}},{key:"render",value:function(){var e=this,t=this.props,a=t.subtaskId,n=t.index,r=t.isCompleted,s=t.usePortal,c=this.state,o=c.name,i=c.isFocused;return y.a.createElement(nr.b,{draggableId:a,index:n},function(t,n){var c=y.a.createElement("li",Object.assign({onMouseUp:e.onMouseUp,className:"subtask ".concat(n.isDragging?"is-dragging":""," ").concat(i?"is-focused":""),ref:t.innerRef},t.draggableProps,t.dragHandleProps,{onMouseDown:function(a){e.onMouseDown(a),t.dragHandleProps.onMouseDown(a)}}),y.a.createElement(Ar,{id:"cb-".concat(a),value:a,name:a,isChecked:r,onChange:e.toggleCompleted,className:"subtask__checkbox",labelClass:"subtask__checkbox-label"}),y.a.createElement(ms,{innerRef:e.setTextareaRef,value:o,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,name:a,className:"subtask__textarea",onKeyDown:e.deleteSubtask}));return s&&n.isDragging?j.a.createPortal(c,e.portal):c})}}]),t}(k.Component));Bs.defaultProps={usePortal:!1};var Ms=K(Bs),Us=(a(488),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isLoading:!a.props.isLoaded},a.moveSubtask=function(e){var t=e.destination,n=e.draggableId,r=e.source;if(t&&t.index!==r.index){var s=a.props,c=s.firebase,o=s.subtaskIds,i=Object(G.a)(o);i.splice(r.index,1),i.splice(t.index,0,n),c.updateTask(r.droppableId,{subtaskIds:i})}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(F.a.mark(function e(){var t,a,n;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.syncTaskSubtasks,n=t.taskId,t.selectedProjectId){e.next=6;break}return e.next=4,a(n);case 4:this.unsubscribe=e.sent,this.setState({isLoading:!1});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"render",value:function(){var e=this.props,t=e.taskId,a=e.subtasks,n=e.usePortal,r=this.state.isLoading;return y.a.createElement(nr.a,{onDragEnd:this.moveSubtask},y.a.createElement(nr.c,{droppableId:t,type:"SUBTASK"},function(e){return y.a.createElement("ul",Object.assign({className:"subtasks",ref:e.innerRef},e.droppableProps),!r&&a.map(function(e,a){return y.a.createElement(Ms,{subtaskId:e.subtaskId,taskId:t,index:a,name:e.name,isCompleted:e.isCompleted,key:e.subtaskId,usePortal:n})}),e.placeholder)}))}}]),t}(k.Component));Us.defaultProps={usePortal:!1};var Rs=K(Object(_.b)(function(e,t){return{subtasks:v.getSubtasksArray(e,t.subtaskIds),subtasksById:v.getSubtasksById(e),selectedProjectId:_n(e),isLoaded:i.getTaskLoadedState(e,t.taskId).subtasks}},function(e){return{syncTaskSubtasks:function(t){return e(h.syncTaskSubtasks(t))}}})(Us)),Ls=(a(489),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",isFocused:!1},a.resetForm=function(){a.setState({name:""})},a.onChange=function(e){a.setState({name:e.target.value})},a.onFocus=function(e){a.setState({isFocused:!0})},a.onBlur=function(e){""===e.target.value&&a.setState({isFocused:!1})},a.addSubtask=function(e){var t=a.state.name;if(("keydown"!==e.type||e.key===Fn)&&t){var n=a.props,r=n.currentUser,s=n.firebase,c=n.taskId,o=n.projectId,i=n.activeWorkspace.workspaceId,l=r.userId;s.createSubtask({userId:l,name:t,taskId:c,projectId:o,workspaceId:i}),a.resetForm(),e.preventDefault()}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.isFocused,n=this.props.classes;return y.a.createElement("div",{className:"subtask-composer ".concat(a?"is-active":""," ").concat(n.composer||"")},y.a.createElement("div",{className:"subtask-composer__icon-wrapper ".concat(n.iconWrapper||"")},y.a.createElement(ce,{name:"plus-circle",className:"subtask-composer__icon ".concat(n.icon||"")})),y.a.createElement("form",{name:"newSubtaskForm",className:"subtask-composer__form ".concat(n.form||""," ").concat(a?"is-focused":"")},y.a.createElement(ms,{className:"subtask-composer__textarea ".concat(n.textarea||""),name:"subtask",value:t,onChange:this.onChange,placeholder:"Add a subtask",onFocus:this.onFocus,onKeyDown:this.addSubtask,onBlur:this.onBlur}),a&&y.a.createElement(ae,{type:"submit",color:"primary",size:"small",variant:"contained",disabled:""===t,onClick:this.addSubtask,className:"subtask-composer__btn--add ".concat(n.button||"")},"Add subtask")))}}]),t}(k.Component));Ls.defaultProps={classes:{composer:"",icon:"",iconWrapper:"",form:"",textarea:"",button:""}};var Fs=rn(function(e,t){return!!e&&!!t})(Ls),Ws=(a(490),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={value:"",isActive:!1,isColorPickerActive:!1,selectedTag:"",currentTag:null,focusedTag:"",selectedIndex:null,hasExactMatch:null,filteredList:[]},a.onFocus=function(){a.setState({isActive:!0})},a.onBlur=function(){a.setState({selectedTag:"",selectedIndex:null})},a.reset=function(){a.setState({value:"",isColorPickerActive:!1,selectedTag:"",selectedIndex:null,hasExactMatch:null,focusedTag:"",currentTag:null,filteredList:[]})},a.matchTag=function(e,t){var a=e.name;return new RegExp(t,"i").test(a)},a.onChange=function(e){var t=a.props.tagSuggestions,n=a.state.selectedTag,r=e.target.value,s=t.filter(function(e){return a.matchTag(e,r)}),c=-1!==s.findIndex(function(e){return e.name===r}),o=s.indexOf(n),i=-1!==o;a.setState({selectedTag:i?n:s.length>0?s[0].name:"",selectedIndex:i?o:0,value:r,filteredList:c?s:[].concat(Object(G.a)(s),[{name:r,color:"default"}]),hasExactMatch:c})},a.onKeyDown=function(e){if(e.key===Wn||e.key===zn||e.key===Vn||e.key===Fn||e.key===Ln){var t=a.state,n=t.filteredList,r=t.selectedIndex,s=t.selectedTag,c=t.value,o=t.focusedTag,i=a.props.assignedTags,l=r===n.length-1||null===r?0:r+1,u=0===r?n.length-1:r-1;switch(e.key){case zn:case Wn:a.setState({selectedTag:n[l].name,selectedIndex:l});break;case Vn:a.setState({selectedTag:n[u].name,selectedIndex:u});break;case Fn:if(""===s&&""===c)return;a.reset(),a.addTag(""===s?c:s);break;case Ln:if(""!==c)return;""===o?a.setState({focusedTag:i[i.length-1].name}):a.removeTag(o)}e.preventDefault()}},a.onOutsideClick=function(e){e.target.matches(".tags-input__item")||a.setState({isActive:!1})},a.toggleColorPicker=function(){a.setState(function(e){return{isColorPickerActive:!e.isColorPickerActive}})},a.hideColorPicker=function(){a.state.isColorPickerActive&&a.toggleColorPicker()},a.addTag=function(e){var t=a.props,n=t.firebase,r=t.currentUser,s=t.projectTags,c=t.taskId,o=t.projectId,i=r.userId,l=r.tags,u=s&&e in s,d=l&&e in l,p=u?s[e]:null,m=d?l[e]:null,f=u?Object(U.a)({},p):d?Object(U.a)({},m):{name:e};n.addTag(Object(U.a)({userId:i,taskId:c,projectId:o},f)).then(function(){d||u||(a.setState({currentTag:e}),a.toggleColorPicker())})},a.setTagColor=function(e){var t=a.props,n=t.currentUser,r=t.projectId,s=t.firebase,c=n.userId,o=a.state.currentTag;s.setTagColor({userId:c,projectId:r,tag:o,color:e})},a.removeTag=function(e){var t=a.props,n=t.taskId,r=t.currentUser,s=t.projectId;(0,t.removeTaskTag)({taskId:n,name:e,userId:r.userId,projectId:s}),a.setState({isColorPickerActive:!1,focusedTag:"",currentTag:null})},a.setCurrentTagRef=function(e){a.currentTag=e},a.onClickSuggestion=function(e){if(e.target.matches(".tags-input__item")){var t=e.target.dataset.tag;a.reset(),a.addTag(t)}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"shouldComponentUpdate",value:function(e){return-1===e.assignedTags.indexOf(void 0)}},{key:"render",value:function(){var e=this,t=this.props,a=t.assignedTags,n=t.innerRef,r=this.state,s=r.value,c=r.isActive,o=r.isColorPickerActive,i=r.filteredList,l=r.selectedTag,u=r.currentTag,d=r.hasExactMatch,p=r.focusedTag,m=a&&a.length>0,f={};if(this.currentTag){var h=this.currentTag,v=h.offsetLeft,b=h.offsetWidth,g=h.offsetTop,k=h.offsetHeight;f.left=v+b/2-74,f.top=g+k+9}return y.a.createElement("div",{className:"tags__container ".concat(c?"is-active":""," ").concat(m?"":"no-tags"),ref:n},a.map(function(t){return y.a.createElement(gs,{key:t.name,color:t.color,size:"md",name:t.name,onDelete:function(){return e.removeTag(t.name)},isFocused:p===t.name,innerRef:u===t.name?e.setCurrentTagRef:null,isLinkDisabled:!0})}),y.a.createElement("div",{className:"tags-input__wrapper"},y.a.createElement(ee,{className:"tags-input",onChange:this.onChange,onBlur:this.onBlur,value:s,onFocus:this.onFocus,type:"text",autoComplete:"off",onKeyDown:this.onKeyDown}),c&&y.a.createElement("ul",{className:"tags-input__list"},i.map(function(t,a){return y.a.createElement("li",{key:t.name,"data-tag":t.name,onClick:e.onClickSuggestion,tabIndex:0,className:"tags-input__item ".concat(l===t.name?"is-selected":""," ").concat(d||a!==i.length-1?"":"tags-input__item--new")},d||a!==i.length-1?y.a.createElement(gs,{name:t.name,color:t.color,size:"sm"}):y.a.createElement(y.a.Fragment,null,y.a.createElement("span",{className:"tags-input__item--heading"},"New Tag"),y.a.createElement("span",{className:"tags-input__item--name"},t.name)))}))),c&&y.a.createElement(Bn,{isActive:o,selectColor:this.setTagColor,style:f,onOutsideClick:this.hideColorPicker}))}}]),t}(k.Component)),zs=Object(z.a)(rn(function(e){return!!e}),Object(_.b)(function(e,t){return{projectTags:m.getProjectTags(e,t.projectId)}},function(e){return{removeTaskTag:function(t){var a=t.taskId,n=t.name,r=t.userId,c=t.projectId;return e(s.removeTaskTag({taskId:a,name:n,userId:r,projectId:c}))}}}),On)(Ws),Vs=(a(491),a(492),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isMonthsDropdownActive:!1,isYearsDropdownActive:!1},a.goToNextMonth=function(){var e=a.props,t=e.month,n=e.year;(0,e.onMonthClick)($t(t,n))},a.goToPrevMonth=function(){var e=a.props,t=e.month,n=e.year;(0,e.onMonthClick)(Qt(t,n))},a.toggleMonthsDropdown=function(){a.setState(function(e){return{isMonthsDropdownActive:!e.isMonthsDropdownActive}})},a.toggleYearsDropdown=function(){a.setState(function(e){return{isYearsDropdownActive:!e.isYearsDropdownActive}})},a.closeYearsDropdown=function(){a.setState({isYearsDropdownActive:!1})},a.closeMonthsDropdown=function(){a.setState({isMonthsDropdownActive:!1})},a.selectMonth=function(e){var t=+e.target.value,n=a.props;(0,n.onMonthClick)({month:t,year:n.year}),a.toggleMonthsDropdown()},a.selectYear=function(e){var t=+e.target.value;(0,a.props.onYearClick)(t),a.toggleYearsDropdown()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.month,n=t.year,r=t.selectedDate,s=t.today,c=t.onDayClick,o=t.classes,i=this.state,l=i.isMonthsDropdownActive,u=i.isYearsDropdownActive,d=Zt(a,n),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).getFullYear();return Object(G.a)(new Array(e)).map(function(e,a){return t+a})}(4);return y.a.createElement("div",{className:"calendar ".concat(o.calendar)},y.a.createElement("div",{className:"calendar__year"},y.a.createElement(Hn,{isActive:u,onOutsideClick:this.closeYearsDropdown,classes:{wrapper:"calendar__years-dropdown-wrapper",popover:"calendar__years-dropdown"},buttonProps:{className:"calendar__btn--years-dropdown ".concat(u?"is-active":""),children:y.a.createElement(y.a.Fragment,null,n,y.a.createElement(ce,{name:"chevron-down"})),onClick:this.toggleYearsDropdown}},y.a.createElement("ul",{className:"calendar__years-list"},p.map(function(t){return y.a.createElement("li",{className:"calendar__years-item",key:t},y.a.createElement(Nn,{name:"year",id:t,value:t,isChecked:t===n,label:t===n?y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"check"}),t):t,onChange:e.selectYear,classes:{radio:"calendar__radio",label:"calendar__radio-label"}}))})))),y.a.createElement("div",{className:"calendar__month"},y.a.createElement(Hn,{isActive:l,onOutsideClick:this.closeMonthsDropdown,classes:{wrapper:"calendar__months-dropdown-wrapper",popover:"calendar__months-dropdown"},buttonProps:{className:"calendar__btn--months-dropdown ".concat(l?"is-active":""),children:y.a.createElement(y.a.Fragment,null,Ht[a].long,y.a.createElement(ce,{name:"chevron-down"})),onClick:this.toggleMonthsDropdown}},y.a.createElement("ul",{className:"calendar__months-list"},Ht.map(function(t,n){return y.a.createElement("li",{className:"calendar__months-item",key:t.long},y.a.createElement(Nn,{name:"month",id:t.long,value:n,isChecked:n===a,label:n===a?y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"check"}),t.long):t.long,onChange:e.selectMonth,classes:{radio:"calendar__radio",label:"calendar__radio-label"}}))}))),y.a.createElement("div",{className:"calendar__month--prev-next"},y.a.createElement(ae,{type:"button",className:"calendar__btn--month calendar__btn--prev-month",size:"sm",iconOnly:!0,onClick:this.goToPrevMonth},y.a.createElement(ce,{name:"chevron-left"})),y.a.createElement(ae,{type:"button",className:"calendar__btn--month calendar__btn--next-month",size:"sm",iconOnly:!0,onClick:this.goToNextMonth},y.a.createElement(ce,{name:"chevron-right"})))),y.a.createElement("div",{className:"calendar__week-days"},Jt.map(function(e){return y.a.createElement("div",{key:e.long,className:"calendar__week-day ".concat(o.weekDay)},e.narrow)})),y.a.createElement("div",{className:"calendar__days"},d.map(function(e){var t=e.day===s.day&&e.month===s.month&&e.year===s.year,n=r&&e.day===r.day&&e.month===r.month&&e.year===r.year;return y.a.createElement("div",{key:"".concat(e.month,"--").concat(e.day),className:"calendar__day ".concat(e.month!==a?"calendar__day--prev-next":""," ").concat(t?"is-today":""," ").concat(n?"is-selected":""," ").concat(o.day)},y.a.createElement(ae,{type:"button",className:"calendar__btn--day",size:"sm",onClick:function(){return c(e)}},e.day))})))}}]),t}(k.Component)),qs=(a(493),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={today:{day:(new Date).getDate(),month:(new Date).getMonth(),year:(new Date).getFullYear()},selectedDate:a.props.selectedDate,currentMonth:a.props.currentMonth,currentYear:a.props.currentYear,dateString:sa(a.props.selectedDate)||""},a.resetCalendar=function(){a.setState({currentMonth:a.props.currentMonth,currentYear:a.props.currentYear})},a.selectDate=function(e){if("string"===typeof e){var t=ca(e),n=t.month,r=t.year,s=a.state,c=s.currentMonth,o=s.currentYear;a.setState({selectedDate:t}),n===c&&r===o||a.setCurrentMonth({month:n,year:r})}else a.setState({selectedDate:e,dateString:sa(e)})},a.setCurrentMonth=function(e){var t=e.month,n=e.year;a.setState({currentMonth:t,currentYear:n})},a.setCurrentYear=function(e){a.setState({currentYear:e})},a.updateDateString=function(e){var t=e.target.value;a.setState({dateString:t}),oa(t)&&a.selectDate(t)},a.setDate=function(){var e=a.props,t=e.selectedDate,n=e.selectDate,r=a.state.selectedDate;if((null!==t||null!==r)&&!na(t,r)){var s=r.day,c=r.month,o=r.year;n(new Date(o,c,s))}a.closeDatePicker()},a.clearDueDate=function(){var e=a.props,t=e.selectedDate,n=e.selectDate;a.selectDate(null),null!==t&&n(null),a.closeDatePicker()},a.closeDatePicker=function(){var e=a.props.onClose;a.resetCalendar(),e()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.isActive,a=e.innerRef,n=this.state,r=n.today,s=n.selectedDate,c=n.currentMonth,o=n.currentYear,i=n.dateString;return y.a.createElement("div",{className:"date-picker",ref:a,style:{display:t?"block":"none"}},y.a.createElement("div",{className:"date-picker__header"},y.a.createElement("div",{className:"date-picker__due-date-wrapper"},y.a.createElement(ee,{name:"dueDate",type:"text",label:"Due Date",value:i,onChange:this.updateDateString,className:"date-picker__input--due-date",labelClass:"date-picker__label--due-date",placeholder:"mm-dd-yy",maxLength:8}))),y.a.createElement(Vs,{classes:{calendar:"date-picker__calendar",weekDay:"date-picker__week-day"},month:c,year:o,selectedDate:s,today:r,onDayClick:this.selectDate,onMonthClick:this.setCurrentMonth,onYearClick:this.setCurrentYear}),y.a.createElement("div",{className:"date-picker__footer"},y.a.createElement(ae,{size:"sm",variant:"text",color:"neutral",className:"date-picker__btn--clear",onClick:this.clearDueDate},"Clear"),y.a.createElement(ae,{size:"sm",variant:"contained",color:"primary",className:"date-picker__btn--set-due-date",onClick:this.setDate},"Done"),y.a.createElement(ae,{size:"sm",variant:"text",color:"neutral",className:"date-picker__btn--cancel",onClick:this.closeDatePicker},"Cancel")))}}]),t}(k.Component)),Ks=(a(494),function(e){var t=e.onClose,a=e.onClick,n=e.children;return y.a.createElement("div",{className:"task-editor-pane",onClick:a},y.a.createElement(ae,{type:"button",className:"task-editor-pane__btn--close",onClick:t,iconOnly:!0},y.a.createElement(ce,{name:"x"})),n)}),Ys=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isLoading:!a.props.isLoaded},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(F.a.mark(function e(){var t,a,n,r;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.isLoaded,n=t.fetchProjectLists,r=t.projectId,a){e.next=5;break}return e.next=4,n(r);case 4:this.setState({isLoading:!1});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.isLoading,t=this.props,a=t.onChange,n=t.lists,r=t.selectedList,s=t.classes;return e?null:y.a.createElement(dr,{options:n.reduce(function(e,t){return Object(U.a)({},e,Object(R.a)({},t.listId,{value:t.listId,name:t.name}))},{}),value:r,name:"list",align:{inner:"right"},onChange:a,classes:s})}}]),t}(k.Component),Gs=Object(_.b)(function(e,t){return{lists:m.getProjectLists(e,t.projectId),isLoaded:m.getProjectLoadedState(e,t.projectId).lists}},function(e){return{fetchProjectLists:function(t){return e(r.fetchProjectLists(t))}}})(Ys),Hs=(a(495),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).addComment=function(e,t){if("keydown"!==t.type||t.key===Fn){var n=a.props,r=n.currentUser,s=n.firebase,c=n.taskId,o=n.projectId,i=n.activeWorkspace.workspaceId,l=vr(e);s.createComment({content:e.toJSON(),to:l,from:{userId:r.userId,name:r.name},taskId:c,projectId:o,workspaceId:i}),t.preventDefault()}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentUser,a=e.classes,n=e.users,r=e.usersById,s=e.id;return y.a.createElement(y.a.Fragment,null,y.a.createElement(Rn,{classes:{avatar:a.avatar||"",placeholder:a.avatarPlaceholder||""},name:t.name,size:"sm",variant:"circle",imgSrc:t.photoURL}),y.a.createElement(wr,{key:"comment-composer--".concat(s),id:"comment-composer--".concat(s),onSubmit:this.addComment,classes:{container:"comment-composer ".concat(a.composer||""),toolbar:"comment-composer__toolbar",button:"comment-composer__toolbar-btn",addOns:"comment-composer__add-ons"},isMentionsEnabled:!0,mentions:{users:n,usersById:r},addOns:[{type:"submit",onClick:"onSubmit",id:"submitComment",props:{className:"comment-composer__btn--submit ".concat(a.button||""),color:"primary",variant:"contained",children:"Send"}}],marks:[{type:"bold",icon:"bold"},{type:"italic",icon:"italic"},{type:"underlined",icon:"underline"}],inlines:[{type:"mention",icon:"at-sign"}]}))}}]),t}(k.Component));Hs.defaultProps={classes:{avatar:"",avatarPlaceholder:"",composer:"",button:""}};var Js=rn(function(e,t){return!!e&&!!t})(Object(_.b)(function(e){return{users:u.getUsersArray(e),usersById:u.getUsersById(e)}},function(e){return{}})(Hs)),Xs=(a(496),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).updateComment=function(e,t){var n=a.props,r=n.firebase,s=n.commentId;r.updateDoc(["comments",s],{content:e.toJSON(),to:hr(e)}),t.preventDefault()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isReadOnly,a=e.content,n=e.classes,r=e.users,s=e.usersById,c=e.commentId;return y.a.createElement(wr,{id:c,isReadOnly:t,value:a,onUpdate:this.updateComment,classes:{container:"comment-editor ".concat(n.editor||""),toolbar:"comment-editor__toolbar",button:"comment-editor__toolbar-btn",addOns:"comment-editor__add-ons"},isMentionsEnabled:!0,mentions:{users:r,usersById:s},addOns:[{type:"update",id:"updateComment",onClick:"onUpdate",props:{className:"comment-editor__btn--submit ".concat(n.button||""),color:"primary",variant:"contained",children:"Save Changes"}}],marks:[{type:"bold",icon:"bold"},{type:"italic",icon:"italic"},{type:"underlined",icon:"underline"}],inlines:[{type:"mention",icon:"at-sign"}]})}}]),t}(k.Component));Xs.defaultProps={classes:{editor:"",button:""},isReadOnly:!0};var Qs=K(Object(_.b)(function(e){return{users:u.getUsersArray(e),usersById:u.getUsersById(e)}},function(e){return{}})(Xs)),$s=(a(497),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={secondsElapsed:0},a.tick=function(){a.state.secondsElapsed>a.absoluteMin?clearInterval(a.interval):a.setState(function(e){return{secondsElapsed:e.secondsElapsed+1}})},a.getAbsoluteMinSeconds=function(){var e=a.props.absoluteMin,t=Object(H.a)(e,2),n=t[0];switch(t[1]){case"m":return 60*n;case"h":return 60*n*60;case"d":return 60*n*60*24;default:return n}},a.getDateString=function(){var e=a.state.secondsElapsed,t=a.props,n=t.date,r=t.isRelative,s=t.dateOnly,c=t.timeOptions,o=t.dateOptions,i=la(n,o),l=s?i:"".concat(i," at ").concat(ua(n,c));return r?e<60?"Just now":e<120?"1 minute ago":e<3600?"".concat(Math.floor(e/60)," minutes ago"):e<7200?"1 hour ago":e<a.absoluteMin?"".concat(Math.floor(e/3600)," hours ago"):l:l},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.date,a=e.isRelative;if(t){var n=Math.floor(Date.now()/1e3)-Math.floor(t.getTime()/1e3);this.setState({secondsElapsed:n}),this.absoluteMin=this.getAbsoluteMinSeconds(),(n<this.absoluteMin||!a)&&(this.interval=setInterval(this.tick,1e3))}}},{key:"componentWillUnmount",value:function(){this.interval&&clearInterval(this.interval)}},{key:"render",value:function(){var e=this.props,t=e.date,a=e.className;return t?y.a.createElement("span",{className:"timestamp ".concat(a)},this.getDateString()):null}}]),t}(k.Component));$s.defaultProps={className:"",isRelative:!0,dateOnly:!1,absoluteMin:[6,"h"],timeOptions:{format:"h:mm",hour12:!0},dateOptions:{useRelative:!0,format:{weekday:"short",month:"short",day:"numeric",year:"2-digit"}}};a(498);var Zs=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isCommentEditorActive:!1},a.handleLike=function(){var e=a.props,t=e.commentId,n=e.likes,r=e.currentUserId,s=e.firebase;n[r]?s.updateDoc(["comments",t],Object(R.a)({},"likes.".concat(r),s.deleteField())):s.updateDoc(["comments",t],Object(R.a)({},"likes.".concat(r),!0))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.commentId,a=e.user,n=e.content,r=e.createdAt,s=e.likes,c=e.isPinned,o=this.state.isCommentEditorActive,i=a.name,l=a.photoURL,u=Object.keys(s).length;return r?y.a.createElement("div",{className:"comment__wrapper ".concat(c?"is-pinned":"")},y.a.createElement(Rn,{classes:{avatar:"comment__avatar",placeholder:"comment__avatar-placeholder"},name:i,size:"sm",variant:"circle",imgSrc:l}),y.a.createElement("div",{className:"comment"},y.a.createElement("div",{className:"comment__header"},y.a.createElement("div",{className:"comment__details"},y.a.createElement("span",{className:"comment__name"},i),y.a.createElement($s,{className:"comment__timestamp",date:r.toDate()})),y.a.createElement(ae,{className:"comment__likes",onClick:this.handleLike,size:"sm"},y.a.createElement(ce,{name:"thumbs-up"}),y.a.createElement("span",{className:"comment__likes-counter"},u>0?u:""))),y.a.createElement(Qs,{key:t,commentId:t,content:n,isReadOnly:!o}))):null}}]),t}(k.Component),ec=K(Object(_.b)(function(e,t){return{user:u.getUserData(e,t.from.userId),currentUserId:l.getCurrentUserId(e)}},function(e){return{}})(Zs)),tc=function(e){return{type:"LOAD_COMMENTS_BY_ID",commentsById:e}},ac=function(e){return{type:"ADD_COMMENT",commentId:e.commentId,commentData:e.commentData}},nc=function(e){return{type:"REMOVE_COMMENT",commentId:e}},rc=function(e){return{type:"UPDATE_COMMENT",commentId:e.commentId,commentData:e.commentData}},sc=function(){return function(){var e=Object(W.a)(F.a.mark(function e(t){var a;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.fs.collection("comments").get().then(function(e){var t={};return e.forEach(function(e){t[e.id]=Object(U.a)({commentId:e.id},e.data())}),t});case 3:a=e.sent,t(tc(a)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}()},cc=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a){var n;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.fs.collection("comments").where("taskId","==",e).get().then(function(e){var t={};return e.forEach(function(e){t[e.id]=Object(U.a)({commentId:e.id},e.data())}),t});case 3:n=t.sent,a(tc(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},oc=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a){var n;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.fs.collection("comments").where("to","array-contains",e).get().then(function(e){var t={};return e.forEach(function(e){t[e.id]=Object(U.a)({commentId:e.id},e.data())}),t});case 3:n=t.sent,a(tc(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},ic=function(e){return function(){var t=Object(W.a)(F.a.mark(function t(a,n){var r;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.fs.collection("comments").where("taskId","==",e).onSnapshot(function(){var t=Object(W.a)(F.a.mark(function t(r){var s,c,o,i,l;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.docChanges();case 2:s=t.sent,c=n(),o=c.tasksById,i=o[e],r.size===s.length&&s.every(function(e){return"added"===e.type})?(l={},s.forEach(function(e){var t=e.doc.id,a=e.doc.data();l[t]=Object(U.a)({commentId:t},a)}),a(tc(l)),i.isLoaded.comments||a(rt(e,"comments"))):s.forEach(function(e){var t=e.doc.id,r=e.doc.data(),s=n().commentsById;if("added"===e.type){r.createdAt;if(s&&t in s)return;a(ac({commentId:t,commentData:r}))}else if("removed"===e.type){if(!(t in s))return;a(nc(t))}else a(rc({commentId:t,commentData:r}))});case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 3:return r=t.sent,t.abrupt("return",r);case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,a){return t.apply(this,arguments)}}()},lc=function(e){return e.commentsById},uc=function(e,t){var a=e.commentsById;return a?a[t]:null},dc=function(e,t){var a=e.commentsById;return t&&a?t.reduce(function(e,t){var n=a[t];return n?e.concat(n):e},[]):[]},pc=function(e,t){var a=e.commentsById,n=e.tasksById;if(a&&n){var r=n[t];if(r)return r.commentIds.map(function(e){return a[e]})}return[]};function mc(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var fc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_COMMENTS_BY_ID":var a=t.commentsById;return Object(U.a)({},e&&e,a);case"ADD_COMMENT":var n=t.commentId,r=t.commentData;return Object(U.a)({},e&&e,Object(R.a)({},n,Object(U.a)({commentId:n,isLoaded:!0},r)));case"REMOVE_COMMENT":var s=t.commentId;return e[s],Object($.a)(e,[s].map(mc));case"UPDATE_COMMENT":var c=t.commentId,o=t.commentData;return Object(U.a)({},e,Object(R.a)({},c,Object(U.a)({},e[c],o)));case"RESET_ACTIVE_WORKSPACE":return null;default:return e}},hc=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isLoading:!a.props.isLoaded},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(F.a.mark(function e(){var t,a,n;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.syncTaskComments,n=t.taskId,e.next=3,a(n);case 3:this.unsubscribe=e.sent,this.setState({isLoading:!1});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"render",value:function(){var e=this.props.comments;return this.state.isLoading?null:e.length>0?e.map(function(e){return y.a.createElement(ec,Object.assign({key:e.commentId},e))}):null}}]),t}(k.Component),vc=K(Object(_.b)(function(e,t){return{comments:g.getCommentsArray(e,t.commentIds),isLoaded:i.getTaskLoadedState(e,t.taskId).comments}},function(e){return{syncTaskComments:function(t){return e(b.syncTaskComments(t))}}})(hc)),bc=function(e){var t=e.layout,a=e.handleTaskEditorClose,n=e.onOutsideClick,r=e.children;return"board"===t?y.a.createElement(Tn,{onModalClose:a,classes:{content:"task-editor",button:"task-editor__btn--close"},size:"lg",id:"taskEditor",onOutsideClick:n},r):y.a.createElement(Ks,{onClose:a},r)},gc=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:a.props.name,isDatePickerActive:!1,isMemberSearchActive:!1,prevProps:{name:a.props.name},viewportWidth:null},a.setViewportWidth=function(){a.setState({viewportWidth:window.innerWidth})},a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.deleteTask=function(){var e=a.props,t=e.taskId,n=e.listId,r=e.handleTaskEditorClose;(0,e.deleteTask)({taskId:t,listId:n}),r()},a.onBlur=function(e){var t=e.target.name,n=a.props,r=n[t],s=n.taskId,c=n.firebase,o=a.state[t];o!==r&&(c.updateDoc(["tasks",s],Object(R.a)({},t,o)),console.log("Updated task!"))},a.resetForm=function(e){a.setState(Object(R.a)({},e,""))},a.handleMoreActions=function(e){if(e.target.matches("a")){switch(e.target.dataset.action){case"delete":a.deleteTask()}e.preventDefault()}},a.assignMember=function(e,t){var n=a.props,r=n.taskId,s=n.projectId,c=n.projectName,o=n.assignedTo,i=n.firebase,l=n.folders,u=n.dueDate,d=n.activeWorkspace.workspaceId;if(o.includes(e)){if(!s)return;var p=l[e];i.removeAssignee({taskId:r,projectId:s,userId:e,folderId:p,dueDate:u,workspaceId:d})}else i.addAssignee({taskId:r,projectId:s,projectName:c,userId:e,dueDate:u,workspaceId:d})},a.setDueDate=function(e){var t=a.props,n=t.firebase,r=t.taskId,s=t.assignedTo,c=t.dueDate,o=t.activeWorkspace.workspaceId,i=c?new Date(c.toDate()):null;n.setTaskDueDate({taskId:r,prevDueDate:i,newDueDate:e,assignedTo:s,workspaceId:o})},a.toggleDatePicker=function(){a.setState(function(e){return{isDatePickerActive:!e.isDatePickerActive}})},a.toggleCompleted=function(e){var t=a.props,n=t.taskId,r=t.isCompleted,s=t.firebase;s.updateDoc(["tasks",n],{isCompleted:!r,completedAt:r?null:s.getTimestamp()})},a.moveToList=function(e){e.stopPropagation();var t=a.props,n=t.firebase,r=t.taskId,s=t.listsById,c=t.listId,o=e.target.value,i=e.target.dataset.label,l=[].concat(Object(G.a)(s[o].taskIds),[r]);n.moveTaskToList({taskId:r,origListId:c,newListId:o,updatedTaskIds:l,newListName:i})},a.toggleMemberSearch=function(){a.setState(function(e){return{isMemberSearchActive:!e.isMemberSearchActive}})},a.hideMemberSearch=function(e){e.target.matches(".task-editor__btn--add-member")||a.setState({isMemberSearchActive:!1})},a.onOutsideClick=function(e){var t=a.props.handleTaskEditorClose;e.target.matches(".member-search__item")||e.target.matches(".tags-input__item")||t()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){"board"===this.props.layout&&(this.setViewportWidth(),this.handleResize=ps(200,this.setViewportWidth),window.addEventListener("resize",this.handleResize))}},{key:"componentWillUnmount",value:function(){this.handleResize&&window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=this,t=this.props,a=t.handleTaskEditorClose,n=t.taskId,r=t.commentIds,s=t.assignedTo,c=t.taskTags,o=t.mergedTags,i=t.dueDate,l=t.subtaskIds,u=t.projectId,d=t.completedSubtasks,p=t.layout,m=t.listId,f=t.isCompleted,h=t.notes,v=this.state,b=v.name,g=v.isDatePickerActive,k=v.viewportWidth,I=l&&l.length>0,j=r&&r.length>0,_=ta(i?i.toDate():new Date),E=i?la(i.toDate(),{useRelative:!0,format:{month:"short",day:"numeric"}}):null,w="Today"===E,O="Tomorrow"===E,C=i&&ia(i.toDate()),T=!u;return y.a.createElement(bc,{handleTaskEditorClose:a,onOutsideClick:this.onOutsideClick,layout:p},y.a.createElement(ur,{className:"task-editor__toolbar"},y.a.createElement(ae,{type:"button",onClick:this.toggleCompleted,size:"md",variant:f?"contained":"outlined",color:"success",className:"task-editor__btn--toggle-completed"},y.a.createElement(ce,{name:"check"}),f?"Completed":"Mark Completed"),y.a.createElement(Ps,{onMenuClick:this.handleMoreActions})),y.a.createElement("div",{className:"task-editor__wrapper"},y.a.createElement("form",{name:"editTaskForm",className:"task-editor__edit-task-form"},y.a.createElement(ms,{className:"task-editor__textarea--title",name:"name",value:b,onChange:this.onChange,required:!0,onBlur:this.onBlur}),T?y.a.createElement("div",{className:"task-editor__private-indicator"},y.a.createElement(ys,{className:"task-editor__badge--private"},"Private")):y.a.createElement(xs,{size:"sm"},y.a.createElement("div",{className:"task-editor__project-name"},y.a.createElement(Es,{projectId:u,size:"md",variant:"icon",classes:{badge:"task-editor__project-badge",icon:"task-editor__project-badge-icon"}})),y.a.createElement("div",{className:"task-editor__list-name"},y.a.createElement(Gs,{classes:{button:"task-editor__project-list-dropdown-btn--toggle",menu:"task-editor__project-list-dropdown-menu"},projectId:u,selectedList:m,onChange:this.moveToList}))),y.a.createElement(xs,null,y.a.createElement(ae,{onClick:this.toggleDatePicker,type:"button",className:"task-editor__btn--due-date ".concat(g?"is-active":"")},y.a.createElement("span",{className:"task-editor__due-date-icon"},y.a.createElement(ce,{name:"calendar"})),y.a.createElement("span",{className:"task-editor__due-date-wrapper"},i?y.a.createElement(y.a.Fragment,null,y.a.createElement("span",{className:"task-editor__section-title--sm"},"Due Date"),y.a.createElement("span",{className:"task-editor__due-date ".concat(w?"is-due-today":O?"is-due-tmrw":C?"is-past-due":"")},E)):y.a.createElement("span",{className:"task-editor__no-due-date"},"Set due date"))),y.a.createElement(qs,{innerRef:function(t){return e.datePickerEl=t},onClose:this.toggleDatePicker,selectedDate:i?_:null,currentMonth:_.month,currentYear:_.year,selectDate:this.setDueDate,isActive:g})),y.a.createElement(xs,null,y.a.createElement("div",{className:"task-editor__section-icon"},y.a.createElement(ce,{name:"user"})),y.a.createElement("div",{className:"task-editor__members"},y.a.createElement(Xn,{classes:{memberAssigner:"task-editor__member-assigner"},placeholder:"Assign or remove member",memberIds:s,onSelectMember:this.assignMember,memberSearchIsDisabled:T}))),y.a.createElement(xs,null,y.a.createElement("div",{className:"task-editor__section-icon"},y.a.createElement(ce,{name:"tag"})),y.a.createElement(zs,{taskId:n,projectId:u,tagSuggestions:o,assignedTags:c})),y.a.createElement(xs,null,y.a.createElement("div",{className:"task-editor__section-icon"},y.a.createElement(ce,{name:"edit-3"})),y.a.createElement(Cr,{placeholder:"Add a description",type:"task",key:"notes--".concat(n),id:n,value:h,isMentionsEnabled:!T,classes:{editor:"task-editor__textarea task-editor__textarea--description"}}))),y.a.createElement(xs,null,y.a.createElement("div",{className:"task-editor__section-header"},y.a.createElement("div",{className:"task-editor__section-icon"},y.a.createElement(ce,{name:"check-circle"})),y.a.createElement("h3",{className:"task-editor__section-title"},I&&y.a.createElement("span",{className:"task-editor__section-detail"},d.length,"/",l.length),"Subtasks"),y.a.createElement("hr",{className:"task-editor__hr"})),y.a.createElement("div",{className:"task-editor__subtasks-container"},y.a.createElement(Rs,{taskId:n,subtaskIds:l,projectId:u,usePortal:"board"===p&&k>=576}),y.a.createElement(Fs,{taskId:n,projectId:u,classes:{composer:"task-editor__subtask-composer",iconWrapper:"task-editor__subtask-composer-icon-wrapper",form:"task-editor__new-subtask-form",textarea:"task-editor__textarea--new-subtask",button:"task-editor__btn--add-subtask"}}))),!T&&y.a.createElement(xs,{className:"comments"},y.a.createElement("div",{className:"task-editor__section-header"},y.a.createElement("div",{className:"task-editor__section-icon"},y.a.createElement(ce,{name:"message-circle"})),y.a.createElement("h3",{className:"task-editor__section-title"},j&&y.a.createElement("span",{className:"task-editor__section-detail"},r.length),j&&1===r.length?"Comment":"Comments"),y.a.createElement("hr",{className:"task-editor__hr"})),j&&y.a.createElement("div",{className:"task-editor__comments"},y.a.createElement(vc,{taskId:n,commentIds:r})),y.a.createElement(Js,{key:"comment-composer--".concat(n),id:"comment-composer--".concat(n),taskId:n,projectId:u,classes:{avatar:"task-editor__avatar",avatarPlaceholder:"task-editor__avatar-placeholder",composer:"task-editor__comment-composer",button:"task-editor__btn--submit-comment"}}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.name!==t.prevProps.name?{name:e.name,prevProps:{name:e.name}}:null}}]),t}(k.Component),kc=rn(function(e,t){return!!e&&!!t})(Object(_.b)(function(e,t){return{taskTags:i.getTaskTags(e,t.taskId),mergedTags:l.getMergedProjectTags(e,t.projectId),completedSubtasks:v.getCompletedSubtasks(e,t.subtaskIds),listsById:f.getListsById(e)}},function(e){return{deleteTask:function(t){var a=t.taskId,n=t.listId;return e(s.deleteTask({taskId:a,listId:n}))}}})(gc)),yc=(a(499),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).onDragEnd=function(e){var t=e.destination,n=e.draggableId,r=e.source,s=e.type;if(t&&(t.droppableId!==r.droppableId||t.index!==r.index)){var c=a.props,o=c.firebase,l=c.listsById,u=c.tempSettings,d=c.state,p=u.tasks,m=p.view,f=p.sortBy;if(s===sr){var h=t.droppableId,v=t.index,b=r.droppableId,g=r.index,k=b===h,y=i.getTaskIdsByViewFilter(d,{listId:h}),I=i.getSortedTaskIds(d,Object(G.a)(y[m]),f);if(k)I.splice(g,1),I.splice(v,0,n),o.updateDoc(["lists",b],{taskIds:"all"===m?I:"active"===m?[].concat(Object(G.a)(y.completed),Object(G.a)(I)):[].concat(Object(G.a)(I),Object(G.a)(y.active))});else{var j=l[t.droppableId].name;I.splice(v,0,n),o.moveTaskToList({taskId:n,origListId:r.droppableId,newListId:t.droppableId,updatedTaskIds:"all"===m?I:"active"===m?[].concat(Object(G.a)(y.completed),Object(G.a)(I)):[].concat(Object(G.a)(I),Object(G.a)(y.active)),newListName:j})}}if(s===rr){var _=a.props,E=_.project,w=_.projectId,O=Object(G.a)(E.listIds);O.splice(r.index,1),O.splice(t.index,0,n),o.updateDoc(["projects",w],{listIds:O})}}},a.closeTaskEditor=function(){(0,a.props.selectTask)(null)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(F.a.mark(function e(){var t,a,n,r,s,c,o=this;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.projectId,n=t.selectProject,r=t.selectedProjectId,s=t.syncProjectLists,c=t.syncProjectSubtasks,r!==a&&n(a),e.next=4,Promise.all([s(a),c(a)]).then(function(e){o.unsubscribe=e});case 4:console.log("mounted");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.selectProject,a=e.selectTask,n=e.selectedTaskId;t(null),n&&a(null),this.unsubscribe.forEach(function(e){return e()})}},{key:"render",value:function(){var e=this.props,t=e.selectedTask,a=e.projectId,n=e.userId,r=e.selectedTaskId,s=e.isLoaded,c=e.project,o=e.tempSettings,i=c.name,l=c.listIds,u=o.layout,d=!!r;return s.tasks&&s.subtasks&&s.lists?y.a.createElement("main",{className:"project-container project-container--".concat(u," ").concat(d?"show-task-editor":"")},y.a.createElement("div",{className:"project__wrapper"},y.a.createElement(nr.a,{onDragEnd:this.onDragEnd,onDragStart:this.onDragStart},y.a.createElement(Ur,c,l.map(function(e,t){return y.a.createElement(Ss,{viewFilter:o.tasks.view,sortBy:o.tasks.sortBy,listId:e,key:e,index:t,projectId:a,projectName:i,layout:u,isRestricted:!1})}))),d&&y.a.createElement(kc,Object.assign({},t,{handleTaskEditorClose:this.closeTaskEditor,userId:n,layout:u})))):null}}]),t}(k.Component)),Ic=rn(function(e){return!!e})(Object(_.b)(function(e,t){return{state:e,selectedProjectId:_n(e),selectedTaskId:Lr(e),selectedTask:Fr(e),listsById:f.getListsById(e),project:m.getProject(e,t.projectId),isLoaded:m.getProjectLoadedState(e,t.projectId),tempSettings:m.getTempProjectSettings(e,t.projectId)}},function(e){return{selectProject:function(t){return e(jn(t))},selectTask:function(t){return e(Rr(t))},syncProjectLists:function(t){return e(n.syncProjectLists(t))},syncProjectTasks:function(t){return e(s.syncProjectTasks(t))},syncProjectSubtasks:function(t){return e(h.syncProjectSubtasks(t))},syncProject:function(t){return e(r.syncProject(t))},setTempProjectSettings:function(t){var a=t.projectId,n=t.view,s=t.sortBy;return e(r.setTempProjectSettings({projectId:a,view:n,sortBy:s}))}}})(yc)),jc=function(e){var t=e.className,a=e.name,n=e.children,r=e.size,s=e.link;return y.a.createElement("section",{className:"dashboard-panel ".concat(t?"dashboard-panel--".concat(t):""," dashboard-panel--").concat(r)},y.a.createElement("header",{className:"dashboard-panel__header"},y.a.createElement("h2",{className:"dashboard-panel__name"},a),s&&y.a.createElement(M.a,{to:s.path,className:"dashboard-panel__link"},s.text)),y.a.createElement("div",{className:"dashboard-panel__content"},n))};jc.defaultProps={size:"lg",link:null,className:""};var _c=jc,Ec=rn(function(e){return!!e})(Object(_.b)(function(e){return{tasksDueSoon:l.getTasksDueWithinDays(e,7)}})(function(e){var t=e.tasksDueSoon,a=e.currentUser;return y.a.createElement(_c,{className:"tasks-due-soon",size:"md",name:"Tasks Due Soon",link:{path:"/0/".concat(a.userId,"/tasks"),text:"View all tasks"}},t.length>0?y.a.createElement("ul",{className:"dashboard__tasks"},t.map(function(e,t){return y.a.createElement(Os,{className:"dashboard__task",index:t,key:e.taskId,taskId:e.taskId})})):y.a.createElement("div",{className:"dashboard__info--empty"},"No tasks due in the next 7 days."))})),wc=(a(500),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(){var e=a.props,t=e.onTaskClick,n=e.source.parent;switch(n.type){case"task":return t(n.id);default:return function(){return null}}},a.archiveNotification=function(){var e=a.props,t=e.notificationId;e.firebase.updateDoc(["notifications",t],{isActive:!1})},a.acceptInvite=function(){var e=a.props,t=e.notificationId,n=e.firebase,r=e.source,s=e.currentUser;"workspace"===r.type&&n.acceptWorkspaceInvite({user:{userId:s.userId,email:s.email,name:s.name},workspace:{id:r.id,name:r.data.name},from:r.user.userId,notificationId:t})},a.declineInvite=function(){var e=a.props,t=e.notificationId,n=e.firebase,r=e.source,s=e.currentUser;"workspace"===r.type&&n.declineWorkspaceInvite({user:{userId:s.userId,email:s.email,name:s.name},workspace:{id:r.id,name:r.data.name},from:r.user.userId,notificationId:t})},a.renderMessage=function(){var e=a.props,t=e.event,n=e.source;switch(t.type){case"mention":return y.a.createElement(y.a.Fragment,null,"mentioned you in a",y.a.createElement("a",{href:"#",className:"notification__link notification__link--task",onClick:a.onClick},n.type),".");case"invite":return y.a.createElement(y.a.Fragment,null,"invited you to join ",y.a.createElement("strong",null,n.data.name),".");case"rsvp":return y.a.createElement(y.a.Fragment,null,t.data.state," your invitation to"," ",y.a.createElement("strong",null,n.data.name),".");default:return""}},a.renderRequiredActions=function(){var e=a.props,t=e.event;e.source;switch(t.type){case"invite":return y.a.createElement(y.a.Fragment,null,y.a.createElement(ae,{className:"notification__btn notification__btn--decline",variant:"text",color:"primary",size:"sm",onClick:a.declineInvite},"Decline"),y.a.createElement(ae,{className:"notification__btn notification__btn--accept",variant:"contained",color:"primary",size:"sm",onClick:a.acceptInvite},"Accept"));default:return""}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.source,a=e.event,n=e.isActionPending,r=t.user,s=a.publishedAt;return y.a.createElement("li",{className:"notification"},r.userId&&y.a.createElement(M.a,{className:"notification__link notification__link--user-profile",to:"/0/".concat(r.userId,"/profile")},r.name),this.renderMessage(),y.a.createElement("div",{className:"notification__footer"},s&&y.a.createElement($s,{date:s.toDate(),className:"notification__timestamp"}),y.a.createElement("div",{className:"notification__actions"},n?this.renderRequiredActions():y.a.createElement(ae,{onClick:this.archiveNotification,size:"sm",className:"notification__btn notification__btn--archive"},"Archive"))))}}]),t}(k.Component)),Oc=Object(z.a)(Object(_.b)(function(e){return{}},function(e){return{selectTask:function(t){return e(Rr(t))}}}),rn(function(e){return!!e}))(wc),Cc=(a(501),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isLoading:!0},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(F.a.mark(function e(){var t,a,n,r,s,c;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.currentUser,n=t.syncNotifications,r=t.activeWorkspace,s=a.userId,c=r.workspaceId,e.next=5,n({userId:s,workspaceId:c});case 5:this.unsubscribe=e.sent,this.setState({isLoading:!1});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.unsubscribe()}},{key:"render",value:function(){var e=this.state.isLoading,t=this.props,a=t.notifications,n=t.onTaskClick;return e?null:y.a.createElement(_c,{className:"notifications",name:"Notifications",size:"sm"},a.length>0?y.a.createElement("ul",{className:"notifications__list"},a.map(function(e){return y.a.createElement(Oc,Object.assign({key:e.notificationId,onTaskClick:"comment"===e.source.type?n:null},e))})):y.a.createElement("div",{className:"dashboard__info--empty"},"You have no notifications."))}}]),t}(k.Component)),Tc=rn(function(e,t){return!!e&&!!t})(Object(_.b)(function(e){return{notifications:l.getNotificationsArray(e)}},function(e){return{syncNotifications:function(t){var a=t.userId,n=t.workspaceId;return e(o.syncNotifications({userId:a,workspaceId:n}))}}})(Cc)),Nc=(rn(function(e){return!!e})(Object(_.b)(function(e){return{overdueTasks:l.getOverdueTasks(e)}})(function(e){var t=e.overdueTasks,a=e.currentUser;return y.a.createElement(_c,{className:"overdue-tasks",size:"md",name:"Overdue Tasks",link:{path:"/0/".concat(a.userId,"/tasks"),text:"View all tasks"}},t.map(function(e,t){return y.a.createElement(Os,{className:"dashboard__task",index:t,key:e.taskId,taskId:e.taskId})}))})),a(502),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).closeTaskEditor=function(){(0,a.props.selectTask)(null)},a.handleTaskClick=function(e){(0,a.props.selectTask)(e)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.tasksById,a=e.toggleProjectComposer,n=e.currentUser,r=e.selectedTaskId,s=n.userId,c=!!r;return y.a.createElement(P,{title:"Home",classes:{main:"dashboard",title:"dashboard__header"}},y.a.createElement(Ec,null),y.a.createElement(Tc,{onTaskClick:this.handleTaskClick}),y.a.createElement(_c,{className:"projects",name:"My Projects",icon:"grid"},y.a.createElement(wn,{className:"dashboard__project-grid",openProjectComposer:a})),c&&y.a.createElement(kc,Object.assign({},t[r],{handleTaskEditorClose:this.closeTaskEditor,userId:s,layout:"board"})))}}]),t}(k.Component)),Dc=rn(function(e){return!!e})(Object(_.b)(function(e,t){return{selectedTaskId:Lr(e),tasksById:i.getTasksById(e)}},function(e){return{selectTask:function(t){return e(Rr(t))}}})(Nc)),Sc=function(e){var t=e.children,a=e.className,n=e.onClick;return y.a.createElement("div",{className:"expansion-panel__header ".concat(a),role:"button",onClick:n,tabIndex:0,onKeyDown:n,onDragOver:n},t)};Sc.defaultProps={className:""};var Ac=Sc,xc=function(e){var t=e.className,a=e.children;return y.a.createElement("div",{className:t},a)};xc.defaultProps={className:""};var Pc=xc,Bc=(a(503),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isExpanded:!1},a.toggleContent=function(e){if("keydown"!==e.type||e.key===Fn){var t=a.props,n=t.onToggle,r=t.id;n?n(e,r):a.setState(function(e){return{isExpanded:!e.isExpanded}})}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.header,n=e.children,r=e.innerRef,s=e.isExpanded,c=Object($.a)(e,["classes","header","children","innerRef","isExpanded"]),o=void 0!==s?s:this.state.isExpanded;return y.a.createElement("div",Object.assign({className:"expansion-panel ".concat(o?"is-expanded":""," ").concat(t.panel||""),"aria-expanded":o,ref:r},c),y.a.createElement(Ac,{onClick:this.toggleContent,className:"".concat(o?"is-expanded":""," ").concat(t.header||"")},a),o&&y.a.createElement(Pc,{className:t.content||""},n))}}]),t}(k.Component));Bc.defaultProps={classes:{panel:"",header:"",content:""},isExpanded:void 0,id:null,innerRef:null};a(504);var Mc=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:a.props.name,isExpanded:a.props.taskIds.length>0,prevProps:{taskIds:a.props.taskIds}},a.toggleFolder=function(e){e.target.matches(".folder__btn--more-actions")||a.setState(function(e){return{isExpanded:!e.isExpanded}})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.taskIds,n=t.projectId,r=t.projectName,s=t.folderId,c=t.index,o=t.dueDate,i=t.userPermissions,l=(t.tempTaskSettings,this.state),u=l.name,d=l.isExpanded;return y.a.createElement(nr.b,{draggableId:s||n||"".concat(o),index:c,isDragDisabled:!i.enableNameChange},function(t,c){return y.a.createElement(y.a.Fragment,null,y.a.createElement(Bc,Object.assign({isExpanded:d,onToggle:e.toggleFolder,classes:{panel:"folder",content:"folder__content",header:"folder__header"},innerRef:t.innerRef},t.draggableProps,t.dragHandleProps,{header:y.a.createElement(y.a.Fragment,null,y.a.createElement(ae,{type:"button",size:"sm",className:"folder__btn--toggle",iconOnly:!0},y.a.createElement(ce,{name:"chevron-right"})),y.a.createElement(ee,{className:"folder__input--title",name:"name",type:"text",value:u,onChange:e.onChange,isRequired:i.enableNameChange,isReadOnly:!i.enableNameChange,onBlur:e.onBlur,onClick:e.toggleFolder}))}),y.a.createElement("div",{className:"folder__tasks"},y.a.createElement(Ns,{taskIds:a,listId:null,folderId:s,projectId:n,dueDate:o,isDragDisabled:!i.enableDragNDrop,dropType:i.enableTaskAdd?sr:n||s||o,layout:"list"})),i.enableTaskAdd&&y.a.createElement(ds,{listId:null,listName:null,dueDate:o,projectId:n,projectName:r,folderId:s})))})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return 0===t.prevProps.taskIds.length&&e.taskIds.length>0&&!t.isExpanded?{isExpanded:!0,prevProps:Object(U.a)({},t.prevProps,{taskIds:e.taskIds})}:null}}]),t}(k.Component);Mc.defaultProps={userPermissions:{enableNameChange:!1,enableTaskAdd:!0,enableDragnDrop:!0}};var Uc=Object(_.b)(function(e,t){return{tempTaskSettings:l.getTempTaskSettings(e)}},function(e){return{}})(Mc),Rc=(a(505),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isLoading:!0,isTaskSettingsMenuVisible:!1},a.closeTaskEditor=function(){(0,a.props.selectTask)(null)},a.handleTaskClick=function(e){(0,a.props.selectTask)(e)},a.onDragEnd=function(e){var t=e.destination,n=e.draggableId,r=e.source,s=e.type;if(t&&(t.droppableId!==r.droppableId||t.index!==r.index)){var c=a.props,o=c.firebase,l=c.currentUser,u=c.state,d=c.activeWorkspace.workspaceId,p=l.userId,m=l.folderIds,f=l.tempSettings.tasks,h=f.view,v=f.sortBy;switch(s){case sr:var b=r.droppableId,g=r.index,k=t.droppableId,y=t.index,I=b===k,j=i.getTaskIdsByViewFilter(u,{folderId:k}),_=Object(G.a)(j[h]);I?(console.log(k),_.splice(g,1),_.splice(y,0,n),o.updateDoc(["users",p,"workspaces",d,"folders",k],{taskIds:"all"===h?_:"active"===h?[].concat(Object(G.a)(j.completed),Object(G.a)(_)):[].concat(Object(G.a)(_),Object(G.a)(j.active))})):(console.log(b,k),_.splice(y,0,n),o.moveTaskToFolder({workspaceId:d,userId:p,taskId:n,origFolderId:b,newFolderId:k,updatedTaskIds:"all"===h?_:"active"===h?[].concat(Object(G.a)(j.completed),Object(G.a)(_)):[].concat(Object(G.a)(_),Object(G.a)(j.active)),type:"folder"===v?"default":v}));break;case cr:var E=a.props.reorderFolders,w=Object(G.a)(m);w.splice(r.index,1),w.splice(t.index,0,n),o.updateDoc(["users",p,"workspaces",d],{folderIds:w}),E(p,w);break;default:var O=r.droppableId,C=r.index,T=t.droppableId,N=t.index,D=O===T,S=i.getTaskIdsByViewFilter(u,{folderId:T}),A=Object(G.a)(S[h]);D&&(A.splice(C,1),A.splice(N,0,n),o.updateDoc(["users",p,"workspaces",d,"folders",T],{taskIds:"all"===h?A:"active"===h?[].concat(Object(G.a)(S.completed),Object(G.a)(A)):[].concat(Object(G.a)(A),Object(G.a)(S.active))}))}}},a.saveTaskSettings=function(){var e,t=a.props,n=t.firebase,r=t.currentUser,s=r.userId,c=r.tempSettings.tasks,o=c.view,i=c.sortBy;n.updateDoc(["users",s],(e={},Object(R.a)(e,"settings.tasks.view",o),Object(R.a)(e,"settings.tasks.sortBy",i),e)),a.closeTaskSettingsMenu()},a.setTempTaskSettings=function(e){var t=a.props.setTempTaskSettings,n=e.target,r=n.name,s=n.value;t(Object(R.a)({},r,s))},a.toggleTaskSettingsMenu=function(e){e.stopPropagation(),a.setState(function(e){return{isTaskSettingsMenuVisible:!e.isTaskSettingsMenuVisible}})},a.closeTaskSettingsMenu=function(){a.setState({isTaskSettingsMenuVisible:!1})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(F.a.mark(function e(){var t;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.syncFolders,e.next=3,t();case 3:this.unsubscribe=e.sent,this.setState({isLoading:!1});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.unsubscribe();var e=this.props,t=e.selectedTaskId,a=e.selectTask;t&&a(null)}},{key:"render",value:function(){var e=this,t=this.props,a=t.currentUser,n=t.selectedTaskId,r=t.selectedTask,s=t.taskGroups,c=a.userId,o=a.tempSettings.tasks,i=o.view,l=o.sortBy,u=this.state,d=u.isLoading,p=u.isTaskSettingsMenuVisible,m=!!n;return d?null:y.a.createElement(P,{title:"My Tasks",classes:{main:"user-tasks__container ".concat(m?"show-task-editor":""),title:"user-tasks__title"}},y.a.createElement("div",{className:"user-tasks__wrapper"},y.a.createElement(nr.a,{onDragEnd:this.onDragEnd,onDragStart:this.onDragStart},y.a.createElement(nr.c,{droppableId:c,type:cr},function(t){return y.a.createElement("div",Object.assign({className:"user-tasks",ref:t.innerRef},t.droppableProps),y.a.createElement(mr,{icon:"sliders",isActive:p,onToggle:e.toggleTaskSettingsMenu,onClose:e.closeTaskSettingsMenu,onSave:e.saveTaskSettings,classes:{wrapper:"user-tasks__settings-wrapper",settings:"user-tasks__settings"},settings:[{name:"View",key:"view",type:"radio",options:{active:{value:"active",name:"Active Tasks"},completed:{value:"completed",name:"Completed Tasks"},all:{value:"all",name:"All Tasks"}},value:i,onChange:e.setTempTaskSettings},{name:"Sort By",key:"sortBy",type:"select",options:{folder:{value:"folder",name:"Folder"},dueDate:{value:"dueDate",name:"Due Date"},project:{value:"project",name:"Project"}},value:l,onChange:e.setTempTaskSettings}]}),s.map(function(e,t){return y.a.createElement(Uc,{key:"".concat(l,"-").concat(e[l]||e["".concat(l,"Id")]),userId:c,folderId:e.folderId,projectId:e.projectId,projectName:e.projectName,dueDate:e.dueDate,index:t,name:e.name,taskIds:e.taskIds,userPermissions:e.userPermissions})}),t.placeholder)})),m&&y.a.createElement(kc,Object.assign({},r,{handleTaskEditorClose:this.closeTaskEditor,userId:c,layout:"list",key:n}))))}}]),t}(k.Component)),Lc=rn(function(e,t){return!!e&&!!t})(Object(_.b)(function(e){return{state:e,selectedTask:Fr(e),selectedTaskId:Lr(e),taskGroups:l.getSortedFilteredTaskGroups(e)}},function(e){return{syncFolders:function(){return e(o.syncFolders())},selectTask:function(t){return e(Rr(t))},reorderFolders:function(t,a){return e(o.reorderFolders(t,a))},setTempTaskSettings:function(t){var a=t.view,n=void 0===a?null:a,r=t.sortBy,s=void 0===r?null:r;return e(o.setTempTaskSettings({view:n,sortBy:s}))}}})(Rc)),Fc=(a(506),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).inputRef=function(e){a.input=e,(0,a.props.setInputRef)(e)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.isExpanded;t&&!e.isExpanded&&this.input.focus(),!t&&e.isExpanded&&this.input.blur()}},{key:"render",value:function(){var e=this.props,t=e.value,a=e.onClick,n=e.onChange,r=e.onKeyDown,s=e.onSubmit,c=e.isExpanded,o=e.onFocus;return y.a.createElement("div",{className:"search-bar".concat(c?" is-expanded":""," clearfix")},y.a.createElement("form",{className:"search-form",onClick:a,onSubmit:s},y.a.createElement(ee,{onFocus:o,autoComplete:"off",value:t,name:"search",className:"search-form__input",type:"text",innerRef:this.inputRef,onChange:n,onKeyDown:r}),y.a.createElement(ee,{name:"submit",className:"search-form__submit",type:"submit"}),y.a.createElement(ae,{type:"button",className:"search-form__btn",name:"toggle",iconOnly:!0},y.a.createElement(ce,{name:"search"}))))}}]),t}(k.Component)),Wc=function(e){var t=e.items,a=e.onClick,n=e.selectedItem,r=e.category,s=e.renderMatch;return 0===t.length?null:y.a.createElement("li",{className:"search-suggestions__item"},y.a.createElement("span",{className:"search-suggestions__name"},r),y.a.createElement("ul",{className:"search-suggestions__list"},t.map(function(e){var t=null!==n&&(n.name===e.name&&"Projects"===r&&n.projectId===e.projectId||"Tags"===r&&n.color===e.color||"Tasks"===r&&n.taskId===e.taskId);return y.a.createElement("li",{key:e.taskId||e.projectId||e.name,className:"search-suggestion ".concat(t?"is-selected":""),onClick:a,tabIndex:0,"data-id":e.taskId||e.projectId||e.name,"data-project-id":e.projectId||""},s(e))})))};Wc.defaultProps={onClick:function(){return null}};var zc=Wc,Vc=function(e){var t=e.className,a=e.children,n=e.style;return y.a.createElement("mark",{style:n,className:"mark ".concat(t)},a)};Vc.defaultProps={className:"",style:{fontWeight:700}};var qc=Vc,Kc=(a(507),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isActive:!1,isSearchBarExpanded:!1,query:"",selectedItem:null,selectedIndex:null,filteredList:[]},a.reset=function(e){a.setState({isActive:!1,query:"",isSearchBarExpanded:!1,selectedItem:null,selectedIndex:null,filteredList:[]})},a.onChange=function(e){var t=e.target.value,n=a.state,r=n.selectedItem,s=n.filteredList,c=a.props,o=c.projects,i=c.tasks,l=c.tags,u=r?s.findIndex(function(e){return e.name===r.name}):-1,d=-1!==u;a.setState(function(){return{query:t,selectedItem:d?r:null,selectedIndex:d?u:0,filteredList:[null].concat(Object(G.a)(o),Object(G.a)(i),Object(G.a)(l)).filter(function(e){return null===e||a.matchItem(e)})}})},a.onKeyDown=function(e){if(e.key===Wn||e.key===zn||e.key===Vn||e.key===Fn){e.preventDefault();var t=a.state,n=t.filteredList,r=t.selectedIndex,s=t.selectedItem,c=r===n.length-1?0:r+1,o=0===r?n.length-1:r-1;switch(e.key){case zn:case Wn:a.setState({selectedItem:n[c],selectedIndex:c});break;case Vn:a.setState({selectedItem:n[o],selectedIndex:o});break;case Fn:if(null===s)a.handleSubmit(e),a.input.blur();else{var i=s.taskId,l=s.projectId,u=s.name;i?a.openTask({taskId:i,projectId:l}):l?a.openProject(l):a.openTaggedTasks(u)}}}},a.onClickProject=function(e){e.target.matches("li")&&a.openProject(e.target.dataset.id)},a.onClickTask=function(e){if(e.target.matches("li")){var t=e.target.dataset,n=t.id,r=t.projectId;a.openTask({taskId:n,projectId:r})}},a.onClickTag=function(e){e.target.matches("li")&&a.openTaggedTasks(e.target.dataset.id)},a.openTaggedTasks=function(e){a.props.history.push("/0/tasks?tag=".concat(e)),a.reset()},a.openProject=function(e){a.props.history.push("/0/projects/".concat(e,"/tasks")),a.reset()},a.openTask=function(e){var t=e.taskId,n=e.projectId,r=a.props,s=r.history,c=r.userId,o=r.selectTask;n?a.openProject(n):s.push("/0/".concat(c,"/tasks")),o(t),a.reset()},a.handleClick=function(e){var t=a.state.query,n=e.target.name;"search"===n||"submit"===n&&""!==t||(e.stopPropagation(),a.toggleSearchBar())},a.toggleSearchBar=function(){a.setState(function(e){return{isSearchBarExpanded:!e.isSearchBarExpanded}})},a.handleSubmit=function(e){e.preventDefault();var t=a.props.history,n=a.state.query;""!==n&&(t.push("/0/search?q=".concat(n)),a.reset())},a.onOutsideClick=function(e){var t=a.state,n=t.isSearchBarExpanded,r=t.isActive,s=t.query;!n||!r||a.suggestions&&a.suggestions.contains(e.target)||(""===s?a.setState({isActive:!1,isSearchBarExpanded:!1}):a.toggleSuggestions())},a.matchItem=function(e){var t=e.name,n=a.input.value;return""!==n&&new RegExp("\\b".concat(n),"i").test(t)},a.highlightMatch=function(e){var t=e.name,n=a.input.value;if(""===n)return t;var r=new RegExp("(\\b".concat(n,")"),"gi");return t.split(r).map(function(e){return r.test(e)?y.a.createElement(qc,{key:an()},e):e})},a.suggestionsRef=function(e){a.suggestions=e},a.inputRef=function(e){a.input=e},a.toggleSuggestions=function(e){a.setState(function(e){return{isActive:!e.isActive}})},a.onFocus=function(){a.state.isActive||a.toggleSuggestions()},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.projects,n=t.tasks,r=t.tags,s=t.innerRef,c=this.state,o=c.isActive,i=c.isSearchBarExpanded,l=c.selectedItem,u=c.query;return y.a.createElement("div",{className:"search-typeahead",ref:s},y.a.createElement(Fc,{setInputRef:this.inputRef,onFocus:this.onFocus,onClick:this.handleClick,onChange:this.onChange,onKeyDown:this.onKeyDown,onSubmit:this.handleSubmit,isExpanded:i,value:u}),""!==u&&o&&y.a.createElement("ul",{ref:this.suggestionsRef,className:"search-suggestions"},y.a.createElement("li",{tabIndex:0,onClick:this.handleSubmit,className:"search-suggestions__item search-suggestion ".concat(null===l?"is-selected":"")},y.a.createElement(ce,{name:"search"}),"Items with ",y.a.createElement(qc,null,u)),y.a.createElement(zc,{onClick:this.onClickProject,category:"Projects",items:a.filter(function(t){return e.matchItem(t)}),selectedItem:l,query:u,renderMatch:function(t){return y.a.createElement(y.a.Fragment,null,"board"===t.settings.layout?y.a.createElement(ce,{name:"trello"}):y.a.createElement(ln,{name:"task-list"}),e.highlightMatch(t))}}),y.a.createElement(zc,{onClick:this.onClickTask,category:"Tasks",items:n.filter(function(t){return e.matchItem(t)}),selectedItem:l,query:u,renderMatch:function(t){return y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"check-circle"}),e.highlightMatch(t))}}),y.a.createElement(zc,{onClick:this.onClickTag,category:"Tags",items:r.filter(function(t){return e.matchItem(t)}),selectedItem:l,query:u,renderMatch:function(t){return y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"tag"}),e.highlightMatch(t))}})))}}]),t}(k.Component)),Yc=Object(z.a)(V.a,Object(_.b)(function(e,t){return{userId:l.getCurrentUserId(e),projects:l.getCurrentUserProjects(e),tags:l.getAllMergedTags(e),tasks:i.getTasksArray(e)}},function(e){return{selectTask:function(t){return e(Rr(t))}}}),On)(Kc),Gc=(a(193),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).onTaskClick=function(e){(0,a.props.selectTask)(e)},a.closeTaskEditor=function(){(0,a.props.selectTask)(null)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.taggedTasks,n=t.currentUser,r=t.selectedTaskId,s=t.tasksById,c=t.tag,o=n.userId,i=!!r;return y.a.createElement(P,{title:y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"tag"}),c),classes:{main:"search-results",title:"search-results__title"}},y.a.createElement("div",{className:"search-results__tasks-wrapper"},y.a.createElement("div",{className:"search-results__tasks"},a.map(function(t,a){return y.a.createElement(Os,Object.assign({className:"search-results__task",index:a,key:t.taskId,onTaskClick:e.onTaskClick},t))})),i&&y.a.createElement(kc,Object.assign({},s[r],{handleTaskEditorClose:this.closeTaskEditor,userId:o,layout:"list",key:r}))))}}]),t}(k.Component)),Hc=rn(function(e){return!!e})(Object(_.b)(function(e,t){return{taggedTasks:i.getTaggedTasks(e,t.tag),selectedTaskId:Lr(e),tasksById:i.getTasksById(e)}},function(e){return{selectTask:function(t){return e(Rr(t))},syncTaggedTasks:function(t){var a=t.projectId,n=t.tag;return e(s.syncTaggedTasks({projectId:a,tag:n}))}}})(Gc)),Jc=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).onTaskClick=function(e){(0,a.props.selectTask)(e)},a.closeTaskEditor=function(){(0,a.props.selectTask)(null)},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentWillUnmount",value:function(){var e=this.props,t=e.selectedTaskId,a=e.selectTask;t&&a(null)}},{key:"render",value:function(){var e=this,t=this.props,a=t.currentUser,n=t.selectedTaskId,r=t.tasksById,s=t.tasks,c=t.query,o=a.userId,i=!!n;return y.a.createElement(P,{title:"Search Results",classes:{main:"search-results ".concat(i?"show-task-editor":""),title:"search-results__title"}},y.a.createElement("h2",{className:"search-results__subheading"},y.a.createElement(ce,{name:"search"}),c),y.a.createElement("div",{className:"search-results__tasks-wrapper"},y.a.createElement("div",{className:"search-results__tasks"},s.map(function(t,a){return y.a.createElement(Os,Object.assign({className:"search-results__task",index:a,key:t.taskId,onTaskClick:e.onTaskClick},t))})),i&&y.a.createElement(kc,Object.assign({},r[n],{handleTaskEditorClose:this.closeTaskEditor,userId:o,layout:"list",key:n}))))}}]),t}(k.Component),Xc=rn(function(e){return!!e})(Object(_.b)(function(e,t){return{tasks:i.getTasksMatchingQuery(e,t.query),selectedTaskId:Lr(e),tasksById:i.getTasksById(e)}},function(e){return{selectTask:function(t){return e(Rr(t))}}})(Jc)),Qc=(a(508),function(e){var t=e.icon,a=e.children;return y.a.createElement("div",{className:"profile__contact-info"},y.a.createElement(ce,{name:t}),a)}),$c=Object(z.a)(Object(_.b)(function(e,t){return{user:u.getUserData(e,t.userId)}}),rn(function(e,t){return!!e&&!!t}))(function(e){var t=e.user,a=e.currentUser,n=e.activeWorkspace;if(!t)return null;var r=n.members,s=t.userId,c=t.name,o=t.photoURL,i=t.email,l=t.displayName,u=t.status,d=t.github,p=t.linkedin,m=t.about,f=r[s],h=f.activeTaskCount,v=f.projectIds,b=u?u.state:"offline",g=a.userId===s;return y.a.createElement(P,{classes:{main:"profile"}},g&&y.a.createElement(M.a,{className:"profile__link--edit",to:"/0/".concat(s,"/edit-profile")},"Edit Profile"),y.a.createElement("header",{className:"profile__header"},y.a.createElement(Rn,{classes:{avatar:"profile__avatar",placeholder:"profile__avatar-placeholder"},name:c,size:"lg",variant:"circle",imgSrc:o}),y.a.createElement("h1",{className:"profile__name"},c),y.a.createElement("p",{className:"profile__display-name"},"@",l),y.a.createElement("p",{className:"profile__status is-".concat(b)},b),m&&y.a.createElement("p",{className:"profile__about"},m)),y.a.createElement("section",{className:"profile__section profile__workspace-info"},y.a.createElement("div",{className:"profile__counter"},y.a.createElement("div",{className:"profile__count"},v.length),y.a.createElement("div",{className:"profile__counter-name"},"Project".concat(1===v.length?"":"s"))),y.a.createElement("div",{className:"profile__counter"},y.a.createElement("div",{className:"profile__count"},h),y.a.createElement("div",{className:"profile__counter-name"},"Open Task".concat(1===h?"":"s")))),y.a.createElement("section",{className:"profile__section profile__contact"},y.a.createElement(Qc,{icon:"mail"},i),d&&y.a.createElement(Qc,{icon:"github"},y.a.createElement("a",{target:"_blank",href:"https://github.com/".concat(d),className:"profile__link"},d)),p&&y.a.createElement(Qc,{icon:"linkedin"},y.a.createElement("a",{target:"_blank",href:"https://www.linkedin.com/in/".concat(p),className:"profile__link"},p))))}),Zc=(a(509),function(e){var t=e.children;return y.a.createElement("div",{className:"edit-profile__control-group"},t)}),eo=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={about:a.props.currentUser.about||"",linkedin:a.props.currentUser.linkedin||"",github:a.props.currentUser.github||"",name:a.props.currentUser.name||"",displayName:a.props.currentUser.displayName||""},a.save=function(){var e=Object(W.a)(F.a.mark(function e(t){var n,r,s,c,o,i,l,u,d,p,m,f,h,v;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.props,r=n.firebase,s=n.history,c=n.currentUser,o=c.userId,i=a.state,l=i.about,u=i.linkedin,d=i.github,p=i.name,m=i.displayName,f=l!==c.about||u!==c.linkedin||d!==c.github||p!==c.name||m!==c.displayName,h=p!==c.name&&l===c.about&&u===c.linkedin&&d===c.github&&m===c.displayName,v=p!==c.name,!f){e.next=19;break}if(!h){e.next=12;break}return e.next=10,r.updateUserName({userId:o,name:p});case 10:e.next=19;break;case 12:if(!v){e.next=17;break}return e.next=15,Promise.all([r.updateUserName({userId:o,name:p}),r.updateDoc(["users",o],{about:l,linkedin:u,github:d,displayName:m})]);case 15:e.next=19;break;case 17:return e.next=19,r.updateDoc(["users",o],{about:l,linkedin:u,github:d,displayName:m});case 19:s.push("/0/".concat(o,"/profile"));case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(R.a)({},n,r))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.displayName,n=e.about,r=e.linkedin,s=e.github,c=this.props.currentUser,o=c.name,i=c.photoURL,l=""===t;return y.a.createElement(P,{classes:{main:"edit-profile"}},y.a.createElement("form",{className:"edit-profile__form"},y.a.createElement(ae,{variant:"outlined",color:"primary",className:"edit-profile__btn--save",onClick:this.save,disabled:l},"Save Changes"),y.a.createElement("header",{className:"edit-profile__header"},y.a.createElement("h1",{className:"edit-profile__heading"},"Edit Profile"),y.a.createElement(Rn,{classes:{avatar:"edit-profile__avatar",placeholder:"edit-profile__avatar-placeholder"},name:o,size:"lg",variant:"circle",imgSrc:i})),y.a.createElement("section",{className:"edit-profile__section edit-profile__user-info"},y.a.createElement(Zc,null,y.a.createElement(ee,{name:"name",id:"editName",onChange:this.onChange,className:"edit-profile__input",value:t,label:"Full name",labelClass:"edit-profile__label",helper:"*Required",helperClass:"edit-profile__helper",isRequired:!0})),y.a.createElement(Zc,null,y.a.createElement(ee,{name:"displayName",id:"editDisplayName",onChange:this.onChange,className:"edit-profile__input",value:a,label:"Display name",labelClass:"edit-profile__label",helper:"The name your teammates will use to @mention you in Workflow.",helperClass:"edit-profile__helper"})),y.a.createElement(Zc,null,y.a.createElement(ms,{onChange:this.onChange,className:"edit-profile__textarea",name:"about",id:"editAbout",value:n,label:"About me",labelClass:"edit-profile__label"}))),y.a.createElement("section",{className:"edit-profile__section edit-profile__social-links"},y.a.createElement("h2",{className:"edit-profile__subheading"},"Social links"),y.a.createElement(Zc,null,y.a.createElement(ee,{name:"github",id:"github",onChange:this.onChange,className:"edit-profile__input",value:s,label:"github.com/",labelClass:"edit-profile__label--contact"})),y.a.createElement(Zc,null,y.a.createElement(ee,{name:"linkedin",id:"linkedin",onChange:this.onChange,className:"edit-profile__input",value:r,label:"linkedin.com/in/",labelClass:"edit-profile__label--contact"})))))}}]),t}(k.Component),to=Object(z.a)(Object(_.b)(function(e,t){return{user:u.getUserData(e,t.userId)}}),rn(function(e,t){return!!e&&!!t}))(eo),ao={currentPassword:"",newPassword:"",confirmPassword:"",error:null,success:null},no=function(e){function t(e){var a;return Object(w.a)(this,t),(a=Object(C.a)(this,Object(T.a)(t).call(this,e))).onSubmit=function(e){var t=a.state,n=t.newPassword,r=t.currentPassword,s=a.props,c=s.firebase,o=s.currentUser,i=c.updatePassword,l=o.email;c.reauthenticateWithEmailAuthCredential(l,r).then(function(){return i(n)}).then(function(){a.setState(Object(U.a)({},ao,{success:{message:"Updated password!"}}))}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.onChange=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.state=Object(U.a)({},ao),a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.currentPassword,a=e.newPassword,n=e.confirmPassword,r=e.error,s=e.success,c=""===t||""===a||a!==n;return y.a.createElement("form",{className:"user-form"},y.a.createElement(ee,{name:"currentPassword",id:"currentPassword",label:"Current Password",value:t,onChange:this.onChange,type:"password",className:"user-form__input",labelClass:"user-form__label"}),y.a.createElement(ee,{name:"newPassword",id:"newPassword",label:"New Password",value:a,onChange:this.onChange,type:"password",className:"user-form__input",labelClass:"user-form__label"}),y.a.createElement(ee,{name:"confirmPassword",id:"confirmPassword",label:"Confirm New Password",value:n,onChange:this.onChange,type:"password",className:"user-form__input",labelClass:"user-form__label"}),y.a.createElement(ae,{disabled:c,type:"submit",size:"md",variant:"contained",color:"primary",onClick:this.onSubmit},"Change Password"),r&&y.a.createElement(ie,{text:r.message}),s&&y.a.createElement(he,{text:s.message}))}}]),t}(k.Component),ro=rn(function(e){return!!e})(no),so=(a(510),function(e){var t=e.title,a=e.children,n=e.classes;return y.a.createElement("main",{className:"user-form__container ".concat(n.main||"")},y.a.createElement("h1",{className:"user-form__title ".concat(n.heading||"")},t),a)});so.defaultProps={classes:{main:"",heading:""},title:""};var co=so,oo=(a(511),rn(function(e,t){return!!e&&!!t})(function(){return y.a.createElement(co,{title:"My Account"},y.a.createElement("section",{className:"account-section"},y.a.createElement("h2",{className:"account-section__header"},"Forgot your password?"),y.a.createElement(ge,null)),y.a.createElement("section",{className:"account-section"},y.a.createElement("h2",{className:"account-section__header"},"Change your password."),y.a.createElement(ro,null)))})),io=function(e){return e.slice(1).split("&").reduce(function(e,t){var a=t.split("="),n=Object(H.a)(a,2),r=n[0],s=n[1];return Object(U.a)({},e,Object(R.a)({},r,decodeURIComponent(s)))},{})},lo=(a(512),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isProjectComposerOpen:!1,isLoading:!0},a.setListeners=Object(W.a)(F.a.mark(function e(){var t,n,r,s,c,o,i,l,u,d;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props,n=t.currentUser,r=t.activeWorkspace,s=t.syncWorkspaceMembers,c=t.syncUserWorkspaceData,o=t.syncUserWorkspaceProjects,i=t.syncUserWorkspaceTasks,l=t.syncUserPrivateTasks,u=n.userId,d=r.workspaceId,r.projectIds,e.next=5,Promise.all([s(d),c({userId:u,workspaceId:d}),o({userId:u,workspaceId:d}),i({userId:u,workspaceId:d}),l({userId:u,workspaceId:d})]).then(function(){var e=Object(W.a)(F.a.mark(function e(t){return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.listeners=t,a.setState({isLoading:!1});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.error(e)});case 5:case"end":return e.stop()}},e)})),a.toggleProjectComposer=function(){a.setState(function(e){return{isProjectComposerOpen:!e.isProjectComposerOpen}})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.firebase,a=e.currentUser,n=t.initPresenceDetection,r=a.userId;this.setListeners(),n(r),console.log("mounted home")}},{key:"componentWillUnmount",value:function(){this.listeners&&this.listeners.forEach(function(e){return e()}),console.log("home unmounted")}},{key:"render",value:function(){var e=this,t=this.state,a=t.isProjectComposerOpen;if(t.isLoading)return null;var n=this.props,r=n.userId;n.projectsById;return y.a.createElement(y.a.Fragment,null,a&&y.a.createElement(tr,{onClose:this.toggleProjectComposer}),y.a.createElement(D.a,null,y.a.createElement(S.a,{exact:!0,path:"/0/home/:id",render:function(t){return y.a.createElement(Dc,Object.assign({toggleProjectComposer:e.toggleProjectComposer},t))}}),y.a.createElement(S.a,{path:"/0/projects/:id/:section",render:function(e){return y.a.createElement(Ic,Object.assign({userId:r,projectId:e.match.params.id},e))}}),y.a.createElement(S.a,{path:"/0/:id/projects",render:function(t){return y.a.createElement(P,{title:"My Projects",classes:{main:"project-grid__container",title:"project-grid__header"}},y.a.createElement(wn,Object.assign({userId:r,openProjectComposer:e.toggleProjectComposer},t)))}}),y.a.createElement(S.a,{path:"/0/:id/tasks",render:function(e){return y.a.createElement(Lc,Object.assign({userId:r},e))}}),y.a.createElement(S.a,{path:"/0/:id/profile",render:function(e){return y.a.createElement($c,Object.assign({userId:e.match.params.id},e))}}),y.a.createElement(S.a,{path:"/0/:id/edit-profile",render:function(e){return y.a.createElement(to,Object.assign({userId:e.match.params.id},e))}}),y.a.createElement(S.a,{path:"/0/search",render:function(e){var t=e.location.search,a=io(t);return y.a.createElement(Xc,Object.assign({query:a.q},e))}}),y.a.createElement(S.a,{path:"/0/tasks",render:function(e){var t=e.location.search,a=io(t);if(a.tag)return y.a.createElement(Hc,Object.assign({tag:a.tag},e))}}),y.a.createElement(S.a,{path:"/0/:id/account",component:oo})))}}]),t}(k.Component)),uo=rn(function(e,t){return!!e&&!!t})(Object(_.b)(function(e,t){return{projectsById:m.getProjectsById(e),membersById:u.getUsersById(e)}},function(e){return{syncWorkspaceMembers:function(t){return e(c.syncWorkspaceMembers(t))},syncUserPresence:function(){return e(c.syncUserPresence())},syncUserWorkspaceProjects:function(t){var a=t.userId,n=t.workspaceId;return e(r.syncUserWorkspaceProjects({userId:a,workspaceId:n}))},syncProjectTags:function(t){return e(r.syncProjectTags(t))},syncUserWorkspaceTasks:function(t){var a=t.userId,n=t.workspaceId;return e(s.syncUserWorkspaceTasks({userId:a,workspaceId:n}))},syncUserPrivateTasks:function(t){var a=t.userId,n=t.workspaceId;return e(s.syncUserPrivateTasks({userId:a,workspaceId:n}))},syncUserWorkspaceData:function(t){var a=t.userId,n=t.workspaceId;return e(o.syncUserWorkspaceData({userId:a,workspaceId:n}))}}})(lo)),po=(a(513),function(e){function t(e){var a;return Object(w.a)(this,t),(a=Object(C.a)(this,Object(T.a)(t).call(this,e))).state={loading:!1,users:{}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.setState({loading:!0})}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return y.a.createElement("main",{className:"admin"},y.a.createElement("h1",null,"Admin"))}}]),t}(k.Component)),mo=rn(function(e){return!!e})(Object(_.b)(function(e,t){return{currentUser:l.getCurrentUser(e)}},function(e){return{fetchUsersById:function(){return e(c.fetchUsersById())}}})(po)),fo=(a(514),a(515),function(e){var t=e.size,a=e.className,n=e.onClick;return y.a.createElement("div",{className:"logo logo--".concat(t," ").concat(a)},y.a.createElement(M.a,{className:"logo__link",to:"/",onClick:n},y.a.createElement("span",{className:"logo__text"},"workflow")))});fo.defaultProps={className:""};var ho=fo,vo=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={viewportWidth:window.innerWidth,isMobileNavVisible:!1,isTouchEnabled:!1},a.handleResize=function(){a.setState({viewportWidth:window.innerWidth})},a.toggleMobileNavVisibility=function(){a.setState(function(e){return{isMobileNavVisible:!e.isMobileNavVisible}})},a.handleClick=function(e){a.state.viewportWidth<a.props.minWidth&&(e.target.matches("button")||e.target.matches("a"))&&a.toggleMobileNavVisibility()},a.handleOutsideClick=function(e){!(a.state.viewportWidth<a.props.minWidth)||a.navLinksEl.contains(e.target)||e.target.matches("button")||e.target.matches("a")||a.setState({isMobileNavVisible:!1})},a.handleTouch=function(){!0!==a.state.isTouchEnabled&&(a.setState({isTouchEnabled:!0}),document.removeEventListener("touchstart",a.handleTouch),document.removeEventListener("click",a.handleOutsideClick),document.addEventListener("touchstart",a.handleOutsideClick))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize),document.addEventListener("touchstart",this.handleTouch),document.addEventListener("click",this.handleOutsideClick)}},{key:"componentWillUnmount",value:function(){var e=this.state.isTouchEnabled;window.removeEventListener("resize",this.handleResize),e?document.removeEventListener("touchstart",this.handleOutsideClick):(document.removeEventListener("click",this.handleOutsideClick),document.removeEventListener("touchstart",this.handleTouch))}},{key:"render",value:function(){var e=this,t=this.state,a=t.viewportWidth,n=t.isMobileNavVisible,r=this.props,s=r.minWidth,c=r.classes,o=r.children,i=a<s;return y.a.createElement("nav",{className:"navbar ".concat(i?"is-collapsed":""," ").concat(i&&n?"show-links":""," ").concat(c.navbar),ref:function(t){return e.navEl=t}},y.a.createElement(ho,{className:"navbar__logo",onClick:this.handleClick}),i&&y.a.createElement(ae,{type:"button",color:"primary",onClick:this.toggleMobileNavVisibility,iconOnly:!0,className:"navbar__btn--toggle"},y.a.createElement(ce,{name:"menu"})),y.a.createElement("ul",{className:"navbar__links ".concat(c.links),onClick:this.handleClick,ref:function(t){return e.navLinksEl=t}},o))}}]),t}(k.Component);vo.defaultProps={minWidth:768,classes:{navbar:"",links:""}};a(516);var bo=function(e){var t=e.users,a=e.style,n=e.classes,r=e.showOnlineStatus,s=e.details,c=e.activeWorkspace;return y.a.createElement("ul",{style:a,className:"members__list ".concat(n.list||"")},t.map(function(e){var t=e.photoURL,a=e.name,o=e.userId,i=e.status,l=e.settings,u=i&&"online"===i.state&&l.activeWorkspace===c.workspaceId;return y.a.createElement("li",{className:"members__item ".concat(n.item||""),key:o},y.a.createElement(Rn,{classes:{avatar:"members__avatar members__avatar--sm ".concat(n.avatar||""),placeholder:"members__avatar-placeholder--sm ".concat(n.placeholder||"")},name:a,size:"sm",variant:"circle",imgSrc:t,showOnlineStatus:r,isOnline:u}),s.map(function(t){return y.a.createElement("span",{key:t,className:"members__detail members__".concat(t," ").concat(n.detail?"".concat(n.detail," ").concat(n.detail,"--").concat(t):"")},"displayName"===t?"@".concat(e[t]):e[t])}))}))};bo.defaultProps={classes:{list:"",item:"",avatar:"",placeholder:"",detail:""},style:{},showOnlineStatus:!1,details:["name","displayName","email"]};var go=Object(z.a)(rn(function(e,t){return!!e&&!!t}),Object(_.b)(function(e){return{users:u.getUsersArray(e)}}))(bo),ko=(a(517),function(e){var t=e.name;return y.a.createElement(ce,{name:t,className:"sidebar__icon"})}),yo=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isMembersListVisible:!1},a.onOutsideClick=function(e){a.props.isExpanded&&!e.target.matches(".sidebar__btn--toggle")&&(0,a.props.onToggle)()},a.toggleMembersList=function(){a.setState(function(e){return{isMembersListVisible:!e.isMembersListVisible}})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state.isMembersListVisible,t=this.props,a=t.onToggle,n=t.children,r=t.activeWorkspace,s=t.openWorkspaceSettings,c=t.isWorkspaceSettingsActive,o=t.innerRef,i=r.name;return y.a.createElement("div",{ref:o,className:"sidebar__canvas"},y.a.createElement(ae,{type:"button",onClick:a,className:"sidebar__btn--toggle",size:"sm",iconOnly:!0},y.a.createElement(ce,{name:"bar-chart-2"})),y.a.createElement("div",{className:"sidebar"},y.a.createElement("nav",{className:"sidebar__nav"},y.a.createElement("div",{className:"sidebar__logo"},y.a.createElement(ho,{size:"sm"})),y.a.createElement("div",{className:"sidebar__content"},y.a.createElement("ul",{className:"sidebar__list"},n),y.a.createElement(ae,{isActive:c,className:"sidebar__btn sidebar__btn--workspace-settings",onClick:s},y.a.createElement(ce,{className:"sidebar__icon",name:"settings"}),y.a.createElement("span",{className:"sidebar__section-name sidebar__workspace-name"},i)),y.a.createElement("ul",{className:"sidebar__list sidebar__workspace-links"},y.a.createElement("li",{className:"sidebar__item sidebar__item--team"},y.a.createElement(ae,{isActive:e,className:"sidebar__btn sidebar__btn--toggle-members",onClick:this.toggleMembersList},y.a.createElement(ce,{className:"sidebar__icon",name:"users"}),y.a.createElement("span",{className:"sidebar__section-name"},"Team"),y.a.createElement(ce,{className:"sidebar__icon",name:"chevron-left"})),y.a.createElement(go,{style:{display:e?"block":"none"},classes:{list:"sidebar__list sidebar__members-list",item:"sidebar__item sidebar__member",detail:"sidebar__member-detail",avatar:"sidebar__avatar"},showOnlineStatus:!0,details:["name","displayName"]})),y.a.createElement("ul",{className:"sidebar__list"},y.a.createElement("li",{className:"sidebar__item"},y.a.createElement(M.a,{target:"_blank",className:"sidebar__link",to:"/guide"},y.a.createElement(ce,{className:"sidebar__icon",name:"help-circle"}),y.a.createElement("span",{className:"sidebar__section-name"},"Help")))))))))}}]),t}(k.Component),Io=Object(z.a)(rn(function(e,t){return!!e&&!!t}),On)(yo),jo=function(e){var t=e.onClick;return y.a.createElement(y.a.Fragment,null,y.a.createElement("li",null,y.a.createElement(ar.a,{className:"navbar__link",onClick:t,to:"/login"},"Log In")),y.a.createElement("li",null,y.a.createElement(ar.a,{className:"navbar__link",onClick:t,to:"/signup"},"Sign Up")),y.a.createElement("li",null,y.a.createElement(ar.a,{className:"navbar__link",to:"/guide"},"Guide")))},_o=function(e){var t=e.userId,a=e.onClick;return y.a.createElement(y.a.Fragment,null,y.a.createElement("li",{className:"sidebar__item"},y.a.createElement(ar.a,{onClick:a,className:"sidebar__link",to:"/0/home/".concat(t)},y.a.createElement(ko,{name:"home"}),y.a.createElement("span",{className:"sidebar__section-name"},"Home"))),y.a.createElement("li",{className:"sidebar__item"},y.a.createElement(ar.a,{onClick:a,className:"sidebar__link",to:"/0/".concat(t,"/tasks")},y.a.createElement(ko,{name:"check-circle"}),y.a.createElement("span",{className:"sidebar__section-name"},"My Tasks"))),y.a.createElement("li",{className:"sidebar__item"},y.a.createElement(ar.a,{onClick:a,className:"sidebar__link",to:"/0/".concat(t,"/projects")},y.a.createElement(ko,{name:"grid"}),y.a.createElement("span",{className:"sidebar__section-name"},"My Projects"))))},Eo=K(function(e){var t=e.firebase,a=e.className;return y.a.createElement(ae,{type:"button",onClick:t.signOut,className:a,color:"primary"},"Log Out")}),wo=(a(194),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).selectWorkspace=function(e){var t=e.target.value,n=a.props,r=n.firebase,s=n.currentUser.userId;r.updateDoc(["users",s],{"settings.activeWorkspace":t}),console.log("selected workspace: ".concat(t))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentUser,a=e.activeWorkspace,n=t.workspaces,r=Object.keys(n).map(function(e){return{value:e,name:n[e].name}});return y.a.createElement(xn,{name:"activeWorkspace",onChange:this.selectWorkspace,options:r,value:a.workspaceId,classes:{label:"workspace-select__label",list:"workspace-select__list"}})}}]),t}(k.Component)),Oo=rn(function(e,t){return!!e&&!!t})(wo),Co=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",invites:["","",""]},a.onChange=function(e){var t=e.target,n=t.name,r=t.value,s=t.dataset.index;a.setState(function(e){var t=Object(G.a)(e.invites);return"invites"===n&&(t[s]=r),Object(R.a)({},n,"invites"===n?t:r)})},a.onSubmit=function(){var e=Object(W.a)(F.a.mark(function e(t){var n,r,s,c,o,i,l,u;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.props,r=n.firebase,s=n.currentUser,c=n.onClose,o=a.state,i=o.name,l=o.invites,u={userId:s.userId,name:s.name},e.next=6,r.createWorkspace({user:u,name:i,invites:l.filter(function(e){return""!==e})});case 6:c(t);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=t.invites,r=this.props.onClose,s=""===a;return y.a.createElement(Tn,{onModalClose:r,size:"md",classes:{content:"workspace-composer "}},y.a.createElement("h3",{className:"workspace-composer__heading"},"Create new workspace"),y.a.createElement("form",{className:"workspace-composer__form",onSubmit:this.onSubmit},y.a.createElement(ee,{name:"name",id:"workspaceName",label:"Workspace name",value:a,onChange:this.onChange,type:"text",className:"workspace-composer__input",labelClass:"workspace-composer__label","data-section":"workspace"}),y.a.createElement("h3",{className:"workspace-composer__subheading"},"Your team (optional)"),n.map(function(t,a){return y.a.createElement(ee,{key:a,name:"invites",value:t,onChange:e.onChange,type:"email",className:"workspace-composer__input workspace-composer__input--teammate-email",form:"workspace",placeholder:"Teammate's email","data-index":a,"data-section":"workspace"})}),y.a.createElement(ae,{disabled:s,type:"submit",className:"workspace-composer__btn",variant:"contained",color:"primary",onClick:this.onSubmit},"Create Workspace")))}}]),t}(k.Component),To=rn(function(e){return!!e})(Co),No=function(e){var t=e.className,a=e.children;return y.a.createElement("ul",{role:"tablist",className:"tabs ".concat(t)},a)};No.defaultProps={className:""};var Do=No,So=function(e){var t=e.className,a=e.id,n=e.panelId,r=e.isActive,s=e.children,c=e.index,o=e.onSelectTab;return y.a.createElement("li",{onClick:o,onKeyDown:o,id:a,role:"tab",tabIndex:0,"aria-selected":r,"aria-controls":n,className:"tab ".concat(t," ").concat(r?"is-active":""),"data-index":c},s)};So.defaultProps={className:""};var Ao=So,xo=function(e){var t=e.className,a=e.id,n=e.tabId,r=e.children,s=e.isActive;return y.a.createElement("section",{className:"tab-panel ".concat(t),id:a,role:"tabpanel","aria-labelledby":n,"aria-hidden":!s,style:{display:s?"block":"none"}},r)};xo.defaultProps={className:""};var Po=xo,Bo=(a(518),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={selectedIndex:0},a.onSelectTab=function(e){if("keydown"!==e.type||e.key===Fn){var t=e.target.dataset.index;a.setState({selectedIndex:+t})}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.tabs,r=this.state.selectedIndex;return y.a.createElement("div",{className:"tabs-container ".concat(a.container||"")},y.a.createElement("header",{className:"tabs-container__header ".concat(a.header||"")},y.a.createElement(Do,{className:a.tabs||""},n.map(function(t,n){return y.a.createElement(Ao,{key:t.id,id:t.id,panelId:t.panelId,className:a.tab||"",index:n,onSelectTab:e.onSelectTab,isActive:n===r},t.label)}))),n.map(function(e,t){return y.a.createElement(Po,{key:e.panelId,id:e.panelId,tabId:e.id,className:a.panel||"",isActive:t===r},e.content)}))}}]),t}(k.Component));Bo.defaultProps={classes:{container:"",tabs:"",tab:"",panel:"",header:""},tabs:[]};a(519);var Mo=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:a.props.activeWorkspace.name,newInvite:""},a.onChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(R.a)({},n,r))},a.resetInvite=function(){a.setState({newInvite:""})},a.updateWorkspaceName=function(e){e.preventDefault();var t=a.props,n=t.firebase,r=t.activeWorkspace,s=a.state.name,c=r.workspaceId,o=r.name,i=r.memberIds,l=r.pendingInvites;o!==s&&(0,n.updateWorkspaceName)({workspaceId:c,name:s,memberIds:i,pendingInvites:l})},a.inviteMember=function(e){e.preventDefault();var t=a.state.newInvite,n=a.props,r=n.firebase,s=n.currentUser,c=n.activeWorkspace,o=n.memberEmails,i=c.workspaceId,l=c.name,u=c.pendingInvites,d=r.createWorkspaceInvite,p=r.updateDoc,m=r.addToArray,f={userId:s.userId,name:s.name};a.resetInvite(),[].concat(Object(G.a)(u),Object(G.a)(o)).includes(t)||(p(["workspaces",i],{pendingInvites:m(t)}),d({email:t,workspaceId:i,workspaceName:l,from:f}))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.newInvite,n=this.props,r=n.onClose,s=n.activeWorkspace.pendingInvites,c=""===t,o=""===a;return y.a.createElement(Tn,{onModalClose:r,size:"lg",classes:{content:"workspace-settings "}},y.a.createElement("h2",{className:"workspace-settings__heading"},"Workspace Settings"),y.a.createElement(Bo,{classes:{panel:"workspace-settings__panel",tabs:"workspace-settings__tabs"},tabs:[{id:"tabGeneral",panelId:"panelGeneral",label:"General",content:y.a.createElement("form",{id:"workspaceName",onSubmit:this.updateName},y.a.createElement(ee,{name:"name",id:"workspaceEditName",label:"Workspace name",value:t,onChange:this.onChange,type:"text",className:"workspace-settings__input",labelClass:"workspace-settings__label","data-section":"workspace",form:"workspaceName",isRequired:!0}),y.a.createElement(ae,{disabled:c,type:"submit",className:"workspace-settings__btn",variant:"contained",color:"primary",onClick:this.updateWorkspaceName,form:"workspaceName"},"Update Workspace"))},{id:"tabMembers",panelId:"panelMembers",label:"Members",content:y.a.createElement(y.a.Fragment,null,y.a.createElement(go,{classes:{list:"workspace-settings__members",item:"workspace-settings__member",avatar:"workspace-settings__avatar",placeholder:"workspace-settings__avatar-placeholder",detail:"workspace-settings__member-detail"}}),s.length>0&&y.a.createElement(y.a.Fragment,null,y.a.createElement("h4",{className:"workspace-settings__sub-subheading"},"Pending Invites"),y.a.createElement("ul",{className:"workspace-settings__pending-invites"},s.map(function(e){return y.a.createElement("li",{key:e,className:"workspace-settings__pending-invite"},e)}))),y.a.createElement("h4",{className:"workspace-settings__sub-subheading"},"Invite more members"),y.a.createElement("form",{id:"workspaceInvite"},y.a.createElement(ee,{name:"newInvite",id:"newWorkspaceInvite",value:a,onChange:this.onChange,type:"email",className:"workspace-settings__input workspace-settings__input--teammate-email",placeholder:"Teammate's email",label:"Email",labelClass:"workspace-settings__label",form:"workspaceInvite"}),y.a.createElement(ae,{disabled:o,type:"submit",className:"workspace-settings__btn",variant:"contained",color:"primary",onClick:this.inviteMember,form:"workspaceInvite"},"Invite")))}]}))}}]),t}(k.Component),Uo=Object(z.a)(Object(_.b)(function(e){return{memberEmails:u.getUserEmails(e)}}),rn(function(e,t){return!!e&&!!t}))(Mo),Ro=(a(520),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isUserActionsVisible:!1},a.toggleUserActions=function(){a.setState(function(e){return{isUserActionsVisible:!e.isUserActionsVisible}})},a.hideUserActions=function(){a.setState({isUserActionsVisible:!1})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentUser,a=e.openWorkspaceComposer,n=e.openWorkspaceSettings,r=this.state.isUserActionsVisible;return y.a.createElement(y.a.Fragment,null,y.a.createElement("div",{className:"topbar"},y.a.createElement(Yc,null),y.a.createElement(Hn,{isActive:r,onOutsideClick:this.hideUserActions,classes:{wrapper:"topbar__user-actions-wrapper",popover:"topbar__user-actions"},align:{outer:"right",inner:"right"},buttonProps:{onClick:this.toggleUserActions,size:"sm",iconOnly:!0,className:"topbar__btn--user-actions",children:y.a.createElement(Rn,{classes:{avatar:"topbar__avatar",placeholder:"topbar__avatar-placeholder"},name:t.name,size:"sm",variant:"circle",imgSrc:t.photoURL})}},y.a.createElement(Oo,null),y.a.createElement(Dn,{onClick:this.toggleUserActions},y.a.createElement(Sn,null,y.a.createElement(ae,{className:"topbar__link",onClick:a,disabled:t.isGuest},y.a.createElement(ce,{name:"plus"}),"Create Workspace")),y.a.createElement(Sn,null,y.a.createElement(ae,{className:"topbar__link",onClick:n},"Workspace Settings")),y.a.createElement(Sn,null,y.a.createElement(ar.a,{className:"topbar__link",to:"/0/".concat(t.userId,"/account")},"My Account")),y.a.createElement(Sn,null,y.a.createElement(ar.a,{className:"topbar__link",to:"/0/".concat(t.userId,"/profile")},"My Profile")),y.a.createElement(Sn,null,y.a.createElement(Eo,{className:"topbar__link"}))))))}}]),t}(k.Component)),Lo=rn(function(e,t){return!!e&&!!t})(Ro),Fo=(a(521),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={isNavExpanded:!1,isWorkspaceComposerActive:!1,isWorkspaceSettingsActive:!1},a.toggleNav=function(e){a.setState(function(e){return{isNavExpanded:!e.isNavExpanded}})},a.collapseNav=function(e){a.setState({isNavExpanded:!1})},a.toggleWorkspaceComposer=function(){a.setState(function(e){return{isWorkspaceComposerActive:!e.isWorkspaceComposerActive}})},a.closeWorkspaceComposer=function(){a.setState({isWorkspaceComposerActive:!1})},a.toggleWorkspaceSettings=function(){a.setState(function(e){return{isWorkspaceSettingsActive:!e.isWorkspaceSettingsActive}})},a.openWorkspaceSettings=function(){a.state.isWorkspaceSettingsActive||a.toggleWorkspaceSettings()},a.closeWorkspaceSettings=function(){a.setState({isWorkspaceSettingsActive:!1})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.isNavExpanded,a=e.isWorkspaceComposerActive,n=e.isWorkspaceSettingsActive,r=this.props,s=r.firebase,c=r.history.location,o=r.currentUser,i=r.activeWorkspace,l="/login"===c.pathname,u="/signup"===c.pathname,d="/forgot-password"===c.pathname;return y.a.createElement("header",{className:"header ".concat(l?"header--login":""," ").concat(u||d?"header--dk":""," ").concat(t?"expand-nav":"")},o&&i?y.a.createElement(y.a.Fragment,null,y.a.createElement(Io,{isExpanded:t,onToggle:this.toggleNav,isWorkspaceSettingsActive:n,openWorkspaceSettings:this.openWorkspaceSettings},y.a.createElement(_o,{onClick:this.collapseNav,userId:o.userId})),y.a.createElement(Lo,{openWorkspaceComposer:this.toggleWorkspaceComposer,openWorkspaceSettings:this.openWorkspaceSettings}),a&&y.a.createElement(To,{onClose:this.closeWorkspaceComposer}),n&&y.a.createElement(Uo,{onClose:this.closeWorkspaceSettings})):y.a.createElement(vo,null,s.currentUser?y.a.createElement(Eo,{className:"navbar__btn"}):y.a.createElement(jo,null)))}}]),t}(k.Component)),Wo=rn(function(){return!0})(Fo),zo=function(e){var t=e.name,a=e.displayName,n=e.email,r=e.about,s=e.onChange;return y.a.createElement("section",{className:"account-setup__section"},y.a.createElement("h2",{className:"account-setup__section-heading"},"Your profile"),y.a.createElement(ee,{name:"name",id:"name",label:"Full name",value:t,onChange:s,type:"text",className:"account-setup__input",labelClass:"account-setup__label","data-section":"profile",isRequired:!0}),y.a.createElement(ee,{name:"displayName",id:"displayName",label:"Display name (optional)",value:a,onChange:s,type:"text",className:"account-setup__input",labelClass:"account-setup__label","data-section":"profile",helper:"The name your teammates will use to @mention you in Workflow. If ommitted, your full name will be used."}),y.a.createElement(ee,{name:"email",id:"email",label:"Email",value:n,type:"email",className:"account-setup__input",labelClass:"account-setup__label","data-section":"profile",isReadOnly:!0}),y.a.createElement(ms,{name:"about",id:"about",label:"About Me (optional)",value:r,onChange:s,className:"account-setup__textarea",labelClass:"account-setup__label","data-section":"profile"}))},Vo=function(e){var t=e.name,a=e.invites,n=e.isOptional,r=e.onChange;return y.a.createElement("section",{className:"account-setup__section"},y.a.createElement("h2",{className:"account-setup__section-heading"},"Your workspace ".concat(n?"(optional)":"")),y.a.createElement(ee,{name:"name",id:"workspaceName",label:"Workspace name",value:t,onChange:r,type:"text",className:"account-setup__input",labelClass:"account-setup__label","data-section":"workspace"}),y.a.createElement("h3",{className:"account-setup__section-subheading"},"Your team (optional)"),a.map(function(e,t){return y.a.createElement(ee,{key:t,name:"invites",value:e,onChange:r,type:"email",className:"account-setup__input account-setup__input--teammate-email",form:"workspace",placeholder:"Teammate's email","data-index":t,"data-section":"workspace"})}))},qo=function(e){function t(){return Object(w.a)(this,t),Object(C.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.invites,a=e.onChange;return y.a.createElement("section",{className:"account-setup__section"},y.a.createElement("h2",{className:"account-setup__section-heading"},"You were invited to join the following workspaces:"),y.a.createElement("p",{className:"account-setup__paragraph"},"Please select the workspaces you wish to join."),y.a.createElement("ul",{className:"account-setup__list"},t.map(function(e,t){return y.a.createElement("li",{key:e.id,className:"account-setup__item"},y.a.createElement(Ar,{name:e.data.id,value:e.data.id,id:e.data.id,onChange:a,className:"account-setup__checkbox",labelClass:"account-setup__checkbox-label",isChecked:e.isAccepted,"data-index":t,label:e.data.name}))})))}}]),t}(k.Component),Ko=(a(522),{profile:{displayName:"",name:"",about:""},workspace:{name:"",invites:["","",""]},invites:[],error:null,currentSection:"profile",nextSection:"workspace"}),Yo=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state=Object(U.a)({},Ko),a.onSubmit=function(){var e=Object(W.a)(F.a.mark(function e(t){var n,r,s,c,o,i,l,u,d,p;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.state,r=n.profile,s=n.workspace,c=n.invites,o=a.props,i=o.firebase,l=o.history,s.invites=s.invites.filter(function(e){return""!==e}),u=i.currentUser,d=u.uid,p=u.email,a.setState(Object(U.a)({},Ko)),e.next=8,i.createAccount({userId:d,email:p,profile:r,invites:c,workspace:s.name?s:null});case 8:l.push("/0/home/".concat(d));case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onChange=function(e){var t=e.target,n=t.name,r=t.value,s=t.dataset,c=s.section,o=s.index;a.setState(function(e){var t=Object(G.a)(e.workspace.invites);return"invites"===n&&(t[+o]=r),Object(R.a)({},c,Object(U.a)({},e[c],Object(R.a)({},n,"invites"===n?t:r)))})},a.goToNextSection=function(){a.setState(function(e){return{currentSection:e.nextSection,nextSection:"invites"===e.nextSection?"workspace":null}})},a.goToPrevSection=function(){a.setState(function(e){return{currentSection:"workspace"===e.currentSection?"invites":"profile",nextSection:e.currentSection}})},a.acceptWorkspaceInvite=function(e){var t=e.target.dataset.index;a.setState(function(e){var a=Object(G.a)(e.invites);return a[+t]=Object(U.a)({},e.invites[+t],{isAccepted:!e.invites[+t].isAccepted}),{invites:a}})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(F.a.mark(function e(){var t,a,n,r;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.firebase,a=t.currentUser,n=a.email,e.next=5,t.fs.collection("invites").where("to","==",n).where("type","==","workspace").get().then(function(e){var t=[];return e.forEach(function(e){var a=e.data(),n={id:e.id,data:Object(U.a)({},a.data),from:Object(U.a)({},a.from),isAccepted:!1};t=t.concat(n)}),t});case 5:r=e.sent,this.setState({invites:r,nextSection:r.length>0?"invites":"workspace"});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.profile,a=e.workspace,n=e.error,r=e.currentSection,s=e.invites,c=this.props.firebase.currentUser.email,o=""===t.name,i=""===a.name&&s.every(function(e){return!e.isAccepted});return y.a.createElement("main",{className:"account-setup"},y.a.createElement("form",{className:"account-setup__form"},y.a.createElement("h1",{className:"account-setup__heading"},"Set up your account"),"profile"===r&&y.a.createElement(zo,{name:t.name,displayName:t.displayName,email:c,about:t.about,onChange:this.onChange}),"invites"===r&&y.a.createElement(qo,{invites:s,onChange:this.acceptWorkspaceInvite}),"workspace"===r&&y.a.createElement(Vo,{isOptional:s.length>0&&s.some(function(e){return e.isAccepted}),name:a.name,invites:a.invites,onChange:this.onChange}),y.a.createElement("footer",{className:"account-setup__footer account-setup__footer--".concat(r)},"profile"!==r&&y.a.createElement(ae,{size:"md",variant:"outlined",color:"primary",onClick:this.goToPrevSection,className:"account-setup__btn"},"Back"),"workspace"===r&&y.a.createElement(ae,{disabled:o||i,size:"md",variant:"contained",color:"primary",onClick:this.onSubmit,className:"account-setup__btn"},"Done"),"workspace"!==r&&y.a.createElement(ae,{disabled:"profile"===r&&o,size:"md",variant:"contained",color:"primary",onClick:this.goToNextSection,className:"account-setup__btn"},"Next"))),n&&y.a.createElement(ie,{text:n.message}))}}]),t}(k.Component),Go=Object(z.a)(K,V.a)(Yo),Ho=(a(523),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={success:null,error:null},a.resendVerificationEmail=function(){a.props.firebase.sendEmailVerification().then(function(){a.setState({success:{message:"Verification email sent!"}})}).catch(function(e){a.setState({error:e})})},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.state,t=e.error,a=e.success;return y.a.createElement(P,{classes:{main:"verification-required",title:"verification-required__heading"},title:"Please verify your email"},y.a.createElement("p",{className:"verification-required__paragraph"},"Thanks for signing up with Workflow! Please verify your email address to continue setting up your account."),y.a.createElement(ae,{size:"md",variant:"contained",color:"primary",className:"verification-required__btn",onClick:this.resendVerificationEmail},"Resend Verification Link"),t&&y.a.createElement(ie,{text:t.message}),a&&y.a.createElement(he,{text:a.message}))}}]),t}(k.Component)),Jo=K(Ho),Xo=(a(524),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={width:0,height:0,arrowLength:"show"===a.props.arrow?a.props.arrowLength:0},a.setTooltipRef=function(e){a.tooltip=e},a.getPosition=function(){var e=a.props,t=e.anchorEl,n=e.alignX,r=e.alignY,s=e.axis;if(!a.tooltip||!t)return{tooltip:null,arrow:{align:"",position:null}};window.getComputedStyle(a.tooltip)["border-radius"];var c=a.state,o=c.height,i=c.width,l=c.arrowLength,u=t.getBoundingClientRect(),d=u.top,p=u.bottom,m=u.left,f=u.right,h=u.height,v=u.width,b=window.innerWidth||document.documentElement.clientWidth,g=window.innerHeight||document.documentElement.clientHeight,k={},y="",I={};if("y"===s){switch(r){case"top":var j=d-o-l,_=j>=0;k.top=_?j:p+l,y=_?"bottom":"top",I.top=_?"100%":"-".concat(l,"px");break;case"bottom":var E=p+o+l<=g;k.top=E?p+l:d-o-l,y=E?"top":"bottom",I.top=E?"-".concat(l,"px"):"100%";break;default:var w=d-o/2;w>=0?(k.top=w,I.top="calc(50% - ".concat(l,"px)")):(k.top=d,I.top=h-l/2)}switch(n){case"left":k.left=m,I.left=v/2-l;break;case"right":k.left=m-i+l,I.left="calc(100% - ".concat(v/2+l,"px)");break;default:var O=m-i/2;O>=0&&O<=b?(k.left=O,I.left="calc(50% - ".concat(l/2,"px)")):m+i<=b?(k.left=m,I.left=v/2-l/2):(k.right=f,I.right=v/2-l/2)}return{tooltip:k,arrow:{align:y,position:I}}}if("x"===s){switch(r){case"top":k.top=d,I.top=h/2-l/2;break;case"bottom":k.bottom=p,I.bottom=h/2-l/2;break;default:var C=d-o/2;C>=0?(k.top=C,I.top="calc(50% - ".concat(l,"px)")):(k.top=d,I.top=h/2+l/2)}switch(n){case"left":var T=m-i-l;T>=0?(k.left=T,y="right",I.left="100%"):(k.left=f,y="left",I.left="-".concat(v,"px"));break;case"right":f+i+l<=b?(k.left=f+l,y="left",I.left="-".concat(v,"px")):(k.left=m-i-l,y="right",I.left="100%");break;default:var N=m-i/2;N>=0&&N<=b?(k.left=N,I.left="calc(50% - ".concat(l,"px)")):m+i<=b?(k.left=m,I.left=v/2-l/2):(k.left=f,I.right=l)}return{tooltip:k,arrow:{align:y,position:I}}}},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.anchorEl,n=t.arrow,r=t.arrowLength;if(a!==e.anchorEl){var s=window.getComputedStyle(this.tooltip),c=s.width,o=s.height,i="show"===n;this.setState({width:a?parseFloat(c):0,height:a?parseFloat(o):0,arrowLength:i?r:0})}}},{key:"render",value:function(){var e=this.props,t=e.anchorEl,a=e.classes,n=e.text,r=e.arrowLength,s="show"===this.props.arrow,c=this.getPosition(),o=c.tooltip,i=c.arrow;return y.a.createElement("div",{ref:this.setTooltipRef,style:Object(U.a)({},o,{display:t?"block":"none"}),className:"tooltip ".concat(a.tooltip||"")},y.a.createElement("div",{className:"tooltip__arrow tooltip__arrow--".concat(i.align," ").concat(a.arrow||""),style:s?Object(U.a)({},i.position,{borderWidth:"".concat(r,"px")}):{display:"none"}}),n)}}]),t}(k.Component));Xo.defaultProps={classes:{tooltip:"",arrow:""},text:"",alignY:"bottom",alignX:"center",arrow:"show",arrowLength:10,axis:"y"};var Qo=Xo,$o=function(e){var t=e.title,a=e.children;return y.a.createElement(Bc,{classes:{panel:"guide__panel",content:"guide__panel-content",header:"guide__panel-header"},header:y.a.createElement(y.a.Fragment,null,y.a.createElement(ce,{name:"chevron-right"}),t)},a)},Zo=(a(96),function(){return y.a.createElement(P,{classes:{main:"features",title:"features__heading"},title:"Features"},y.a.createElement($o,{title:"Create a project"}),y.a.createElement($o,{title:"Edit a project"}),y.a.createElement($o,{title:"Create a task"}),y.a.createElement($o,{title:"Edit a task"}))}),ei=function(){return y.a.createElement(P,{classes:{main:"how-to",title:"how-to__heading"},title:"How to..."},y.a.createElement($o,{title:"Create a project"}),y.a.createElement($o,{title:"Edit a project"}),y.a.createElement($o,{title:"Create a task"}),y.a.createElement($o,{title:"Edit a task"}))},ti=function(){return y.a.createElement(P,{classes:{main:"fundamentals",title:"fundamentals__heading"},title:"Fundamentals"},y.a.createElement($o,{title:"Navigating Workflow"}),y.a.createElement($o,{title:"Home Page"}),y.a.createElement($o,{title:"My Tasks"}),y.a.createElement($o,{title:"Search"}))},ai=function(e){var t=e.link,a=e.title,n=e.color,r=e.icon;return y.a.createElement("li",{className:"guide__tile guide__tile--".concat(n)},y.a.createElement(M.a,{className:"guide__section-link",to:t},y.a.createElement("span",{className:"guide__icon-wrapper"},y.a.createElement(ce,{name:r})),a))},ni=Object(V.a)(function(){return y.a.createElement(D.a,null,y.a.createElement(S.a,{exact:!0,path:"/guide",render:function(){return y.a.createElement(P,{classes:{main:"guide",title:"guide__heading"},title:"Getting started with Workflow"},y.a.createElement("p",{className:"guide__intro"},"Learn the basics of using Workflow to manage your projects."),y.a.createElement("ul",{className:"guide__grid"},y.a.createElement(ai,{color:"primary",title:"Features",link:"/guide/features",icon:"star"}),y.a.createElement(ai,{color:"secondary",title:"Fundamentals",link:"/guide/fundamentals",icon:"book-open"}),y.a.createElement(ai,{color:"tertiary",title:"How to...",link:"/guide/how-to",icon:"crosshair"})))}}),y.a.createElement(S.a,{path:"/guide/how-to",component:ei}),y.a.createElement(S.a,{path:"/guide/features",component:Zo}),y.a.createElement(S.a,{path:"/guide/fundamentals",component:ti}))}),ri=(a(525),nn(function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={tooltipAnchor:null,tooltipProps:{}},a.onMouseOver=function(e){var t=e.target,n=a.state.tooltipAnchor;if(t.matches("[data-tooltip]")&&n!==t){var r=t.dataset,s=r.tooltip,c=r.tooltipAlignY,o=r.tooltipAlignX,i=r.tooltipArrow;a.setState({tooltipAnchor:t,tooltipProps:{text:s,alignY:c,alignX:o,arrow:i}})}},a.onMouseOut=function(e){a.state.tooltipAnchor&&(console.log("mouse out"),a.setState({tooltipAnchor:null,tooltipProps:{}}))},a}return Object(N.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.firebase,a=(e.currentUser,this.state),n=a.tooltipAnchor,r=a.tooltipProps;return y.a.createElement("div",{onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,className:"app"},y.a.createElement(Wo,null),y.a.createElement(D.a,null,y.a.createElement(S.a,{exact:!0,path:"/",component:B}),y.a.createElement(S.a,{path:"/signup",component:me}),y.a.createElement(S.a,{path:"/setup",render:function(e){return t.currentUser?y.a.createElement(Go,e):null}}),y.a.createElement(S.a,{path:"/login",component:Ee}),y.a.createElement(S.a,{path:"/forgot-password",component:ye}),y.a.createElement(S.a,{path:"/0/",render:function(e){return y.a.createElement(uo,e)||y.a.createElement(A.a,{to:"/setup"})}}),y.a.createElement(S.a,{path:"/admin",component:mo}),y.a.createElement(S.a,{path:"/verification-required",component:Jo}),y.a.createElement(S.a,{path:"/guide",component:ni})),y.a.createElement(Qo,Object.assign({anchorEl:n},r)))}}]),t}(k.Component)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var si=a(31),ci=a(207),oi=Object(si.c)({currentUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return t.currentUser;case"RESET_CURRENT_USER":return null;case"LOAD_FOLDERS":var a=t.folders;return Object(U.a)({},e,{folders:a});case"LOAD_NOTIFICATIONS":var n=t.notifications;return Object(U.a)({},e,{notifications:n});case"LOAD_USER_TAGS":var r=t.tags;return Object(U.a)({},e,{tags:r});case"CREATE_TAG":var s=t.tagId,c=t.tagData;return Object(U.a)({},e,{tags:Object(U.a)({},e.tags,Object(R.a)({},s,c))});case"DELETE_TAG":var o=t.tagId,i=e.tags,l=(i[o],Object($.a)(i,[o].map(Wa)));return Object(U.a)({},e,{tags:l});case"UPDATE_TAG":var u=t.tagId,d=t.tagData;return Object(U.a)({},e,{tags:Object(U.a)({},e.tags,Object(R.a)({},u,Object(U.a)({},e.tags[u],d)))});case"ADD_FOLDER":var p=t.folderId,m=t.folderData;return Object(U.a)({},e,{folders:Object(U.a)({},e.folders,Object(R.a)({},p,Object(U.a)({folderId:p},m)))});case"REMOVE_FOLDER":var f=t.folderId,h=e.folders,v=(h[f],Object($.a)(h,[f].map(Wa)));return Object(U.a)({},e,{folders:v});case"ADD_NOTIFICATION":var b=t.notificationId,g=t.notificationData;return Object(U.a)({},e,{notifications:Object(U.a)({},e.notifications,Object(R.a)({},b,Object(U.a)({notificationId:b},g)))});case"REMOVE_NOTIFICATION":var k=t.notificationId,y=e.notifications,I=(y[k],Object($.a)(y,[k].map(Wa)));return Object(U.a)({},e,{notifications:I});case"UPDATE_NOTIFICATION":var j=t.notificationId,_=t.notificationData;return Object(U.a)({},e,{notifications:Object(U.a)({},e.notifications,Object(R.a)({},j,Object(U.a)({},e.notifications[j],_)))});case"LOAD_ASSIGNED_TASKS":var E=e.assignedTasks||[],w=t.assignedTasks;return Object(U.a)({},e,{assignedTasks:[].concat(Object(G.a)(E),Object(G.a)(w))});case"ADD_ASSIGNED_TASK":var O=t.taskId,C=e.assignedTasks||[];return Object(U.a)({},e,{assignedTasks:[].concat(Object(G.a)(C),[O])});case"REMOVE_ASSIGNED_TASK":var T=t.taskId;return Object(U.a)({},e,{assignedTasks:Object(G.a)(e.assignedTasks.filter(function(e){return e!==T}))});case"UPDATE_FOLDER":var N=t.folderId,D=t.folderData;return Object(U.a)({},e,{folders:Object(U.a)({},e.folders,Object(R.a)({},N,Object(U.a)({},e.folders[N],D)))});case"UPDATE_FOLDER_IDS":case"REORDER_FOLDERS":var S=t.folderIds;return Object(U.a)({},e,{folderIds:S});case"SET_TEMP_TASK_SETTINGS":var A=t.view,x=t.sortBy;return Object(U.a)({},e,{tempSettings:Object(U.a)({},e.tempSettings,{tasks:Object(U.a)({},e.tempSettings.tasks,{view:A||e.tempSettings.tasks.view,sortBy:x||e.tempSettings.tasks.sortBy})})});case"UPDATE_USER":var P=t.userId,B=t.userData;return P!==e.userId?e:Object(U.a)({},e,B);case"RESET_ACTIVE_WORKSPACE":return e?(e.assignedTasks,e.notifications,e.folders,e.projectIds,e.folderIds,Object($.a)(e,["assignedTasks","notifications","folders","projectIds","folderIds"])):e;default:return e}},activeWorkspace:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ACTIVE_WORKSPACE":return t.workspace;case"RESET_ACTIVE_WORKSPACE":return null;case"UPDATE_ACTIVE_WORKSPACE":var a=t.workspaceData;return Object(U.a)({},e,a);default:return e}},projectsById:In,listsById:Gr,tasksById:Jr,usersById:Ja,subtasksById:is,commentsById:fc,selectedTask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_TASK":return t.taskId;case"RESET_ACTIVE_WORKSPACE":return null;default:return e}},selectedProject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_PROJECT":return t.projectId;case"RESET_ACTIVE_WORKSPACE":return null;default:return e}}}),ii=a(48),li=Object(ii.a)({basename:""}),ui=Object(si.e)(oi,{},Object(si.a)(ci.a));j.a.render(y.a.createElement(_.a,{store:ui},y.a.createElement(Y.Provider,{value:Oe},y.a.createElement(E.a,{basename:"",history:li},y.a.createElement(ri,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},60:function(e){e.exports={object:"value",document:{object:"document",data:{},nodes:[{object:"block",type:"paragraph",data:{},nodes:[{object:"text",leaves:[{object:"leaf",text:"",marks:[]}]}]}]}}},96:function(e,t,a){}},[[209,1,2]]]);
//# sourceMappingURL=main.9540495a.chunk.js.map